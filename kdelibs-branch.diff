Index: libkscreensaver/main.cpp
===================================================================
--- libkscreensaver/main.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkscreensaver/main.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -113,6 +113,7 @@
     if (args->isSet("setup"))
     {
        QDialog *dlg = kss_setup();
+       args->clear();
        dlg->exec();
        delete dlg;
        exit(0);
@@ -151,12 +152,11 @@
         demoWidget->setFixedSize( 600, 420 );
         demoWidget->show();
     }
-
+    args->clear();
     app.exec();
 
     delete target;
-    if ( demoWidget )
-        delete demoWidget;
+    delete demoWidget;
 
     return 0;
 }
Index: interfaces/kscript/scriptmanager.cpp
===================================================================
--- interfaces/kscript/scriptmanager.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ interfaces/kscript/scriptmanager.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -17,7 +17,7 @@
 		QString scriptFile;
 		QString scriptMethod;
 		ScriptInfo();
-		~ScriptInfo(){};
+		~ScriptInfo(){}
 };
 ScriptInfo::ScriptInfo()
 {
Index: interfaces/kimproxy/interface/kcm_instantmessenger.desktop
===================================================================
--- interfaces/kimproxy/interface/kcm_instantmessenger.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ interfaces/kimproxy/interface/kcm_instantmessenger.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -69,7 +69,7 @@
 Comment[cy]=Mae'r negesydd chwim yn caniatàu sgwrs dwy-ffordd rhwng unigolion a grwpiau.
 Comment[da]=Instant messenger tillader tovejs chat mellem individer og grupper.
 Comment[de]=Der Instant Messenger ermöglicht Chats zwischen Personen und Gruppen in jede Richtung.
-Comment[el]=Ο στιγμιαίος αποστολέας επιτρέπει τη συζήτηση μεταξύ άτομα και ομάδες.
+Comment[el]=Ο στιγμιαίος αποστολέας επιτρέπει τη συζήτηση μεταξύ ατόμων και ομάδων.
 Comment[eo]=La tujmesaĝilo ebligas ambaŭdirekta parolado inter homoj kaj grupoj
 Comment[es]=El Instant Messenger permite conversación en dos sentidos entre indivíduos y grupos.
 Comment[et]=Kiirsuhtlus võimaldab üksikisikute ja gruppide kahepoolset vestlust.
Index: interfaces/ktexteditor/selectioninterfaceext.cpp
===================================================================
--- interfaces/ktexteditor/selectioninterfaceext.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ interfaces/ktexteditor/selectioninterfaceext.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -30,8 +30,8 @@
 //BEGIN KTextEditor::SelectionInterfaceExt
 class KTextEditor::PrivateSelectionInterfaceExt {
   public:
-    PrivateSelectionInterfaceExt() : interface( 0 ) {};
-    ~PrivateSelectionInterfaceExt() {};
+    PrivateSelectionInterfaceExt() : interface( 0 ) {}
+    ~PrivateSelectionInterfaceExt() {}
     
     SelectionExtDCOPInterface *interface;
 };
Index: kate/plugins/isearch/ISearchPlugin.cpp
===================================================================
--- kate/plugins/isearch/ISearchPlugin.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kate/plugins/isearch/ISearchPlugin.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -382,14 +382,9 @@
 {
 	if( !text.isNull() && !text.isEmpty() ) {
 		m_combo->addToHistory( text );
-		m_combo->insertItem( text );
 		m_lastString = text;
 	}
 
-	m_combo->blockSignals( true );
-	m_combo->clear();
-	m_combo->blockSignals( false );
-
 	if( m_view ) {
 		m_view->setFocus(); // Will call endSearch()
 	}
Index: kate/part/katerenderer.cpp
===================================================================
--- kate/part/katerenderer.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kate/part/katerenderer.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -798,6 +798,11 @@
     Q_ASSERT(width);
     x += width;
 
+    // How should tabs be treated when they word-wrap on a print-out?
+    // if startcol != 0, this messes up (then again, word wrapping messes up anyway)
+    if (unicode[z] == QChar('\t'))
+      x -= x % width;
+
     if (unicode[z].isSpace())
     {
       lastWhiteSpace = z+1;
@@ -816,11 +821,6 @@
       }
     }
 
-    // How should tabs be treated when they word-wrap on a print-out?
-    // if startcol != 0, this messes up (then again, word wrapping messes up anyway)
-    if (unicode[z] == QChar('\t'))
-      x -= x % width;
-
     if (x <= maxwidth)
     {
       if (lastWhiteSpace > -1)
Index: kate/part/kateview.cpp
===================================================================
--- kate/part/kateview.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kate/part/kateview.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1521,32 +1521,32 @@
       // We have to tag the whole lot if
       // 1) we have a selection, and:
       //  a) it's new; or
-      tagLines(selectStart, selectEnd);
+      tagLines(selectStart, selectEnd, true);
 
     } else if (blockSelectionMode() && (oldSelectStart.col() != selectStart.col() || oldSelectEnd.col() != selectEnd.col())) {
       //  b) we're in block selection mode and the columns have changed
-      tagLines(selectStart, selectEnd);
-      tagLines(oldSelectStart, oldSelectEnd);
+      tagLines(selectStart, selectEnd, true);
+      tagLines(oldSelectStart, oldSelectEnd, true);
 
     } else {
       if (oldSelectStart != selectStart) {
         if (oldSelectStart < selectStart)
-          tagLines(oldSelectStart, selectStart);
+          tagLines(oldSelectStart, selectStart, true);
         else
-          tagLines(selectStart, oldSelectStart);
+          tagLines(selectStart, oldSelectStart, true);
       }
 
       if (oldSelectEnd != selectEnd) {
         if (oldSelectEnd < selectEnd)
-          tagLines(oldSelectEnd, selectEnd);
+          tagLines(oldSelectEnd, selectEnd, true);
         else
-          tagLines(selectEnd, oldSelectEnd);
+          tagLines(selectEnd, oldSelectEnd, true);
       }
     }
 
   } else {
     // No more selection, clean up
-    tagLines(oldSelectStart, oldSelectEnd);
+    tagLines(oldSelectStart, oldSelectEnd, true);
   }
 }
 
Index: kate/part/kateviewinternal.cpp
===================================================================
--- kate/part/kateviewinternal.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kate/part/kateviewinternal.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1653,7 +1653,22 @@
 
   if (maxX && range.wrap) {
     QChar lastCharInLine = textLine(range.line)->getChar(range.endCol - 1);
-    maxX -= m_view->renderer()->config()->fontMetrics()->width(lastCharInLine);
+
+    if (lastCharInLine == QChar('\t')) {
+      int lineSize = 0;
+      int lastTabSize = 0;
+      for(int i = range.startCol; i < range.endCol; i++) {
+        if (textLine(range.line)->getChar(i) == QChar('\t')) {
+          lastTabSize = m_view->tabWidth() - (lineSize % m_view->tabWidth());
+          lineSize += lastTabSize;
+        } else {
+          lineSize++;
+        }
+      }
+      maxX -= lastTabSize * m_view->renderer()->spaceWidth();
+    } else {
+      maxX -= m_view->renderer()->config()->fontMetrics()->width(lastCharInLine);
+    }
   }
 
   return maxX;
@@ -2231,11 +2246,11 @@
       // @@ Do this only when cursor near start/end.
       if( bmStart > bmEnd )
       {
-        tagLines(bmEnd, bmStart, true);
+        tagLines(bmEnd, bmStart);
       }
       else
       {
-        tagLines(bmStart, bmEnd, true);
+        tagLines(bmStart, bmEnd);
       }
     }
     else
@@ -2258,11 +2273,11 @@
       // @@ Do this only when cursor near start/end.
       if( bmStart > bmEnd )
       {
-        tagLines(bmEnd, bmStart, true);
+        tagLines(bmEnd, bmStart);
       }
       else
       {
-        tagLines(bmStart, bmEnd, true);
+        tagLines(bmStart, bmEnd);
       }
     }
     else
Index: kate/data/pascal.xml
===================================================================
--- kate/data/pascal.xml	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kate/data/pascal.xml	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE language SYSTEM "language.dtd">
-<language name="Pascal" version="1.20" kateversion="2.3" section="Sources" extensions="*.pp;*.pas;*.p" mimetype="text/x-pascal">
+<language name="Pascal" version="1.21" kateversion="2.3" section="Sources" extensions="*.pp;*.pas;*.p" mimetype="text/x-pascal">
   <highlighting>
     <list name="keywords">
       <item> and </item>
@@ -84,6 +84,7 @@
       <item> property </item>
       <item> protected </item>
       <item> public </item>
+      <item> read </item>
       <item> qualified </item>
       <item> raise </item>
       <item> restricted </item>
@@ -92,6 +93,7 @@
       <item> threadvar </item>
       <item> try </item>
       <item> virtual </item>
+      <item> write </item>
     </list>
     <list name="types">
       <item> Integer </item>
Index: libltdl/ltdl.m4
===================================================================
--- libltdl/ltdl.m4	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libltdl/ltdl.m4	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -97,7 +97,7 @@
 	linux*)
 	  libltdl_cv_sys_dlopen_deplibs=yes
 	  ;;
-	netbsd*|openbsd*|freebsd*)
+	netbsd*|openbsd*|freebsd*|dragonfly*)
 	  libltdl_cv_sys_dlopen_deplibs=yes
 	  ;;
 	solaris*)
Index: mimetypes/audio/x-pn-realaudio-plugin.desktop
===================================================================
--- mimetypes/audio/x-pn-realaudio-plugin.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ mimetypes/audio/x-pn-realaudio-plugin.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -14,6 +14,8 @@
 Comment[es]=Archivo de extensión para RealAudio
 Comment[et]=RealAudio plugina fail
 Comment[fa]=پروندۀ وصلۀ RealAudio
+Comment[fi]=RealAudio liitännäistiedosto
+Comment[fr]=Fichier RealAudio
 Comment[fy]=RealAudio plugin triem
 Comment[he]=תוסף RealAudio
 Comment[hr]=RealAudio datoteka dodatka
Index: kioslave/ftp/ftp.cc
===================================================================
--- kioslave/ftp/ftp.cc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kioslave/ftp/ftp.cc	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1203,7 +1203,7 @@
   kdDebug(7102) << "ftpCloseCommand: reading command result" << endl;
   m_bBusy = false;
 
-  if(ftpResponse(-1) <= 0 || (m_iRespType != 2) )
+  if(!ftpResponse(-1) || (m_iRespType != 2) )
   {
     kdDebug(7102) << "ftpCloseCommand: no transfer complete message" << endl;
     return false;
@@ -2004,6 +2004,7 @@
   {
     const char* psz = strrchr( ftpResponse(4), '(' );
     if(psz) m_size = charToLongLong(psz+1);
+    if (!m_size) m_size = UnknownSize;
   }
 
   KIO::filesize_t bytesLeft = 0;
@@ -2390,6 +2391,7 @@
   if(!psz)
     return false;
   m_size = charToLongLong(psz);
+  if (!m_size) m_size = UnknownSize;
   return true;
 }
 
Index: kinit/start_kdeinit.c
===================================================================
--- kinit/start_kdeinit.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kinit/start_kdeinit.c	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -24,6 +24,7 @@
 #include <signal.h>
 #include <stdio.h>
 #include <stdlib.h>
+#include <string.h>
 #include <unistd.h>
 
 #ifdef KDEINIT_OOM_PROTECT
@@ -67,6 +68,8 @@
    const char** new_argv;
    char helper_num[ 1024 ];
    int i;
+   char** orig_environ = NULL;
+   char header[ 7 ];
    if( pipe( pipes ) < 0 ) {
       perror( "pipe()" );
       return 1;
@@ -89,6 +92,31 @@
             return 1;
          }
          close( pipes[ 0 ] );
+         /* read original environment passed by start_kdeinit_wrapper */
+         if( read( 0, header, 7 ) == 7 && strncmp( header, "environ", 7 ) == 0 ) {
+             int count;
+             if( read( 0, &count, sizeof( int )) == sizeof( int )) {
+                 char** env = malloc(( count + 1 ) * sizeof( char* ));
+                 int ok = 1;
+                 for( i = 0;
+                      i < count && ok;
+                      ++i ) {
+                     int len;
+                     if( read( 0, &len, sizeof( int )) == sizeof( int )) {
+                         env[ i ] = malloc( len + 1 );
+                         if( read( 0, env[ i ], len ) == len ) {
+                             env[ i ][ len ] = '\0';
+                         } else {
+                             ok = 0;
+                         }
+                     }
+                 }
+                 if( ok ) {
+                   env[ i ] = NULL;
+                   orig_environ = env;
+                 }
+             }
+         }
          if(argc == 0)
             return 1;
          new_argc = argc + 2;
@@ -103,7 +131,10 @@
               i <= argc;
               ++i )
              new_argv[ i + 2 ] = argv[ i ];
-         execv(EXECUTE, (char**)new_argv);
+         if( orig_environ )
+             execve(EXECUTE, (char**)new_argv, orig_environ);
+         else
+             execv(EXECUTE, (char**)new_argv);
          perror(EXECUTE);
          return 1;
       case 0: /* child, keep privileges and do the privileged work */
Index: kinit/start_kdeinit_wrapper.c
===================================================================
--- kinit/start_kdeinit_wrapper.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 0)
+++ kinit/start_kdeinit_wrapper.c	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -0,0 +1,92 @@
+/*
+ * This file is part of the KDE libraries
+ * Copyright (c) 2007 Lubos Lunak <l.lunak@kde.org>
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Library General Public
+ * License version 2 as published by the Free Software Foundation.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Library General Public License for more details.
+ *
+ * You should have received a copy of the GNU Library General Public License
+ * along with this library; see the file COPYING.LIB.  If not, write to
+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+ * Boston, MA 02110-1301, USA.
+ */
+
+#include <config.h>
+
+#include <stdio.h>
+#include <string.h>
+#include <unistd.h>
+
+#ifdef KDEINIT_OOM_PROTECT
+
+/*
+ The start_kdeinit wrapper is setuid, which means some shell variables like LD_LIBRARY_PATH
+ get unset before it's launched. However kdeinit is used to launch most of KDE, so such variables
+ should not be dropped. Therefore this wrapper for the setuid wrapper read the environment
+ and writes it to start_kdeinit's stdin, which after dropping priviledges reads it and uses it
+ for launching the real kdeinit.
+*/
+int main(int argc, char **argv)
+{
+   int pipes[ 2 ];
+   if(argc == 0)
+      return 1;
+   if( pipe( pipes ) < 0 ) {
+      perror( "pipe()" );
+      return 1;
+   }
+   switch( fork()) {
+      case -1:
+         perror( "fork()" );
+         return 1;
+      default: /* parent, exec */ 
+         close( pipes[ 1 ] );
+         close( 0 ); /* stdin */
+         dup2( pipes[ 0 ], 0 );
+         close( pipes[ 0 ] );
+         argv[ 0 ] = (char*)"start_kdeinit";
+         execvp("start_kdeinit", argv);
+         perror("start_kdeinit");
+         return 1;
+      case 0: { /* child, pass env and exit */
+         extern char** environ;
+         int i;
+         close( pipes[ 0 ] );
+         write( pipes[ 1 ], "environ", 7 ); /* header, just in case */
+         for( i = 0;
+              environ[ i ] != NULL;
+              ++i )
+             {}
+         write( pipes[ 1 ], &i, sizeof( int )); /* write count */
+         for( i = 0;
+              environ[ i ] != NULL;
+              ++i )
+             {
+             int len = strlen( environ[ i ] );
+             write( pipes[ 1 ], &len, sizeof( int )); /* write length */
+             write( pipes[ 1 ], environ[ i ], strlen( environ[ i ] ));
+             }
+         close( pipes[ 1 ] );
+         }     
+   }
+   return 0;
+}
+
+#else /* not Linux, the simple non-setuid case */
+
+int main(int argc, char **argv)
+{
+   if(argc == 0)
+      return 1;
+   argv[0] = "start_kdeinit";
+   execv("start_kdeinit",argv);
+   perror("start_kdeinit");
+   return 1;
+}
+#endif
Index: kinit/wrapper.c
===================================================================
--- kinit/wrapper.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kinit/wrapper.c	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -351,6 +351,7 @@
       header.cmd = LAUNCHER_TERMINATE_KDE;
       header.arg_length = 0;
       write_socket(sock, (char *) &header, sizeof(header));
+      read_socket(sock, (char *) &header, 1); /* wait for the socket to close */
       return 0;
    }
 
Index: kinit/Makefile.am
===================================================================
--- kinit/Makefile.am	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kinit/Makefile.am	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -20,7 +20,7 @@
 SUBDIRS = . tests
 
 bin_PROGRAMS = kdeinit kdeinit_wrapper kshell kdeinit_shutdown lnusertemp kwrapper kioslave \
-               kstartupconfig kdostartupconfig start_kdeinit
+               kstartupconfig kdostartupconfig start_kdeinit start_kdeinit_wrapper
 
 lib_LTLIBRARIES = 
 kdeinit_LTLIBRARIES = klauncher.la
@@ -71,6 +71,8 @@
 start_kdeinit_CFLAGS = $(KDE_USE_FPIE) -DEXECUTE=\"$(kdeinitpath)\"
 start_kdeinit_LDFLAGS = $(KDE_USE_PIE)
 
+start_kdeinit_wrapper_SOURCES = start_kdeinit_wrapper.c
+
 METASOURCES = AUTO
 
 noinst_HEADERS = klauncher.h autostart.h klauncher_cmds.h setproctitle.h
Index: kio/kio/knfsshare.cpp
===================================================================
--- kio/kio/knfsshare.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kio/kio/knfsshare.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -180,7 +180,7 @@
   if ( path[path.length()-1] != '/' )
        fixedPath += '/';
   
-  return d->sharedPaths.find(fixedPath) > 0;
+  return d->sharedPaths.find(fixedPath) != 0;
 }
 
 QStringList KNFSShare::sharedDirectories() const {
Index: kio/kio/kmimemagic.cpp
===================================================================
--- kio/kio/kmimemagic.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kio/kio/kmimemagic.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -230,6 +230,9 @@
 #define L_DIFF   0x400          /* Output of diff */
 #define L_OBJC   0x800          /* Objective C */
 
+// Note: this is not a type, it's just used to mark items that should count more
+#define FLAG_STRONG 0x1000
+
 #define P_HTML   0          /* HTML */
 #define P_C      1          /* first and foremost on UNIX */
 #define P_MAKE   2          /* Makefiles */
@@ -271,10 +274,10 @@
 	short type;
 } const names[] = {
 	{
-		"<html", L_HTML
+		"<html", L_HTML | FLAG_STRONG
 	},
 	{
-		"<HTML", L_HTML
+		"<HTML", L_HTML | FLAG_STRONG
 	},
 	{
 		"<head", L_HTML
@@ -340,10 +343,10 @@
 		"<FRAMESET", L_HTML
 	},
         {
-                "<script", L_HTML
+                "<script", L_HTML | FLAG_STRONG
         },
         {
-                "<SCRIPT", L_HTML
+                "<SCRIPT", L_HTML | FLAG_STRONG
         },
 	{
 		"/*", L_C|L_CPP|L_JAVA|L_OBJC
@@ -1881,7 +1884,7 @@
 			}
                     }
                     for (i = 0; i < (int)NTYPES; i++) {
-                        if ((1 << i) & p->type) typecount[i]++;
+                        if ((1 << i) & p->type) typecount[i]+= p->type & FLAG_STRONG ? 2 : 1;
                     }
 		}
             }
Index: kio/kio/defaultprogress.cpp
===================================================================
--- kio/kio/defaultprogress.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kio/kio/defaultprogress.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -236,7 +236,7 @@
                                             unsigned long totalFiles )
 {
   if ( totalSize )
-      return i18n( "%1 % of %2 " ).arg( percent ).arg( KIO::convertSize( totalSize ) );
+      return i18n( "%1 % of %2 " ).arg( QString::number(percent) , KIO::convertSize( totalSize ) );
   else if ( totalFiles )
       return i18n( "%1 % of 1 file", "%1 % of %n files", totalFiles ).arg( percent );
   else
Index: kabc/ldapurl.h
===================================================================
--- kabc/ldapurl.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kabc/ldapurl.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -59,7 +59,7 @@
      * Returns the dn part of the LDAP Url (same as path(), but slash removed
      * from the beginning).
      */
-    const QString& dn() const { return m_dn; };
+    const QString& dn() const { return m_dn; }
     /** Sets the the dn part of the LDAP Url. */ 
     void setDn( const QString &dn );
 
@@ -70,7 +70,7 @@
       { m_attributes=attributes; updateQuery(); }
 
     /** Returns the scope part of the LDAP Url */
-    Scope scope() const { return m_scope; };
+    Scope scope() const { return m_scope; }
     /** Sets the scope part of the LDAP Url */
     void setScope(Scope scope) { m_scope = scope; updateQuery(); }
 
Index: kabc/ldif.h
===================================================================
--- kabc/ldif.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kabc/ldif.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -41,9 +41,9 @@
   {
   public:
 
-    typedef enum ParseVal{ None, NewEntry, EndEntry, Item, Control, Err, MoreData };
-    typedef enum EntryType{ Entry_None, Entry_Add, Entry_Del, Entry_Mod, Entry_Modrdn };
-    typedef enum ModType{ Mod_None, Mod_Add, Mod_Replace, Mod_Del };
+    enum ParseVal{ None, NewEntry, EndEntry, Item, Control, Err, MoreData };
+    enum EntryType{ Entry_None, Entry_Add, Entry_Del, Entry_Mod, Entry_Modrdn };
+    enum ModType{ Mod_None, Mod_Add, Mod_Replace, Mod_Del };
     LDIF();
     virtual ~LDIF();
     
@@ -108,7 +108,7 @@
      * Sets a chunk of LDIF. Call before startParsing(), or if nextItem() returned
      * MoreData.
      */
-    void setLDIF( const QByteArray &ldif ) { mLdif = ldif; mPos = 0; };
+    void setLDIF( const QByteArray &ldif ) { mLdif = ldif; mPos = 0; }
     /**
       * Indicates the end of the LDIF file/stream. Call if nextItem() returned
       * MoreData, but actually you don't have more data.
Index: kutils/kcmoduleinfo.cpp
===================================================================
--- kutils/kcmoduleinfo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kutils/kcmoduleinfo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -36,9 +36,9 @@
   public:
     KCModuleInfoPrivate() :
       testModule( false )
-    {};
+    {}
     ~KCModuleInfoPrivate()
-    { };
+    { }
 
     QString factoryName;
     bool testModule;
Index: kutils/kcmodulecontainer.cpp
===================================================================
--- kutils/kcmodulecontainer.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kutils/kcmodulecontainer.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -51,7 +51,7 @@
 			, btnRootMode( 0 )
 			, btnLayout( 0 )
 			, topLayout( 0 )
-			{};
+			{}
 
 		QStringList modules;
 		QTabWidget *tabWidget;
Index: kutils/kcmoduleinfo.h
===================================================================
--- kutils/kcmoduleinfo.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kutils/kcmoduleinfo.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -110,12 +110,12 @@
   /**
    * @return the filename of the .desktop file that describes the KCM
    */
-  QString fileName() const { return _fileName; };
+  QString fileName() const { return _fileName; }
 
   /**
    * @return the keywords associated with this KCM.
    */
-  const QStringList &keywords() const { return _keywords; };
+  const QStringList &keywords() const { return _keywords; }
 
   /**
    * Returns the module's factory name, if it's set. If not, the library
@@ -128,23 +128,23 @@
   /**
    * @return the module\'s (translated) name
    */
-  QString moduleName() const { return _name; };
+  QString moduleName() const { return _name; }
   // changed from name() to avoid ambiguity with QObject::name() on multiple inheritance
 
   /**
    * @return a KSharedPtr to KService created from the modules .desktop file
    */
-  KService::Ptr service() const { return _service; };
+  KService::Ptr service() const { return _service; }
 
   /**
    * @return the module's (translated) comment field
    */
-  QString comment() const { return _comment; };
+  QString comment() const { return _comment; }
 
   /**
    * @return the module's icon name
    */
-  QString icon() const { return _icon; };
+  QString icon() const { return _icon; }
 
   /**
    * @return the path of the module's documentation
@@ -154,7 +154,7 @@
   /**
    * @return the library name
    */
-  QString library() const { return _lib; };
+  QString library() const { return _lib; }
 
   /**
    * @return a handle (usually the contents of the FactoryName field)
@@ -193,37 +193,37 @@
    * Sets the object's keywords.
    * @param keyword the new keywords
    */
-  void setKeywords(const QStringList &keyword) { _keywords = keyword; };
+  void setKeywords(const QStringList &keyword) { _keywords = keyword; }
 
   /**
    * Sets the object's name.
    * @param name the new name
    */
-  void setName(const QString &name) { _name = name; };
+  void setName(const QString &name) { _name = name; }
 
   /**
    * Sets the object's name.
    * @param comment the new comment
    */
-  void setComment(const QString &comment) { _comment = comment; };
+  void setComment(const QString &comment) { _comment = comment; }
 
   /**
    * Sets the object's icon.
    * @param icon the name of the new icon
    */
-  void setIcon(const QString &icon) { _icon = icon; };
+  void setIcon(const QString &icon) { _icon = icon; }
 
   /**
    * Set the object's library
    * @param lib the name of the new library without any extensions or prefixs.
    */
-  void setLibrary(const QString &lib) { _lib = lib; };
+  void setLibrary(const QString &lib) { _lib = lib; }
 
   /**
    * Sets the factory name
    * @param handle The new factory name
    */
-  void setHandle(const QString &handle) { _handle = handle; };
+  void setHandle(const QString &handle) { _handle = handle; }
 
   /**
    * Sets the object's weight property which determines in what
@@ -231,7 +231,7 @@
    *
    * @param weight the new weight
    */
-  void setWeight(int weight) { _weight = weight; };
+  void setWeight(int weight) { _weight = weight; }
 
 
   /**
@@ -247,19 +247,19 @@
    * @param needsRootPrivileges if module needs root privilges
    */
   void setNeedsRootPrivileges(bool needsRootPrivileges)
-  { _needsRootPrivileges = needsRootPrivileges; };
+  { _needsRootPrivileges = needsRootPrivileges; }
 
   /**
    * @deprecated
    */
   void setIsHiddenByDefault(bool isHiddenByDefault)
-  { _isHiddenByDefault = isHiddenByDefault; };
+  { _isHiddenByDefault = isHiddenByDefault; }
 
   /**
    * Sets the object's documentation path
    * @param p the new documentation path
    */
-  void setDocPath(const QString &p) { _doc = p; };
+  void setDocPath(const QString &p) { _doc = p; }
 
   /**
    * Reads the service entries specific for KCModule from the desktop file.
Index: kutils/kplugininfo.cpp
===================================================================
--- kutils/kplugininfo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kutils/kplugininfo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -24,6 +24,7 @@
 #include <kconfigbase.h>
 #include <kglobal.h>
 #include <kstandarddirs.h>
+#include <kdesktopfile.h>
 #include <kservice.h>
 
 class KPluginInfo::KPluginInfoPrivate
@@ -69,7 +70,7 @@
 KPluginInfo::KPluginInfo( const QString & filename, const char* resource )
 : d( new KPluginInfoPrivate )
 {
-    KConfig file( filename, true, true, resource );
+    KDesktopFile file( filename, true, resource );
 
     d->specfile = filename;
 
@@ -80,8 +81,8 @@
         if( d->hidden )
             return;
 
-        d->name = file.readEntry( "Name" );
-        d->comment = file.readEntry( "Comment" );
+        d->name = file.readName();
+        d->comment = file.readComment();
         d->icon = file.readEntry( "Icon" );
         d->author = file.readEntry( "X-KDE-PluginInfo-Author" );
         d->email = file.readEntry( "X-KDE-PluginInfo-Email" );
@@ -97,8 +98,8 @@
     else if( filename.endsWith( QString::fromAscii( ".plugin" ) ) )
     { // provided for noatun style .plugin files compatibility
 
-        d->name = file.readEntry( "Name" );
-        d->comment = file.readEntry( "Comment" );
+        d->name = file.readName();
+        d->comment = file.readComment();
         d->icon = file.readEntry( "Icon" );
         d->author = file.readEntry( "Author" );
         d->email = file.readEntry( "Email" );
Index: kdesu/process.h
===================================================================
--- kdesu/process.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdesu/process.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -112,12 +112,12 @@
     /**
      * Returns the filedescriptor of the process.
      */
-    int fd() {return m_Fd;};
+    int fd() {return m_Fd;}
 
     /**
      * Returns the pid of the process.
      */
-    int pid() {return m_Pid;};
+    int pid() {return m_Pid;}
 
 public: /* static */
     /*
Index: kdesu/kcookie.cpp
===================================================================
--- kdesu/kcookie.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdesu/kcookie.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -172,7 +172,7 @@
 	    break;
 	}
 	QCStringList output;
-	while (fgets(buf, 1024, f) > 0)
+	while (fgets(buf, 1024, f))
 	    output += buf;
 	if (pclose(f) < 0) 
 	{
Index: kdecore/netwm.h
===================================================================
--- kdecore/netwm.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/netwm.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -373,6 +373,22 @@
     int virtualRootsCount() const;
 
     /**
+       Returns the desktop layout orientation.
+    **/
+    NET::Orientation desktopLayoutOrientation() const;
+
+    /**
+       Returns the desktop layout number of columns and rows. Note that
+       either may be 0 (see _NET_DESKTOP_LAYOUT).
+    **/
+    QSize desktopLayoutColumnsRows() const;
+
+    /**
+       Returns the desktop layout starting corner.
+    **/
+    NET::DesktopLayoutCorner desktopLayoutCorner() const;
+
+    /**
        Returns the number of desktops.
 
        @return the number of desktops
@@ -518,6 +534,13 @@
     void setVirtualRoots(Window *windows, unsigned int count);
     
     /**
+       Sets the desktop layout. This is set by the pager. When setting, the pager must
+       own the _NET_DESKTOP_LAYOUT_Sn manager selection. See _NET_DESKTOP_LAYOUT for details.
+    **/
+    void setDesktopLayout(NET::Orientation orientation, int columns, int rows,
+        NET::DesktopLayoutCorner corner);
+
+    /**
      * Sets the _NET_SHOWING_DESKTOP status (whether desktop is being shown).
      * @since 3.5
      */
Index: kdecore/kcmdlineargs.cpp
===================================================================
--- kdecore/kcmdlineargs.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/kcmdlineargs.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1248,21 +1248,22 @@
 
 KURL KCmdLineArgs::makeURL(const char *_urlArg)
 {
-   QString urlArg = QFile::decodeName(_urlArg);
-   if (!QDir::isRelativePath(urlArg))
-   {
+   const QString urlArg = QFile::decodeName(_urlArg);
+   QFileInfo fileInfo(urlArg);
+   if (!fileInfo.isRelative()) { // i.e. starts with '/', on unix
       KURL result;
       result.setPath(urlArg);
       return result; // Absolute path.
    }
 
-   if ( !KURL::isRelativeURL(urlArg) )
-     return KURL(urlArg); // Argument is a URL
+   if ( KURL::isRelativeURL(urlArg) || fileInfo.exists() ) {
+      KURL result;
+      result.setPath( cwd()+'/'+urlArg );
+      result.cleanPath();
+      return result;  // Relative path
+   }
 
-   KURL result;
-   result.setPath( cwd()+"/"+urlArg );
-   result.cleanPath();
-   return result;  // Relative path
+   return KURL(urlArg); // Argument is a URL
 }
 
 void
Index: kdecore/eventsrc
===================================================================
--- kdecore/eventsrc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/eventsrc	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1793,7 +1793,10 @@
 Name[el]=Η αποσύνδεση ακυρώθηκε
 Name[es]=Salida cancelada
 Name[et]=Väljalogimine katkestatud
+Name[fi]=Uloskirjautuminen peruttu
+Name[fr]=Annulation de la déconnexion
 Name[fy]=Ofmelding ôfbrutsen
+Name[hr]=Odjavljivanje prekinuto
 Name[hu]=Kijelentkezés megszakítva
 Name[is]=Hætt við útstimplun
 Name[it]=Uscita annullata
@@ -1827,7 +1830,10 @@
 Comment[el]=Η αποσύνδεση από το KDE ακυρώθηκε
 Comment[es]=La salida de KDE fue cancelada
 Comment[et]=KDE väljalogimine katkestati
+Comment[fi]=KDE:n uloskirjautuminen on peruttu
+Comment[fr]=La déconnexion de KDE a été annulée
 Comment[fy]=KDE ôfmelding wie ôfbrutsen
+Comment[hr]=KDE odjavljivanje je prekinuto
 Comment[hu]=A KDE-s kijelentkezés megszakadt
 Comment[is]=Hætt var við KDE útstimplun
 Comment[it]=L'uscita da KDE è stata annullata
Index: kdecore/kiconloader.cpp
===================================================================
--- kdecore/kiconloader.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/kiconloader.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -460,19 +460,17 @@
     static const QString &xpm_ext = KGlobal::staticQString(".xpm");
     ext[count++]=&xpm_ext;
 
-    /* antlarr: Multiple inheritance is a broken concept on icon themes, so
-       the next code doesn't support it on purpose because in fact, it was
-       never supported at all. This makes the order in which we look for an
-       icon as:
+    /* JRT: To follow the XDG spec, the order in which we look for an
+       icon 1s:
 
        png, svgz, svg, xpm exact match
+       png, svgz, svg, xpm best match
        next theme in inheritance tree : png, svgz, svg, xpm exact match
+                                        png, svgz, svg, xpm best match
        next theme in inheritance tree : png, svgz, svg, xpm exact match
+                                        png, svgz, svg, xpm best match
        and so on
 
-       And if the icon couldn't be found then it tries best match in the same
-       order.
-
        */
     for ( KIconThemeNode *themeNode = d->links.first() ; themeNode ;
 	themeNode = d->links.next() )
@@ -484,11 +482,6 @@
 		return icon;
 	}
 
-    }
-
-    for ( KIconThemeNode *themeNode = d->links.first() ; themeNode ;
-	themeNode = d->links.next() )
-    {
 	for (int i = 0 ; i < count ; i++)
 	{
 	    icon = themeNode->theme->iconPath(name + *ext[i], size, KIcon::MatchBest);
Index: kdecore/netwm_p.h
===================================================================
--- kdecore/netwm_p.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/netwm_p.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -103,6 +103,9 @@
     unsigned long clients_count, stacking_count, virtual_roots_count,
 	kde_system_tray_windows_count;
     bool showing_desktop;
+    NET::Orientation desktop_layout_orientation;
+    NET::DesktopLayoutCorner desktop_layout_corner;
+    int desktop_layout_columns, desktop_layout_rows;
 
     unsigned long properties[ 5 ];
     unsigned long client_properties[ 5 ]; // properties the client is interested in
Index: kdecore/kgrantpty.c
===================================================================
--- kdecore/kgrantpty.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/kgrantpty.c	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -36,7 +36,7 @@
 #include <unistd.h>
 
 #include <sys/param.h>
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 #  define BSD_PTY_HACK
 #  include <paths.h>
 #  include <dirent.h>
Index: kdecore/kapplication.cpp
===================================================================
--- kdecore/kapplication.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/kapplication.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -518,7 +518,7 @@
     {
         QWidget* w = static_cast< QWidget* >( receiver );
 #if defined Q_WS_X11
-        if( w->isTopLevel() && !startupId().isEmpty()) // TODO better done using window group leader?
+        if( w->isTopLevel() && !startupId().isEmpty() && !static_cast<QShowEvent*>(event)->spontaneous()) // TODO better done using window group leader?
             KStartupInfo::setWindowStartupId( w->winId(), startupId());
 #endif
         if( w->isTopLevel() && !w->testWFlags( WX11BypassWM ) && !w->isPopup() && !event->spontaneous())
@@ -2597,6 +2597,9 @@
       {
          if (error)
             *error = i18n("Could not register with DCOP.\n");
+         if (!kapp)
+            delete dcopClient;
+
          return -1;
       }
    }
Index: kdecore/netwm_def.h
===================================================================
--- kdecore/netwm_def.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/netwm_def.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -590,6 +590,7 @@
         @li WM2WindowClass  WM_CLASS
         @li WM2WindowRole   WM_WINDOW_ROLE
         @li WM2ClientMachine WM_CLIENT_MACHINE
+        @li WM2DesktopLayout _NET_DESKTOP_LAYOUT
         
         @since 3.2
 
@@ -608,7 +609,8 @@
         WM2WindowClass         = 1<<10, ///< @since 3.3
         WM2WindowRole          = 1<<11, ///< @since 3.3
         WM2ClientMachine       = 1<<12, ///< @since 3.3
-        WM2ShowingDesktop      = 1<<13  ///< @since 3.5
+        WM2ShowingDesktop      = 1<<13, ///< @since 3.5
+        WM2DesktopLayout       = 1<<15  ///< @since 3.5.8
     };
 
     /**
@@ -632,6 +634,24 @@
     };
     
     /**
+      Orientation.
+    **/
+    enum Orientation {
+        OrientationHorizontal = 0,
+        OrientationVertical = 1
+    };
+    
+    /**
+     Starting corner for desktop layout.
+    **/
+    enum DesktopLayoutCorner {
+        DesktopLayoutCornerTopLeft = 0,
+        DesktopLayoutCornerTopRight = 1,
+        DesktopLayoutCornerBottomLeft = 2,
+        DesktopLayoutCornerBottomRight = 3
+    };
+    
+    /**
      Compares two X timestamps, taking into account wrapping and 64bit architectures.
      Return value is like with strcmp(), 0 for equal, -1 for time1 < time2, 1 for time1 > time2.
      @since 3.5.3
Index: kdecore/netwm.cpp
===================================================================
--- kdecore/netwm.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdecore/netwm.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -56,6 +56,7 @@
 static Atom net_supporting_wm_check  = 0;
 static Atom net_virtual_roots        = 0;
 static Atom net_showing_desktop      = 0;
+static Atom net_desktop_layout       = 0;
 
 // root window messages
 static Atom net_close_window         = 0;
@@ -235,7 +236,7 @@
 }
 
 
-static const int netAtomCount = 83;
+static const int netAtomCount = 84;
 static void create_atoms(Display *d) {
     static const char * const names[netAtomCount] =
     {
@@ -252,6 +253,7 @@
 	    "_NET_ACTIVE_WINDOW",
 	    "_NET_WORKAREA",
 	    "_NET_VIRTUAL_ROOTS",
+            "_NET_DESKTOP_LAYOUT",
             "_NET_SHOWING_DESKTOP",
 	    "_NET_CLOSE_WINDOW",
             "_NET_RESTACK_WINDOW",
@@ -346,6 +348,7 @@
 	    &net_active_window,
 	    &net_workarea,
 	    &net_virtual_roots,
+            &net_desktop_layout,
             &net_showing_desktop,
 	    &net_close_window,
             &net_restack_window,
@@ -613,6 +616,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     if( properties_size > PROPERTIES_SIZE ) {
         fprintf( stderr, "NETRootInfo::NETRootInfo(): properties array too large\n");
@@ -624,7 +630,7 @@
     p->properties[ PROTOCOLS ] |= ( Supported | SupportingWMCheck );
     p->client_properties[ PROTOCOLS ] = DesktopNames // the only thing that can be changed by clients
 			                | WMPing; // or they can reply to this
-    p->client_properties[ PROTOCOLS2 ] = WM2TakeActivity;
+    p->client_properties[ PROTOCOLS2 ] = WM2TakeActivity | WM2DesktopLayout;
 
     role = WindowManager;
 
@@ -711,6 +717,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     if( properties_size > 2 ) {
         fprintf( stderr, "NETWinInfo::NETWinInfo(): properties array too large\n");
@@ -769,6 +778,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     p->client_properties[ PROTOCOLS ] = properties;
     for( int i = 0; i < PROPERTIES_SIZE; ++i )
@@ -873,6 +885,7 @@
 #endif
 
 	setSupported();
+	update(p->client_properties);
     } else {
 
 #ifdef    NETWMDEBUG
@@ -1166,6 +1179,9 @@
     if (p->properties[ PROTOCOLS ] & VirtualRoots)
 	atoms[pnum++] = net_virtual_roots;
 
+    if (p->properties[ PROTOCOLS2 ] & WM2DesktopLayout)
+	atoms[pnum++] = net_desktop_layout;
+
     if (p->properties[ PROTOCOLS ] & CloseWindow)
 	atoms[pnum++] = net_close_window;
 
@@ -1398,6 +1414,9 @@
     else if( atom == net_virtual_roots )
         p->properties[ PROTOCOLS ] |= VirtualRoots;
 
+    else if( atom == net_desktop_layout )
+        p->properties[ PROTOCOLS2 ] |= WM2DesktopLayout;
+
     else if( atom == net_close_window )
         p->properties[ PROTOCOLS ] |= CloseWindow;
 
@@ -1652,6 +1671,29 @@
 }
 
 
+void NETRootInfo::setDesktopLayout(NET::Orientation orientation, int columns, int rows,
+    NET::DesktopLayoutCorner corner)
+{
+    p->desktop_layout_orientation = orientation;
+    p->desktop_layout_columns = columns;
+    p->desktop_layout_rows = rows;
+    p->desktop_layout_corner = corner;
+
+#ifdef   NETWMDEBUG
+    fprintf(stderr, "NETRootInfo::setDesktopLayout: %d %d %d %d\n",
+	    orientation, columns, rows, corner);
+#endif
+
+    long data[ 4 ];
+    data[ 0 ] = orientation;
+    data[ 1 ] = columns;
+    data[ 2 ] = rows;
+    data[ 3 ] = corner;
+    XChangeProperty(p->display, p->root, net_desktop_layout, XA_CARDINAL, 32,
+		    PropModeReplace, (unsigned char *) &data, 4);
+}
+
+
 void NETRootInfo::setShowingDesktop( bool showing ) {
     if (role == WindowManager) {
 	long d = p->showing_desktop = showing;
@@ -2547,6 +2589,36 @@
 	}
     }
 
+    if (dirty2 & WM2DesktopLayout) {
+        p->desktop_layout_orientation = OrientationHorizontal;
+        p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+        p->desktop_layout_columns = p->desktop_layout_rows = 0;
+	if (XGetWindowProperty(p->display, p->root, net_desktop_layout,
+			       0, MAX_PROP_SIZE, False, XA_CARDINAL, &type_ret,
+			       &format_ret, &nitems_ret, &unused, &data_ret)
+	    == Success) {
+	    if (type_ret == XA_CARDINAL && format_ret == 32) {
+                long* data = (long*) data_ret;
+                if( nitems_ret >= 4 && data[ 3 ] >= 0 && data[ 3 ] <= 3 )
+                    p->desktop_layout_corner = (NET::DesktopLayoutCorner)data[ 3 ];
+                if( nitems_ret >= 3 ) {
+                    if( data[ 0 ] >= 0 && data[ 0 ] <= 1 )
+                        p->desktop_layout_orientation = (NET::Orientation)data[ 0 ];
+                    p->desktop_layout_columns = data[ 1 ];
+                    p->desktop_layout_rows = data[ 2 ];
+                }
+	    }
+
+#ifdef    NETWMDEBUG
+	    fprintf(stderr, "NETRootInfo::updated: desktop layout updated (%d %d %d %d)\n",
+                p->desktop_layout_orientation, p->desktop_layout_columns,
+                p->desktop_layout_rows, p->desktop_layout_corner );
+#endif
+	    if ( data_ret )
+		XFree(data_ret);
+	}
+    }
+
     if (dirty2 & WM2ShowingDesktop) {
         p->showing_desktop = false;
 	if (XGetWindowProperty(p->display, p->root, net_showing_desktop,
@@ -2702,6 +2774,21 @@
 }
 
 
+NET::Orientation NETRootInfo::desktopLayoutOrientation() const {
+    return p->desktop_layout_orientation;
+}
+
+
+QSize NETRootInfo::desktopLayoutColumnsRows() const {
+    return QSize( p->desktop_layout_columns, p->desktop_layout_rows );
+}
+
+
+NET::DesktopLayoutCorner NETRootInfo::desktopLayoutCorner() const {
+    return p->desktop_layout_corner;
+}
+
+
 int NETRootInfo::numberOfDesktops() const {
     return p->number_of_desktops == 0 ? 1 : p->number_of_desktops;
 }
Index: khtml/khtmlview.cpp
===================================================================
--- khtml/khtmlview.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ khtml/khtmlview.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -1252,8 +1252,17 @@
 
     if ( ( mailtoCursor || newWindowCursor ) && isVisible() && hasFocus() ) {
 #ifdef Q_WS_X11
+        QPixmap icon_pixmap = KGlobal::iconLoader()->loadIcon( mailtoCursor ? "mail_generic" : "window_new", KIcon::Small, 0, KIcon::DefaultState, 0, true );
+
+        if (d->cursor_icon_widget) {
+            const QPixmap *pm = d->cursor_icon_widget->backgroundPixmap();
+            if (!pm || pm->serialNumber()!=icon_pixmap.serialNumber()) {
+                delete d->cursor_icon_widget;
+                d->cursor_icon_widget = 0;
+            }
+        }
+
         if( !d->cursor_icon_widget ) {
-            QPixmap icon_pixmap = KGlobal::iconLoader()->loadIcon( mailtoCursor ? "mail_generic" : "window_new", KIcon::Small, 0, KIcon::DefaultState, 0, true );
             d->cursor_icon_widget = new QWidget( NULL, NULL, WX11BypassWM );
             XSetWindowAttributes attr;
             attr.save_under = True;
Index: khtml/html/html_elementimpl.cpp
===================================================================
--- khtml/html/html_elementimpl.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ khtml/html/html_elementimpl.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -503,7 +503,6 @@
         case ID_COLGROUP:
         case ID_FRAMESET:
         case ID_HEAD:
-        case ID_STYLE:
         case ID_TABLE:
         case ID_TBODY:
         case ID_TFOOT:
Index: khtml/rendering/render_flow.cpp
===================================================================
--- khtml/rendering/render_flow.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ khtml/rendering/render_flow.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -85,7 +85,7 @@
 void RenderFlow::addChildWithContinuation(RenderObject* newChild, RenderObject* beforeChild)
 {
     RenderFlow* flow = continuationBefore(beforeChild);
-    while(beforeChild && beforeChild->parent() != this && !beforeChild->parent()->isAnonymousBlock()) {
+    while(beforeChild && beforeChild->parent() != flow && !beforeChild->parent()->isAnonymousBlock()) {
         // skip implicit containers around beforeChild
         beforeChild = beforeChild->parent();
     }
Index: dcop/dcopserver.cpp
===================================================================
--- dcop/dcopserver.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ dcop/dcopserver.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -35,6 +35,7 @@
 #include <sys/param.h>
 #endif
 #include <sys/resource.h>
+#include <sys/socket.h>
 
 #include <unistd.h>
 #include <stdlib.h>
@@ -171,19 +172,7 @@
 
 	if (iceConn->io_ok)
 	{
-		
-//		nwritten = _kde_IceTransWrite (iceConn->trans_conn, ptr, (int) nleft);
-
-		/*
-		Use special write handling on windows platform. The write function from
-		the runtime library (on MSVC) does not allow to write on sockets.
-		*/
-#ifdef Q_OS_WIN
 		nwritten = send(fd, ptr, (int) nleft, 0);
-#else
-		nwritten = write(fd, ptr, (int) nleft);
-#endif
-
 	}
 	else
 	    return 0;
@@ -355,11 +344,7 @@
 	the runtime library (on MSVC) does not allow to write on sockets.
    */
    int nwritten;
-#ifdef Q_OS_WIN
    nwritten = ::send(fd,data.data()+outputBufferStart,data.size()-outputBufferStart,0);
-#else
-   nwritten = write(fd, data.data()+outputBufferStart, data.size()-outputBufferStart);
-#endif
    
    int e = errno;
    fcntl(fd, F_SETFL, fd_fl);
Index: dcop/dcopclient.cpp
===================================================================
--- dcop/dcopclient.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ dcop/dcopclient.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -41,6 +41,8 @@
 #include <sys/stat.h>
 #include <sys/file.h>
 #include <sys/socket.h>
+#include <fcntl.h>
+#include <unistd.h>
 
 #include <ctype.h>
 #include <unistd.h>
@@ -818,6 +820,7 @@
         emit attachFailed(QString::fromLatin1( errBuf ));
         return false;
     }
+    fcntl(socket(), F_SETFL, FD_CLOEXEC);
 
     IceSetShutdownNegotiation(d->iceConn, False);
 
Index: kjs/configure.in.in
===================================================================
--- kjs/configure.in.in	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kjs/configure.in.in	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -16,7 +16,8 @@
     LIBS="-lm"
     AC_MSG_CHECKING([for isnan with <math.h>])
     AC_TRY_LINK(
-	[#include <math.h>], [float f = 0.0; isnan(f)],
+	[#include <math.h>
+         float f;], [return isnan(f)],
 	[AC_MSG_RESULT(yes)
 	    AC_DEFINE([HAVE_FUNC_ISNAN], [1], [Define if you have isnan])],
 	AC_MSG_RESULT(no)
@@ -29,7 +30,8 @@
     LIBS="-lm"
     AC_MSG_CHECKING([for isinf with <math.h>])
     AC_TRY_LINK(
-	[#include <math.h>], [float f = 0.0; isinf(f)],
+	[#include <math.h>
+         float f;], [return isinf(f)],
 	[AC_MSG_RESULT(yes)
 	    AC_DEFINE([HAVE_FUNC_ISINF], [1], [Define if you have isinf])],
 	AC_MSG_RESULT(no)
Index: kdoctools/customization/nl/user.entities
===================================================================
--- kdoctools/customization/nl/user.entities	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdoctools/customization/nl/user.entities	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -36,6 +36,7 @@
 <!ENTITY Sander.Koning      '<othercredit role="translator"><firstname>Alexander</firstname><surname>S. Koning</surname><affiliation><address><email>sanderkoning@kde.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY Natalie.Koning      '<othercredit role="translator"><firstname>Natalie</firstname><surname>Koning</surname><affiliation><address><email>nat@switch.demon.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY Antoon.Tolboom      '<othercredit role="translator"><firstname>Antoon</firstname><surname>Tolboom</surname><affiliation><address><email>atolboo@casema.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
+<!ENTITY Jordy.Ritico      '<othercredit role="translator"><firstname>Jordy</firstname><surname>Ritico</surname><affiliation><address><email>jordyritico@hotmail.com</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY kde.nl.groep       "<email>i18n@kde.nl</email>">
 
 <!-- Tekstschema's -->
@@ -70,6 +71,7 @@
 <!ENTITY vertaling.sander       "<para>Dit document is vertaald in het Nederlands door &Sander.Koning;.</para>">
 <!ENTITY vertaling.natalie      "<para>Dit document is vertaald in het Nederlands door &Natalie.Koning;.</para>">
 <!ENTITY vertaling.antoon       "<para>Dit document is vertaald in het Nederlands door &Antoon.Tolboom;.</para>">
+<!ENTITY vertaling.jordy        "<para>Dit document is vertaald in het Nederlands door &Jordy.Ritico;.</para>">
 
 
 <!-- Gebruiken als template voor nieuwe vertalers/nalezers
@@ -105,6 +107,7 @@
 <!ENTITY nagelezen.sander     "<para>De vertaling werd nagelezen door &Sander.Koning;.</para>">
 <!ENTITY nagelezen.natalie    "<para>De vertaling werd nagelezen door &Natalie.Koning;.</para>">
 <!ENTITY nagelezen.antoon     "<para>De vertaling werd nagelezen door &Antoon.Tolboom;.</para>">
+<!ENTITY nagelezen.jordy      "<para>De vertaling werd nagelezen door &Jordy.Ritico;.</para>">
 
 <!-- Algemene afkortingen -->
 <!ENTITY Alt     "<keycap>Alt</keycap>">
Index: kdeprint/management/kxmlcommanddlg.cpp
===================================================================
--- kdeprint/management/kxmlcommanddlg.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeprint/management/kxmlcommanddlg.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -171,7 +171,8 @@
 	m_outputpipe = new QLineEdit(gb_output);
 
 	m_comment = new KTextEdit( this );
-	m_comment->setTextFormat( Qt::PlainText );
+	m_comment->setTextFormat(Qt::RichText );
+	m_comment->setReadOnly(true);
 	QLabel *m_commentlab = new QLabel( i18n( "Comment:" ), this );
 
 	QVBoxLayout	*l2 = new QVBoxLayout(this, 0, KDialog::spacingHint());
Index: kdeui/kdatepicker.h
===================================================================
--- kdeui/kdatepicker.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kdatepicker.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -121,7 +121,7 @@
    * widget.
    * @since 3.2
    */
-  KDateTable *dateTable() const { return table; };
+  KDateTable *dateTable() const { return table; }
 
   /**
    * Sets the font size of the widgets elements.
Index: kdeui/kpixmapregionselectordialog.h
===================================================================
--- kdeui/kpixmapregionselectordialog.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kpixmapregionselectordialog.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -59,7 +59,7 @@
     * parameters can be set by using it.
     */
    KPixmapRegionSelectorWidget *pixmapRegionSelectorWidget() const 
-      { return m_pixmapSelectorWidget; };
+      { return m_pixmapSelectorWidget; }
    
    /**
     * Creates a modal dialog, lets the user to select a region of the @p pixmap
Index: kdeui/kcmodule.h
===================================================================
--- kdeui/kcmodule.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kcmodule.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -163,7 +163,7 @@
    *
    * @note The default behavior is to call defaults().
    */
-  virtual void sysdefaults() { defaults(); };
+  virtual void sysdefaults() { defaults(); }
   // KDE 4 deprecate
 
   /**
@@ -200,7 +200,7 @@
    *
    * @see KCModule::setButtons
    */
-  int buttons() const { return _btn; };
+  int buttons() const { return _btn; }
 
   /**
    * Get the RootOnly message for this module.
@@ -306,7 +306,7 @@
    *
    * @see KCModule::buttons
    */
-  void setButtons(int btn) { _btn = btn; };
+  void setButtons(int btn) { _btn = btn; }
 
   /**
    * Sets the RootOnly message.
Index: kdeui/kcolordrag.h
===================================================================
--- kdeui/kcolordrag.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kcolordrag.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -45,7 +45,7 @@
      * Constructs a color drag with the color @p col.
      */
     KColorDrag( const QColor &col, QWidget *dragsource = 0, const char *name = 0 );
-    virtual ~KColorDrag() {};
+    virtual ~KColorDrag() {}
 
     virtual const char *format(int i) const;
     virtual QByteArray encodedData ( const char * m ) const;
Index: kdeui/kactionselector.h
===================================================================
--- kdeui/kactionselector.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kactionselector.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -370,7 +370,7 @@
   /**
     connected to both list boxes to set the buttons enabled
   */
-  void slotCurrentChanged( QListBoxItem * ) { setButtonsEnabled(); };
+  void slotCurrentChanged( QListBoxItem * ) { setButtonsEnabled(); }
 
 private:
 
Index: kdeui/kdatetbl.cpp
===================================================================
--- kdeui/kdatetbl.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kdatetbl.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -665,7 +665,7 @@
 public:
         KDateInternalMonthPrivate (int y, int m, int d)
         : year(y), month(m), day(d)
-        {};
+        {}
         int year;
         int month;
         int day;
Index: kdeui/kpanelextension.h
===================================================================
--- kdeui/kpanelextension.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kpanelextension.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -303,14 +303,14 @@
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void positionChange( Position ) {};
+    virtual void positionChange( Position ) {}
 
     /**
      * This extension has changed its alignment.
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void alignmentChange( Alignment ) {};
+    virtual void alignmentChange( Alignment ) {}
 
     /**
      * Use this method to set the custom menu for this extensions so that it can be shown
Index: kdeui/kmainwindow.cpp
===================================================================
--- kdeui/kmainwindow.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kmainwindow.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -86,7 +86,7 @@
 public:
     KMWSessionManaged()
     {
-    };
+    }
     ~KMWSessionManaged()
     {
     }
Index: kdeui/kcombobox.h
===================================================================
--- kdeui/kcombobox.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kcombobox.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -457,7 +457,7 @@
     /**
     * @deprecated
     */
-    virtual void itemSelected( QListBoxItem* ) {};
+    virtual void itemSelected( QListBoxItem* ) {}
 
     /**
     * Completes text according to the completion mode.
Index: kdeui/kbuttonbox.cpp
===================================================================
--- kdeui/kbuttonbox.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kbuttonbox.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -65,7 +65,7 @@
   unsigned short stretch;
   unsigned short actual_size;
 
-  Item(KPushButton* const _button) : button(_button) {};
+  Item(KPushButton* const _button) : button(_button) {}
 };
 
 template class QPtrList<KButtonBox::Item>;
Index: kdeui/kwindowlistmenu.cpp
===================================================================
--- kdeui/kwindowlistmenu.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kwindowlistmenu.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -61,8 +61,8 @@
 class NameSortedInfoList : public QPtrList<KWin::WindowInfo>
 {
 public:
-    NameSortedInfoList() { setAutoDelete(true); };
-    ~NameSortedInfoList() {};
+    NameSortedInfoList() { setAutoDelete(true); }
+    ~NameSortedInfoList() {}
 
 private:
     int compareItems( QPtrCollection::Item s1, QPtrCollection::Item s2 );
Index: kdeui/kpanelapplet.h
===================================================================
--- kdeui/kpanelapplet.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kpanelapplet.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -324,7 +324,7 @@
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void alignmentChange( Alignment /*a*/ ) {};
+    virtual void alignmentChange( Alignment /*a*/ ) {}
 
     /**
      * Use this method to set the custom menu for this applet so that it can be shown
Index: kdeui/kdockwidget_private.h
===================================================================
--- kdeui/kdockwidget_private.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kdockwidget_private.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -57,7 +57,7 @@
    * @param pos procentual position of the splitter. Must be int [0...100].
    */
   KDockSplitter(QWidget *parent= 0, const char *name= 0, Orientation orient= Vertical, int pos= 50);
-  virtual ~KDockSplitter(){};
+  virtual ~KDockSplitter(){}
 
   /**
    * Initialize the splitter. If @p c0 or @p c1 is 0L the child will not
Index: kdeui/qxembed.cpp
===================================================================
--- kdeui/qxembed.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/qxembed.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -136,7 +136,7 @@
         mapAfterRelease = false;
         lastPos = QPoint(0,0);
     }
-    ~QXEmbedData(){};
+    ~QXEmbedData(){}
 
     bool autoDelete;      // L0101: See L2600
     bool xplain;          // L0102: See L1100
@@ -154,7 +154,7 @@
     {
     public:
         QXEmbedAppFilter()  { qApp->installEventFilter( this ); } 
-        ~QXEmbedAppFilter() { };
+        ~QXEmbedAppFilter() { }
         bool eventFilter( QObject *, QEvent * );
     };
 }
Index: kdeui/kfontcombo.cpp
===================================================================
--- kdeui/kfontcombo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kfontcombo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -40,7 +40,7 @@
           size(0),
           lineSpacing(0)
     {
-    };
+    }
 
     bool bold : 1;
     bool italic : 1;
Index: kdeui/kdockwidget.h
===================================================================
--- kdeui/kdockwidget.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kdockwidget.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -116,23 +116,23 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetAbstractHeader(){};
+  virtual ~KDockWidgetAbstractHeader(){}
 
   /**
    * Provides things concerning to switching to toplevel mode. Must be overridden by an inheriting class.
    */
-  virtual void setTopLevel( bool ){};
+  virtual void setTopLevel( bool ){}
 
 #ifndef NO_KDE2
   /**
    * Provides saving the current configuration. Must be overridden by an inheriting class.
    */
-  virtual void saveConfig( KConfig* ){};
+  virtual void saveConfig( KConfig* ){}
 
   /**
    * Provides loading the current configuration.  Must be overridden by an inheriting class
    */
-  virtual void loadConfig( KConfig* ){};
+  virtual void loadConfig( KConfig* ){}
 #endif
 
 protected:
@@ -167,7 +167,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetAbstractHeaderDrag(){};
+  virtual ~KDockWidgetAbstractHeaderDrag(){}
 
   /**
    * @return the dockwidget where this belongs to
@@ -212,7 +212,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetHeaderDrag(){};
+  virtual ~KDockWidgetHeaderDrag(){}
 
 protected:
 
@@ -251,7 +251,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetHeader(){};
+  virtual ~KDockWidgetHeader(){}
 
   /**
    * Hides the close button and stay button when switching to toplevel or vice versa shows them.
@@ -368,12 +368,12 @@
    * Constructs this. It just calls the method of the base class.
    */
   KDockTabGroup( QWidget *parent = 0, const char *name = 0 )
-  :QTabWidget( parent, name ){};
+  :QTabWidget( parent, name ){}
 
   /**
    * Destructs a KDockTabGroup.
    */
-  virtual ~KDockTabGroup(){};
+  virtual ~KDockTabGroup(){}
 
   QWidget *transientTo();
 protected:
@@ -535,7 +535,7 @@
    *
    * @return The pointer to the dockwidget's child widget, 0L if there's no such child.
    */
-  QWidget* getWidget() const { return widget; };
+  QWidget* getWidget() const { return widget; }
 
   /**
    * Sets the header of this dockwidget.
@@ -594,12 +594,12 @@
    *
    * @param ttStr A string for the tooltip on the tab.
    */
-  void setToolTipString(const QString& ttStr) { toolTipStr = ttStr; };
+  void setToolTipString(const QString& ttStr) { toolTipStr = ttStr; }
 
   /**
    * @return The tooltip string being shown on the appropriate tab page header when in dock-centered mode.
    */
-  const QString& toolTipString() const { return toolTipStr; };
+  const QString& toolTipString() const { return toolTipStr; }
 
   /**
    * @return result @p true, if a dockback is possible, otherwise @p false.
@@ -610,12 +610,12 @@
    * Sets a string that is used for the label of the tab page when in tab page mode
    * @param label The new tab page label.
    */
-  void setTabPageLabel( const QString& label) { tabPageTitle = label; };
+  void setTabPageLabel( const QString& label) { tabPageTitle = label; }
 
   /**
    * @return A string that is used for the label of the tab page when in tab page mode.
    */
-  const QString& tabPageLabel() const { return tabPageTitle; };
+  const QString& tabPageLabel() const { return tabPageTitle; }
 
   /**
    * Catches and processes some QWidget events that are interesting for dockwidgets.
@@ -1123,8 +1123,8 @@
     {
       dock = _dock;
       hide = _hide;
-    };
-    ~MenuDockData(){};
+    }
+    ~MenuDockData(){}
 
     KDockWidget* dock;
     bool hide;
Index: kdeui/kpixmapregionselectorwidget.h
===================================================================
--- kdeui/kpixmapregionselectorwidget.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kpixmapregionselectorwidget.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -66,7 +66,7 @@
     * @return the original whole pixmap that we're using in this widget as the
     * pixmap the user is selecting a region from.
     */
-   QPixmap pixmap() const { return m_unzoomedPixmap; };
+   QPixmap pixmap() const { return m_unzoomedPixmap; }
 
    /**
     * Sets the selected region to be @p rect (in zoomed pixmap coordinates)
Index: kdeui/kstatusbar.h
===================================================================
--- kdeui/kstatusbar.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ kdeui/kstatusbar.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -40,7 +40,7 @@
 
 
   KStatusBarLabel( const QString& text, int _id, KStatusBar* parent = 0L, const char *name=0L );
-  ~KStatusBarLabel () {};
+  ~KStatusBarLabel () {}
 
 protected:
 
Index: libkmid/deviceman.h
===================================================================
--- libkmid/deviceman.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/deviceman.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -204,7 +204,7 @@
      *
      */
     MidiOut *chntodev(int chn)
-		{ return deviceForChannel(chn); };
+		{ return deviceForChannel(chn); }
 
     /**
      * It's possible to send different MIDI channels to different MIDI devices,
@@ -215,12 +215,12 @@
      * be sent.
      */
     MidiOut *deviceForChannel(int chn)
-		{ return (device!=0L) ? device[chn2dev[chn]] : 0L ; };
+		{ return (device!=0L) ? device[chn2dev[chn]] : 0L ; }
 
     /**
      * Returns the device number associated with a given channel.
      */
-    int deviceNumberForChannel(int chn) { return chn2dev[chn]; };
+    int deviceNumberForChannel(int chn) { return chn2dev[chn]; }
 
     /**
      * Sets the device number associated with a given channel.
@@ -236,7 +236,7 @@
     /**
      * Returns true if it's running ALSA and false if OSS is being run
      */
-    int usingAlsa(void) { return alsa; };
+    int usingAlsa(void) { return alsa; }
 
     // The following function are here to emulate a midi, so that the
     // DeviceManager sends the events to the appropriate devices.
@@ -490,7 +490,7 @@
     /**
      * Returns the SNDCTL_SEQ_CTRLRATE ioctl value
      */
-    int rate(void) { return m_rate; };
+    int rate(void) { return m_rate; }
 
     /**
      * Returns the number of MIDI ports available on the system. It's common that
@@ -501,7 +501,7 @@
      * @see synthDevices()
      * @see setDefaultDevice()
      */
-    int midiPorts(void) { return n_midi; };
+    int midiPorts(void) { return n_midi; }
 
     /**
      * Returns the number of internal synthesizers available on the system. Some
@@ -512,7 +512,7 @@
      * @see setDefaultDevice()
      * @see setPatchesToUse()
      */
-    int synthDevices(void) { return n_synths; };
+    int synthDevices(void) { return n_synths; }
 
     /**
      * Returns the name of the @p i-th device . In case the DeviceManager wasn't
Index: libkmid/voiceman.h
===================================================================
--- libkmid/voiceman.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/voiceman.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -151,17 +151,17 @@
     /**
      * Returns the channel that voice @p v is using.
      */
-    int channel(int v) {return VoiceList[v]->channel;};
+    int channel(int v) {return VoiceList[v]->channel;}
 
     /**
      * Returns the note that voice @p v is playing.
      */
-    int note(int v) {return VoiceList[v]->note;};
+    int note(int v) {return VoiceList[v]->note;}
 
     /**
      * Returns true or false if the voice @p v is being used or not respectively.
      */
-    int used(int v) {return VoiceList[v]->used;};
+    int used(int v) {return VoiceList[v]->used;}
 
     /**
      * Clears the lists of used voices.
Index: libkmid/notearray.h
===================================================================
--- libkmid/notearray.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/notearray.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -123,12 +123,12 @@
    * @see get()
    * @see next()
    */ 
-  void iteratorBegin(void) { it=data; };
+  void iteratorBegin(void) { it=data; }
 
   /**
    * Get the command currently pointed to by the iterator.
    */
-  noteCmd *get(void)       { return it; };
+  noteCmd *get(void)       { return it; }
 
   /**
    * Advances the iterator to the next position.
Index: libkmid/track.h
===================================================================
--- libkmid/track.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/track.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -202,14 +202,14 @@
     /**
      * Returns the number of ticks left for the next event.
      */
-    ulong	waitTicks   (void) { return wait_ticks; };
+    ulong	waitTicks   (void) { return wait_ticks; }
 
     //	ulong   waitMs (void) {return time_to_next_event;};
 
     /**
      * Returns the absolute number of milliseconds of the next event.
      */ 
-    double   absMsOfNextEvent (void) { return time_at_next_event; };
+    double   absMsOfNextEvent (void) { return time_at_next_event; }
 
     /**
      * Change the tempo of the song.
Index: libkmid/alsaout.h
===================================================================
--- libkmid/alsaout.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/alsaout.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -126,7 +126,7 @@
    *
    * @see deviceName
    */
-  int          deviceType () const { return devicetype; };
+  int          deviceType () const { return devicetype; }
 
   /**
    * Returns the name and type of this MIDI device.
@@ -137,7 +137,7 @@
   /**
    * @internal
    */
-  int  rate    (void) { return m_rate; };
+  int  rate    (void) { return m_rate; }
 
   /**
    * See DeviceManager::noteOn()
@@ -201,7 +201,7 @@
    * an unmodified value, 200 play music twice louder than it should, etc.
    */
   virtual void setVolumePercentage ( int volper )
-  { volumepercentage = volper; };
+  { volumepercentage = volper; }
 
   /**
    * Returns true if everything's ok and false if there has been any problem
@@ -209,7 +209,7 @@
   int ok (void)
   { if (seqfd<0) return 0;
     return (_ok>0);
-  };
+  }
 
   virtual void wait        (double ticks);
   virtual void tmrSetTempo (int v);
Index: libkmid/midistat.h
===================================================================
--- libkmid/midistat.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/midistat.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -83,7 +83,7 @@
     /**
      * Returns the patch currently used in channel @p chn.
      */
-    uchar chnPatch	( uchar chn ) { return chn_patch[chn]; };
+    uchar chnPatch	( uchar chn ) { return chn_patch[chn]; }
 
     /**
      * Stores a new channel pressure value in channel @p chn.
@@ -94,7 +94,7 @@
     /**
      * Returns the pressure value currently used in channel @p chn.
      */
-    uchar chnPressure	( uchar chn ) { return chn_pressure[chn]; };
+    uchar chnPressure	( uchar chn ) { return chn_pressure[chn]; }
 
     /**
      * Stores a new pitch bender value in channel chn
@@ -104,7 +104,7 @@
     /**
      * Returns the pitch bender value used in channel @p chn
      */
-    int chnPitchBender	( uchar chn) { return chn_bender[chn]; };
+    int chnPitchBender	( uchar chn) { return chn_bender[chn]; }
 
     /**
      * Stores a new value for controller @p ctl in channel @p chn.
@@ -115,7 +115,7 @@
      * Returns the value used for controller @p ctl in channel @p chn
      */
     uchar chnController	( uchar chn, uchar ctl ) 
-	{ return chn_controller[chn][ctl]; };
+	{ return chn_controller[chn][ctl]; }
 
     /**
      * Stores a sysex message that will be send in the next call to sendData
Index: libkmid/midimapper.h
===================================================================
--- libkmid/midimapper.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/midimapper.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -169,12 +169,12 @@
     /**
      * Returns the status of the object.
      */
-    int  ok(void) { return _ok; };
+    int  ok(void) { return _ok; }
 
     /** 
      * Returns the channel which chn should be mapped to.
      */ 
-    uchar channel(uchar chn) { return channelmap[chn];};
+    uchar channel(uchar chn) { return channelmap[chn];}
 
     /** 
      * Returns the patch which pgm used on channel chn should be mapped to.
Index: libkmid/player.h
===================================================================
--- libkmid/player.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/player.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -314,13 +314,13 @@
    * Returns true if there's a song already loaded (with a previous call to 
    * loadSong() ) and false if not.
    */
-  int isSongLoaded(void) { return songLoaded; };
+  int isSongLoaded(void) { return songLoaded; }
 
   /**
    * Returns the linked list of SpecialEvents objects . For this to work,
    * the parse should be enabled (the default), by using setParseSong().
    */
-  SpecialEvent *specialEvents() { return spev; };
+  SpecialEvent *specialEvents() { return spev; }
 
   /**
    * Returns and array with the notes playen through the song . MidiPlayer must
@@ -330,7 +330,7 @@
    * Returns an array of notes, (just note on and note off events), in the form
    * of a NoteArray object
    */
-  NoteArray *noteArray(void) { return na; };
+  NoteArray *noteArray(void) { return na; }
 
 
   /**
@@ -372,7 +372,7 @@
    *
    * @see loadSong
    */
-  MidiFileInfo *information(void) { return info; };
+  MidiFileInfo *information(void) { return info; }
 
   /**
    * Sets the position in a song. 
Index: libkmid/midiout.h
===================================================================
--- libkmid/midiout.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 676002)
+++ libkmid/midiout.h	(.../branches/KDE/3.5/kdelibs)	(wersja 676002)
@@ -136,7 +136,7 @@
    *
    * @see deviceName
    */
-  int          deviceType () const { return devicetype; };
+  int          deviceType () const { return devicetype; }
 
   /**
    * Returns the name and type of this MIDI device.
@@ -223,7 +223,7 @@
    * an unmodified value, 200 play music twice louder than it should, etc.
    */
   virtual void setVolumePercentage ( int volper )
-  { volumepercentage = volper; };
+  { volumepercentage = volper; }
 
   /**
    * Returns true if everything's ok and false if there has been any problem
@@ -231,7 +231,7 @@
   int ok (void)
   { if (seqfd<0) return 0;
     return (_ok>0);
-  };
+  }
 
   /**
    * Returns the path to the file where the current used MidiMapper object

Zmiany atrybutów dla: .
___________________________________________________________________
Nazwa: svn:externals
   + admin https://svn.kde.org/home/kde/branches/KDE/3.5/kde-common/admin


