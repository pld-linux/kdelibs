Index: libkscreensaver/main.cpp
===================================================================
--- libkscreensaver/main.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkscreensaver/main.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -113,6 +113,7 @@
     if (args->isSet("setup"))
     {
        QDialog *dlg = kss_setup();
+       args->clear();
        dlg->exec();
        delete dlg;
        exit(0);
@@ -151,12 +152,11 @@
         demoWidget->setFixedSize( 600, 420 );
         demoWidget->show();
     }
-
+    args->clear();
     app.exec();
 
     delete target;
-    if ( demoWidget )
-        delete demoWidget;
+    delete demoWidget;
 
     return 0;
 }
Index: interfaces/kscript/scriptmanager.cpp
===================================================================
--- interfaces/kscript/scriptmanager.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ interfaces/kscript/scriptmanager.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -17,7 +17,7 @@
 		QString scriptFile;
 		QString scriptMethod;
 		ScriptInfo();
-		~ScriptInfo(){};
+		~ScriptInfo(){}
 };
 ScriptInfo::ScriptInfo()
 {
Index: interfaces/kscript/scriptinterface.desktop
===================================================================
--- interfaces/kscript/scriptinterface.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ interfaces/kscript/scriptinterface.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -48,7 +48,7 @@
 Comment[mt]=Magna ġenerika biex tittestja l-interfaċċja tal-iskritti
 Comment[nb]=Dette er et generisk testskript for å teste skriptgrensesnitt.
 Comment[nds]=Dit is en allgemeen Koppel vun Testskripten för dat Pröven vun de Skript-Koppelsteed.
-Comment[ne]=स्क्रिप्ट इन्टरफेस परिक्षणका लागि यो एउटा जेनेरिक परिक्षण स्क्रिप्ट हो ।
+Comment[ne]=स्क्रिप्ट इन्टरफेस परीक्षणका लागि यो एउटा जेनेरिक परीक्षण स्क्रिप्ट हो ।
 Comment[nl]= Dit is een algemene verzameling van testroutines voor het testen dan de script-interface.
 Comment[nn]=Dette er ein generell testskriptmotor for å prøva ut skriptgrensesnittet.
 Comment[nso]=Ye ke engine ya thswaelo ya teko ya kakaretso yeo e somiswago go leka sefahlego sa tshwaelo.
Index: interfaces/kimproxy/interface/kcm_instantmessenger.desktop
===================================================================
--- interfaces/kimproxy/interface/kcm_instantmessenger.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ interfaces/kimproxy/interface/kcm_instantmessenger.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -69,7 +69,7 @@
 Comment[cy]=Mae'r negesydd chwim yn caniatàu sgwrs dwy-ffordd rhwng unigolion a grwpiau.
 Comment[da]=Instant messenger tillader tovejs chat mellem individer og grupper.
 Comment[de]=Der Instant Messenger ermöglicht Chats zwischen Personen und Gruppen in jede Richtung.
-Comment[el]=Ο στιγμιαίος αποστολέας επιτρέπει τη συζήτηση μεταξύ άτομα και ομάδες.
+Comment[el]=Ο στιγμιαίος αποστολέας επιτρέπει τη συζήτηση μεταξύ ατόμων και ομάδων.
 Comment[eo]=La tujmesaĝilo ebligas ambaŭdirekta parolado inter homoj kaj grupoj
 Comment[es]=El Instant Messenger permite conversación en dos sentidos entre indivíduos y grupos.
 Comment[et]=Kiirsuhtlus võimaldab üksikisikute ja gruppide kahepoolset vestlust.
Index: interfaces/kspeech/dcoptexttospeech.desktop
===================================================================
--- interfaces/kspeech/dcoptexttospeech.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ interfaces/kspeech/dcoptexttospeech.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -61,6 +61,7 @@
 Comment[te]=డికాప్ ఇంటర్ఫేస్ కల్గిన వాచకం నుంచి మాటలకు మార్చు సేవ
 Comment[tg]=Хизматгузории Мант-ба-Талаффуз бо интерфейси DCOP
 Comment[th]=บริการเปลี่ยนข้อความเป็นเสียงพูด พร้อมด้วยส่วนติดต่อกับ DCOP
+Comment[tr]=DCOP arayüzü ile Metinden Ses Servisi
 Comment[tt]=DCOP protokolı aşa eşläwçe Mäten-Uquçı Xezmät
 Comment[uk]=Служба синтезу мовлення з інтерфейсом DCOP
 Comment[vi]=Dịch vụ Văn bản sang Tiếng nói có giao diện DCOP
Index: interfaces/ktexteditor/selectioninterfaceext.cpp
===================================================================
--- interfaces/ktexteditor/selectioninterfaceext.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ interfaces/ktexteditor/selectioninterfaceext.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -30,8 +30,8 @@
 //BEGIN KTextEditor::SelectionInterfaceExt
 class KTextEditor::PrivateSelectionInterfaceExt {
   public:
-    PrivateSelectionInterfaceExt() : interface( 0 ) {};
-    ~PrivateSelectionInterfaceExt() {};
+    PrivateSelectionInterfaceExt() : interface( 0 ) {}
+    ~PrivateSelectionInterfaceExt() {}
     
     SelectionExtDCOPInterface *interface;
 };
Index: kate/plugins/autobookmarker/ktexteditor_autobookmarker.desktop
===================================================================
--- kate/plugins/autobookmarker/ktexteditor_autobookmarker.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/plugins/autobookmarker/ktexteditor_autobookmarker.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -102,7 +102,7 @@
 Comment[ms]=Tetapkan penanda buku pada baris yang padan dengan paten apabila dokumen dimuatkan
 Comment[nb]=Bestem bokmerke på linjer som passer til et mønster når dokument blir åpnet
 Comment[nds]=Sett al bi't Laden Leestekens för Regen, op de en Muster passt
-Comment[ne]=कागजात लोड हुँदा बान्की मिल्दो पुस्तकचिनोहरू लाइनमा सेट गर्नुहोस्
+Comment[ne]=कागजात लोड हुँदा बाँन्की मिल्दो पुस्तकचिनोहरू लाइनमा सेट गर्नुहोस्
 Comment[nl]=Plaatsen van bladwijzers op regels die voldoen aan een bepaald patroon zodra het document geopend wordt
 Comment[nn]=Set bokmerke på linjer som passar til eit mønster når dokument vert opna
 Comment[pa]=ਜਦੋਂ ਵੀ ਦਸਤਾਵੇਜ਼ ਨੂੰ ਲੋਡ ਕੀਤਾ ਜਾ ਰਿਹਾ ਹੋਵੇ ਤਾਂ ਬੁੱਕਮਾਰਕ ਨੂੰ ਸਤਰ-ਮੇਲ ਤਰਤੀਬ ਨਿਰਧਾਰਿਤ ਕਰੋ
Index: kate/plugins/isearch/ISearchPlugin.cpp
===================================================================
--- kate/plugins/isearch/ISearchPlugin.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/plugins/isearch/ISearchPlugin.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -382,14 +382,9 @@
 {
 	if( !text.isNull() && !text.isEmpty() ) {
 		m_combo->addToHistory( text );
-		m_combo->insertItem( text );
 		m_lastString = text;
 	}
 
-	m_combo->blockSignals( true );
-	m_combo->clear();
-	m_combo->blockSignals( false );
-
 	if( m_view ) {
 		m_view->setFocus(); // Will call endSearch()
 	}
Index: kate/part/katerenderer.cpp
===================================================================
--- kate/part/katerenderer.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/part/katerenderer.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -798,6 +798,11 @@
     Q_ASSERT(width);
     x += width;
 
+    // How should tabs be treated when they word-wrap on a print-out?
+    // if startcol != 0, this messes up (then again, word wrapping messes up anyway)
+    if (unicode[z] == QChar('\t'))
+      x -= x % width;
+
     if (unicode[z].isSpace())
     {
       lastWhiteSpace = z+1;
@@ -816,11 +821,6 @@
       }
     }
 
-    // How should tabs be treated when they word-wrap on a print-out?
-    // if startcol != 0, this messes up (then again, word wrapping messes up anyway)
-    if (unicode[z] == QChar('\t'))
-      x -= x % width;
-
     if (x <= maxwidth)
     {
       if (lastWhiteSpace > -1)
Index: kate/part/katedocument.h
===================================================================
--- kate/part/katedocument.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/part/katedocument.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -373,7 +373,9 @@
     // these two variables are for resetting the document to
     // non-modified if all changes have been undone...
     KateUndoGroup* lastUndoGroupWhenSaved;
+    KateUndoGroup* lastRedoGroupWhenSaved;
     bool docWasSavedWhenUndoWasEmpty;
+    bool docWasSavedWhenRedoWasEmpty;
 
     // this sets
     void updateModified();
Index: kate/part/kateview.cpp
===================================================================
--- kate/part/kateview.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/part/kateview.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1521,32 +1521,32 @@
       // We have to tag the whole lot if
       // 1) we have a selection, and:
       //  a) it's new; or
-      tagLines(selectStart, selectEnd);
+      tagLines(selectStart, selectEnd, true);
 
     } else if (blockSelectionMode() && (oldSelectStart.col() != selectStart.col() || oldSelectEnd.col() != selectEnd.col())) {
       //  b) we're in block selection mode and the columns have changed
-      tagLines(selectStart, selectEnd);
-      tagLines(oldSelectStart, oldSelectEnd);
+      tagLines(selectStart, selectEnd, true);
+      tagLines(oldSelectStart, oldSelectEnd, true);
 
     } else {
       if (oldSelectStart != selectStart) {
         if (oldSelectStart < selectStart)
-          tagLines(oldSelectStart, selectStart);
+          tagLines(oldSelectStart, selectStart, true);
         else
-          tagLines(selectStart, oldSelectStart);
+          tagLines(selectStart, oldSelectStart, true);
       }
 
       if (oldSelectEnd != selectEnd) {
         if (oldSelectEnd < selectEnd)
-          tagLines(oldSelectEnd, selectEnd);
+          tagLines(oldSelectEnd, selectEnd, true);
         else
-          tagLines(selectEnd, oldSelectEnd);
+          tagLines(selectEnd, oldSelectEnd, true);
       }
     }
 
   } else {
     // No more selection, clean up
-    tagLines(oldSelectStart, oldSelectEnd);
+    tagLines(oldSelectStart, oldSelectEnd, true);
   }
 }
 
Index: kate/part/katedocument.cpp
===================================================================
--- kate/part/katedocument.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/part/katedocument.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -98,7 +98,9 @@
   m_undoDontMerge(false),
   m_undoIgnoreCancel(false),
   lastUndoGroupWhenSaved( 0 ),
+  lastRedoGroupWhenSaved( 0 ),
   docWasSavedWhenUndoWasEmpty( true ),
+  docWasSavedWhenRedoWasEmpty( true ),
   m_modOnHd (false),
   m_modOnHdReason (0),
   m_job (0),
@@ -1546,14 +1548,74 @@
 
 void KateDocument::updateModified()
 {
-  if ( ( lastUndoGroupWhenSaved &&
-         !undoItems.isEmpty() &&
-         undoItems.last() == lastUndoGroupWhenSaved )
-       || ( undoItems.isEmpty() && docWasSavedWhenUndoWasEmpty ) )
+  /*
+  How this works:
+
+    After noticing that there where to many scenarios to take into
+    consideration when using 'if's to toggle the "Modified" flag
+    I came up with this baby, flexible and repetitive calls are
+    minimal.
+
+    A numeric unique pattern is generated by toggleing a set of bits,
+    each bit symbolizes a different state in the Undo Redo structure.
+
+      undoItems.isEmpty() != null          BIT 1
+      redoItems.isEmpty() != null          BIT 2
+      docWasSavedWhenUndoWasEmpty == true  BIT 3
+      docWasSavedWhenRedoWasEmpty == true  BIT 4
+      lastUndoGroupWhenSavedIsLastUndo     BIT 5
+      lastUndoGroupWhenSavedIsLastRedo     BIT 6
+      lastRedoGroupWhenSavedIsLastUndo     BIT 7
+      lastRedoGroupWhenSavedIsLastRedo     BIT 8
+
+    If you find a new pattern, please add it to the patterns array
+  */
+
+  unsigned char currentPattern = 0;
+  const unsigned char patterns[] = {5,16,24,26,88,90,93,133,144,149,165};
+  const unsigned char patternCount = sizeof(patterns);
+  KateUndoGroup* undoLast = 0;
+  KateUndoGroup* redoLast = 0;
+
+  if (undoItems.isEmpty())
   {
-    setModified( false );
-    kdDebug(13020) << k_funcinfo << "setting modified to false!" << endl;
-  };
+    currentPattern |= 1;
+  }
+  else
+  {
+    undoLast = undoItems.last();
+  }
+
+  if (redoItems.isEmpty())
+  {
+    currentPattern |= 2;
+  }
+  else
+  {
+    redoLast = redoItems.last();
+  }
+
+  if (docWasSavedWhenUndoWasEmpty) currentPattern |= 4;
+  if (docWasSavedWhenRedoWasEmpty) currentPattern |= 8;
+  if (lastUndoGroupWhenSaved == undoLast) currentPattern |= 16;
+  if (lastUndoGroupWhenSaved == redoLast) currentPattern |= 32;
+  if (lastRedoGroupWhenSaved == undoLast) currentPattern |= 64;
+  if (lastRedoGroupWhenSaved == redoLast) currentPattern |= 128;
+
+  // This will print out the pattern information
+
+  kdDebug(13020) << k_funcinfo
+    << "Pattern:" << static_cast<unsigned int>(currentPattern) << endl;
+
+  for (uint patternIndex = 0; patternIndex < patternCount; ++patternIndex)
+  {
+    if ( currentPattern == patterns[patternIndex] )
+    {
+      setModified( false );
+      kdDebug(13020) << k_funcinfo << "setting modified to false!" << endl;
+      break;
+    }
+  }
 }
 
 void KateDocument::clearUndo()
@@ -1574,6 +1636,9 @@
   redoItems.clear ();
   redoItems.setAutoDelete (false);
 
+  lastRedoGroupWhenSaved = 0;
+  docWasSavedWhenRedoWasEmpty = false;
+
   emit undoChanged ();
 }
 
@@ -2780,12 +2845,21 @@
     emit modifiedChanged ();
     emit modStateChanged ((Kate::Document *)this);
   }
-  if ( m == false && ! undoItems.isEmpty() )
+  if ( m == false )
   {
-    lastUndoGroupWhenSaved = undoItems.last();
+    if ( ! undoItems.isEmpty() )
+    {
+      lastUndoGroupWhenSaved = undoItems.last();
+    }
+
+    if ( ! redoItems.isEmpty() )
+    {
+      lastRedoGroupWhenSaved = redoItems.last();
+    }
+
+    docWasSavedWhenUndoWasEmpty = undoItems.isEmpty();
+    docWasSavedWhenRedoWasEmpty = redoItems.isEmpty();
   }
-
-  if ( m == false ) docWasSavedWhenUndoWasEmpty = undoItems.isEmpty();
 }
 //END
 
@@ -4373,7 +4447,7 @@
 
     m_reloading = false;
 
-    for (uint z=0; z < tmp.size(); z++)
+    for ( QValueList<int>::size_type z=0; z < tmp.size(); z++ )
     {
       if (z < numLines())
       {
@@ -4577,7 +4651,7 @@
     QString nameOfFile = url().fileName();
 
     bool found = false;
-    for (int i = 0; !found && i < wildcards.size(); ++i)
+    for (QStringList::size_type i = 0; !found && i < wildcards.size(); ++i)
     {
       QRegExp wildcard (wildcards[i], true/*Qt::CaseSensitive*/, true/*QRegExp::Wildcard*/);
 
Index: kate/part/kateviewinternal.cpp
===================================================================
--- kate/part/kateviewinternal.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/part/kateviewinternal.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1653,7 +1653,22 @@
 
   if (maxX && range.wrap) {
     QChar lastCharInLine = textLine(range.line)->getChar(range.endCol - 1);
-    maxX -= m_view->renderer()->config()->fontMetrics()->width(lastCharInLine);
+
+    if (lastCharInLine == QChar('\t')) {
+      int lineSize = 0;
+      int lastTabSize = 0;
+      for(int i = range.startCol; i < range.endCol; i++) {
+        if (textLine(range.line)->getChar(i) == QChar('\t')) {
+          lastTabSize = m_view->tabWidth() - (lineSize % m_view->tabWidth());
+          lineSize += lastTabSize;
+        } else {
+          lineSize++;
+        }
+      }
+      maxX -= lastTabSize * m_view->renderer()->spaceWidth();
+    } else {
+      maxX -= m_view->renderer()->config()->fontMetrics()->width(lastCharInLine);
+    }
   }
 
   return maxX;
@@ -2231,11 +2246,11 @@
       // @@ Do this only when cursor near start/end.
       if( bmStart > bmEnd )
       {
-        tagLines(bmEnd, bmStart, true);
+        tagLines(bmEnd, bmStart);
       }
       else
       {
-        tagLines(bmStart, bmEnd, true);
+        tagLines(bmStart, bmEnd);
       }
     }
     else
@@ -2258,11 +2273,11 @@
       // @@ Do this only when cursor near start/end.
       if( bmStart > bmEnd )
       {
-        tagLines(bmEnd, bmStart, true);
+        tagLines(bmEnd, bmStart);
       }
       else
       {
-        tagLines(bmStart, bmEnd, true);
+        tagLines(bmStart, bmEnd);
       }
     }
     else
Index: kate/scripts/jstest.desktop
===================================================================
--- kate/scripts/jstest.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/scripts/jstest.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -87,7 +87,7 @@
 Comment[ms]=Skrip untuk menguji penskripan bahagian kate
 Comment[nb]=Skript til å teste kate parts skripting
 Comment[nds]=En Skript, dat Kate-Part sien Skriptkönen pröven schall
-Comment[ne]=केट भागको स्क्रिप्टिङ परिक्षणका लागि स्क्रिप्ट
+Comment[ne]=केट भागको स्क्रिप्टिङ परीक्षणका लागि स्क्रिप्ट
 Comment[nl]=Script voor het testen van Kate-part's scriptmogelijkheid
 Comment[nn]=Skript for testing av Kate part-skriptinga
 Comment[pa]=kate part ਦੀ ਸਕ੍ਰਿਪਟਿੰਗ ਦੀ ਜਾਂਚ ਲਈ ਸਕ੍ਰਿਪਟ
Index: kate/data/pascal.xml
===================================================================
--- kate/data/pascal.xml	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/data/pascal.xml	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <!DOCTYPE language SYSTEM "language.dtd">
-<language name="Pascal" version="1.20" kateversion="2.3" section="Sources" extensions="*.pp;*.pas;*.p" mimetype="text/x-pascal">
+<language name="Pascal" version="1.21" kateversion="2.3" section="Sources" extensions="*.pp;*.pas;*.p" mimetype="text/x-pascal">
   <highlighting>
     <list name="keywords">
       <item> and </item>
@@ -84,6 +84,7 @@
       <item> property </item>
       <item> protected </item>
       <item> public </item>
+      <item> read </item>
       <item> qualified </item>
       <item> raise </item>
       <item> restricted </item>
@@ -92,6 +93,7 @@
       <item> threadvar </item>
       <item> try </item>
       <item> virtual </item>
+      <item> write </item>
     </list>
     <list name="types">
       <item> Integer </item>
Index: kate/data/ruby.xml
===================================================================
--- kate/data/ruby.xml	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/data/ruby.xml	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -34,7 +34,7 @@
 -->
 
 <!-- Hold the "language" opening tag on a single line, as mentioned in "language.dtd". -->
-<language name="Ruby" version="1.17" kateversion="2.4" section="Scripts" extensions="*.rb;*.rjs;*.rxml" mimetype="application/x-ruby" author="Stefan Lang (langstefan@gmx.at), Sebastian Vuorinen (sebastian.vuorinen@helsinki.fi)" license="LGPL">
+<language name="Ruby" version="1.17" kateversion="2.4" section="Scripts" extensions="*.rb;*.rjs;*.rxml;*.xml.erb;*.js.erb" mimetype="application/x-ruby" author="Stefan Lang (langstefan@gmx.at), Sebastian Vuorinen (sebastian.vuorinen@helsinki.fi)" license="LGPL">
 	
 	<highlighting>
 	
Index: kate/data/rhtml.xml
===================================================================
--- kate/data/rhtml.xml	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kate/data/rhtml.xml	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -44,7 +44,7 @@
 -->
 	
 <!-- Hold the "language" opening tag on a single line, as mentioned in "language.dtd". -->
-<language name="Ruby/Rails/RHTML" version="1.00" kateversion="2.4" section="Markup" extensions="*.rhtml" mimetype="" author="Richard Dale rdale@foton.es" license="LGPL">
+<language name="Ruby/Rails/RHTML" version="1.00" kateversion="2.4" section="Markup" extensions="*.rhtml;*.html.erb" mimetype="" author="Richard Dale rdale@foton.es" license="LGPL">
 	
 	<highlighting>
 	
Index: libltdl/ltdl.c
===================================================================
--- libltdl/ltdl.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libltdl/ltdl.c	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -2198,29 +2198,33 @@
     /* read the .la file */
     while (!feof(file))
       {
+        line[line_len-2] = '\0';
 	if (!fgets (line, line_len, file))
 	  {
 	    break;
 	  }
 
+        /* Handle the case where we occasionally need to read a line
+           that is longer than the initial buffer size.  */
+        while (line[line_len-2] && (!feof (file)))
+          {
+            line = LT_DLREALLOC (char, line, line_len *2);
+            if (!line || !fgets (&line[line_len -1], (int) line_len +1, file))
+              {
+                error = 1;
+                break;
+              }
+            line_len *= 2;
+          }
 
-	/* Handle the case where we occasionally need to read a line 
-	   that is longer than the initial buffer size.  */
-	while (line[strlen(line) -1] != '\n')
-	  {
-	    line = LT_DLREALLOC (char, line, line_len *2);
-	    if (!fgets (&line[line_len -1], line_len +1, file))
-	      {
-		break;
-	      }
-	    line_len *= 2;
-	  }
-
+        if (error)
+            break;
 	if (line[0] == '\n' || line[0] == '#')
 	  {
 	    continue;
 	  }
 
+
 #undef  STR_DLNAME
 #define STR_DLNAME	"dlname="
 	if (strncmp (line, STR_DLNAME, sizeof (STR_DLNAME) - 1) == 0)
Index: libltdl/ltdl.m4
===================================================================
--- libltdl/ltdl.m4	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libltdl/ltdl.m4	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -97,7 +97,7 @@
 	linux*)
 	  libltdl_cv_sys_dlopen_deplibs=yes
 	  ;;
-	netbsd*|openbsd*|freebsd*)
+	netbsd*|openbsd*|freebsd*|dragonfly*)
 	  libltdl_cv_sys_dlopen_deplibs=yes
 	  ;;
 	solaris*)
Index: doc/common/kde-default.css
===================================================================
--- doc/common/kde-default.css	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ doc/common/kde-default.css	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -33,7 +33,7 @@
   background: white none;
   color: black;
   font-family: sans-serif;
-  padding: 0;
+  padding: 0 15px 0 0;
   margin: 0; 
 }
 
Index: mimetypes/audio/x-pn-realaudio-plugin.desktop
===================================================================
--- mimetypes/audio/x-pn-realaudio-plugin.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/audio/x-pn-realaudio-plugin.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -14,6 +14,8 @@
 Comment[es]=Archivo de extensión para RealAudio
 Comment[et]=RealAudio plugina fail
 Comment[fa]=پروندۀ وصلۀ RealAudio
+Comment[fi]=RealAudio liitännäistiedosto
+Comment[fr]=Fichier RealAudio
 Comment[fy]=RealAudio plugin triem
 Comment[he]=תוסף RealAudio
 Comment[hr]=RealAudio datoteka dodatka
@@ -25,9 +27,11 @@
 Comment[km]=ឯកសារ​កម្មវិធី​ជំនួយ RealAudio
 Comment[lt]=RealAudio priedo byla
 Comment[mk]=Приклучок за RealAudio
+Comment[nb]=Programtilleggsfil for RealAudio
 Comment[nds]=RealAudio-Moduuldatei
 Comment[ne]=रियलअडियो प्लगइन फाइल
 Comment[nl]=RealAudio-bestand
+Comment[nn]=RealAudio-programtilleggfil
 Comment[pa]=RealAudio ਪਲੱਗਇਨ ਫਾਇਲ
 Comment[pl]=Wtyczka RealAudio
 Comment[pt]=Ficheiro de 'Plugin' do RealAudio
@@ -41,6 +45,7 @@
 Comment[te]=రియల్ ఆడియొ ప్లగిన్ దస్త్రం
 Comment[tg]=Файли фаъоли Риал-Аудио
 Comment[th]=แฟ้มปลั๊กอิน RealAudio
+Comment[tr]=RealAudio Eklenti Dosyası
 Comment[uk]=Файл втулку RealAudio
 Comment[zh_CN]=RealAudio 插件文件
 Comment[zh_TW]=RealAudio 外掛程式檔案
Index: mimetypes/audio/aac.desktop
===================================================================
--- mimetypes/audio/aac.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/audio/aac.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -39,7 +39,7 @@
 Comment[it]=Suono AAC
 Comment[ja]=ACC サウンド
 Comment[kk]=AAC дыбыс файлы
-Comment[km]=សម្លេង AAC
+Comment[km]=សំឡេង AAC
 Comment[ko]=AAC 소리
 Comment[lb]=AAC-Sound
 Comment[lt]=AAC garsas
Index: mimetypes/audio/ac3.desktop
===================================================================
--- mimetypes/audio/ac3.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/audio/ac3.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -39,7 +39,7 @@
 Comment[it]=Suono Dolby AC3
 Comment[ja]=ドルビー AC3 サウンド
 Comment[kk]=Dolby AC3 дыбыс файлы
-Comment[km]=សម្លេង Dolby AC3
+Comment[km]=សំឡេង Dolby AC3
 Comment[ko]=돌비 AC3 소리
 Comment[lb]=Dolby-AC3-Sound
 Comment[lt]=Dolby AC3 garsas
Index: mimetypes/image/x-hdr.desktop
===================================================================
--- mimetypes/image/x-hdr.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/x-hdr.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -52,6 +52,7 @@
 Comment[te]=ఎక్కువ పరిణామశీల వ్యాప్తి కలిగిన ప్రతిబింబం
 Comment[tg]=Тасвир бо андозаи динамикии балад
 Comment[th]=แฟ้มภาพแบบช่วงไดนามิคสูง
+Comment[tr]=HDR Resmi
 Comment[tt]=Bik Tere Aralı Sürät
 Comment[uk]=Зображення HDR (High Dynamic Range)
 Comment[vi]=Ảnh phạm vị động cao
Index: mimetypes/image/x-vnd.trolltech.qpicture.desktop
===================================================================
--- mimetypes/image/x-vnd.trolltech.qpicture.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/x-vnd.trolltech.qpicture.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -49,7 +49,7 @@
 Comment[ms]=Fail Meta QPicture
 Comment[nb]=QPicture metafil
 Comment[nds]=QPicture-Metadatei
-Comment[ne]=क्यू तस्विर मेटाफाइल
+Comment[ne]=क्यू तस्वीर मेटाफाइल
 Comment[nl]=QPicture-metabestand
 Comment[nn]=QPicture-metafil
 Comment[pa]=QPicture ਮੈਟਾਫਾਇਲ਼
Index: mimetypes/image/svg+xml.desktop
===================================================================
--- mimetypes/image/svg+xml.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/svg+xml.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -41,7 +41,7 @@
 Comment[mk]=Скалабилна векторска графика
 Comment[mn]=Хувиргаж болох вектор график
 Comment[ms]=Grafik boleh Skala Vektor
-Comment[nb]=Skalerbar vektor-grafikk
+Comment[nb]=Skalerbart vektorbilde
 Comment[nds]=Skaleerbor Vektorgrafik
 Comment[ne]=मापनयोग्य भेक्टर ग्राफिक्स
 Comment[nl]=Schaalbare Vector Afbeelding
Index: mimetypes/image/cgm.desktop
===================================================================
--- mimetypes/image/cgm.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/cgm.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -41,7 +41,7 @@
 Comment[mk]=Метадатотека со компјутерска графика
 Comment[mn]=Компьютерын графикын Мита файл
 Comment[ms]=Fail Meta Grafik Komputer
-Comment[nb]=Metafil for datagrafikk
+Comment[nb]=Metafil for databilde
 Comment[nds]=Reeknergrafik-Metadatei
 Comment[ne]=कम्प्युटर ग्राफिक्स मेटाफाइल
 Comment[nl]=Computer Graphics-metabestand
Index: mimetypes/image/x-photo-cd.desktop
===================================================================
--- mimetypes/image/x-photo-cd.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/x-photo-cd.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -50,7 +50,7 @@
 Comment[mt]=Stampa PhotoCD
 Comment[nb]=PhotoCD-bilde
 Comment[nds]=PhotoCD-Bild
-Comment[ne]=फोटो सी डी छवि
+Comment[ne]=फोटो सीडी छवि
 Comment[nl]=Fotocd-afbeelding
 Comment[nn]=PhotoCD-bilete
 Comment[nso]=Ponagalo ya CD ya Seswantsho
Index: mimetypes/image/x-raw.desktop
===================================================================
--- mimetypes/image/x-raw.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/x-raw.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -58,6 +58,7 @@
 Comment[te]=రా కెమెరా ప్రతిబింబం
 Comment[tg]=RAW тасвири фотоаппарат
 Comment[th]=แฟ้มภาพ RAW จากกล้อง
+Comment[tr]=RAW Fotoğraf Makinesi Resmi
 Comment[uk]=Неопрацьоване зображення з фотоапарата
 Comment[vi]=Ảnh PCX
 Comment[zh_CN]=RAW 相机图像
Index: mimetypes/image/fits.desktop
===================================================================
--- mimetypes/image/fits.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/image/fits.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -60,6 +60,7 @@
 Comment[te]=FITS ప్రతిబింబం
 Comment[tg]=Тасвири FITS
 Comment[th]=แฟ้มภาพ FITS
+Comment[tr]=FITS Resmi
 Comment[uk]=Зображення FITS
 Comment[uz]=FITS-расм
 Comment[vi]=Ảnh FITS
Index: mimetypes/application/chm.desktop
===================================================================
--- mimetypes/application/chm.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/chm.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -55,6 +55,7 @@
 Comment[te]=HTML సహాయ పత్రం
 Comment[tg]=Ҳуҷҷати Ёрмандии HTML
 Comment[th]=เอกสารช่วยเหลือแบบ HTML
+Comment[tr]=HTML Yardım Belgesi
 Comment[uk]=Документ довідки в HTML
 Comment[uz]=HTML ёрдам ҳужжати
 Comment[vi]=Tài liệu trợ giúp HTML
Index: mimetypes/application/x-mplayer2.desktop
===================================================================
--- mimetypes/application/x-mplayer2.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-mplayer2.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -52,6 +52,7 @@
 Comment[te]=మైక్రొసాఫ్ట్ మీడియా వీడియో
 Comment[tg]=Андозаи Майкрософт Медиа
 Comment[th]=รูปแบบแฟ้มสื่อของไมโครซอฟต์
+Comment[tr]=Microsoft Media Biçemi
 Comment[uk]=Формат медіа (Microsoft)
 Comment[uz]=Microsoft Media тури
 Comment[zh_CN]=Microsoft 媒体格式
Index: mimetypes/application/vnd.sun.xml.base.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.base.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.base.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -37,7 +37,7 @@
 Comment[ms]=Pangkalan Data OpenOffice.org
 Comment[nb]=OpenOffice.org database
 Comment[nds]=OpenOffice.org-Datenbank
-Comment[ne]=ओपनअफिस.अर्ग डाटाबेस
+Comment[ne]=ओपनअफिस डट अर्ग डाटाबेस
 Comment[nl]=OpenOffice.org-database
 Comment[nn]=OpenOffice.org-database
 Comment[pa]=OpenOffice.org ਡਾਟਾਬੇਸ
Index: mimetypes/application/x-tbz.desktop
===================================================================
--- mimetypes/application/x-tbz.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-tbz.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -55,6 +55,7 @@
 Comment[te]=బిజిప్ చేయబడిన టార్ ఆర్కైవ్
 Comment[tg]=Архиви Tar Bzip2-карда шуд
 Comment[th]=แฟ้ม Tar บีบอัดด้วย Bzip2
+Comment[tr]=Bzip2 ile Sıkıştırılmış Tar Arşivi
 Comment[uk]=Архів Tar, стиснутий Bzip2
 Comment[uz]=Bzip билан қисилган Tar архиви
 Comment[vi]=Bản Tar đã nén Bzip
Index: mimetypes/application/vnd.sun.xml.writer.master.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.writer.master.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.writer.master.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -40,7 +40,7 @@
 Comment[ms]=OpenOffice.org Dokumen Teks Utama
 Comment[nb]=OpenOffice.org-hovedtekstdokument
 Comment[nds]=OpenOffice-Textvörlaag
-Comment[ne]=ओपनअफिस.अर्ग मास्टर पाठ कागजात
+Comment[ne]=ओपनअफिस डट अर्ग मास्टर पाठ कागजात
 Comment[nl]=OpenOffice.org Text-hoofddocument
 Comment[nn]=OpenOffice.org-hovudtekstdokument
 Comment[pa]=OpenOffice.org ਮਾਸਟਰ ਪਾਠ ਦਸਤਾਵੇਜ਼
Index: mimetypes/application/vnd.sun.xml.calc.template.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.calc.template.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.calc.template.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[ms]=OpenOffice.org Templat Lembaran Kerja
 Comment[nb]=OpenOffice.org-regnearkmal
 Comment[nds]=OpenOffice-Arbeitblattvörlaag
-Comment[ne]=ओपनअफिस.अर्ग स्प्रेडसिट टेम्प्लेट
+Comment[ne]=ओपनअफिस डट अर्ग स्प्रेडसिट टेम्प्लेट
 Comment[nl]=OpenOffice.org Spreadsheet-sjabloon
 Comment[nn]=OpenOffice.org-reknearkmal
 Comment[pa]=OpenOffice.org ਸਾਰਣੀਕਾਰ ਨਮੂਨਾ
Index: mimetypes/application/xml-dtd.desktop
===================================================================
--- mimetypes/application/xml-dtd.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/xml-dtd.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -56,6 +56,7 @@
 Comment[te]=XML డిటిడి పత్రం
 Comment[tg]=Ҳуҷҷати XML DTD
 Comment[th]=เอกสาร XML DTD
+Comment[tr]=XML DTD Belgesi
 Comment[uk]=Документ DTD XML
 Comment[uz]=XML DTD ҳужжати
 Comment[vi]=Tài liệu DTD XML
Index: mimetypes/application/vnd.sun.xml.writer.template.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.writer.template.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.writer.template.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[ms]=OpenOffice.org Templat Dokumen Teks
 Comment[nb]=OpenOffice.org-tekstdokumentmal
 Comment[nds]=OpenOffice-Textdokmentvörlaag
-Comment[ne]=ओपनअफिस.अर्ग पाठ कागजात टेम्प्लेट
+Comment[ne]=ओपनअफिस डट अर्ग पाठ कागजात टेम्प्लेट
 Comment[nl]=OpenOffice.org Text-sjabloon
 Comment[nn]=OpenOffice.org-tekstdokumentmal
 Comment[pa]=OpenOffice.org ਪਾਠ ਦਸਤਾਵੇਜ਼ ਨਮੂਨਾ
Index: mimetypes/application/x-designer.desktop
===================================================================
--- mimetypes/application/x-designer.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-designer.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -69,7 +69,7 @@
 Comment[te]=క్యుటి డిజైనర్ దస్త్రం
 Comment[tg]=Файли Qt Designer
 Comment[th]=แฟ้มตัวออกแบบ Qt
-Comment[tr]=Qt Dizayncı Dosyası
+Comment[tr]=Qt Tasarımcı Dosyası
 Comment[tt]=Qt Tözegeçeneñ Bireme
 Comment[uk]=Файл дизайнера Qt
 Comment[uz]=Qt Designer-файли
Index: mimetypes/application/vnd.sun.xml.writer.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.writer.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.writer.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -45,7 +45,7 @@
 Comment[ms]=Dokumen Teks OpenOffice.org
 Comment[nb]=OpenOffice.org tekstdokument
 Comment[nds]=OpenOffice-Textdokment
-Comment[ne]=ओपनअफिस.अर्ग पाठ कागजात
+Comment[ne]=ओपनअफिस डट अर्ग पाठ कागजात
 Comment[nl]=OpenOffice.org Text-document
 Comment[nn]=OpenOffice.org-tekstdokument
 Comment[pa]=OpenOffice.org ਪਾਠ ਦਸਤਾਵੇਜ਼
Index: mimetypes/application/vnd.oasis.opendocument.graphics-template.desktop
===================================================================
--- mimetypes/application/vnd.oasis.opendocument.graphics-template.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.oasis.opendocument.graphics-template.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[lv]=OASIS OpenDocument grafikas šablons
 Comment[mk]=OASIS OpenDocument-образец за графика
 Comment[ms]=Templat Grafik OpenDocukment OASIS
-Comment[nb]=OASIS Åpent dokument grafikkmal
+Comment[nb]=OASIS Åpent dokument bildemal
 Comment[nds]="OASIS OpenDocument"-Grafikvörlaag
 Comment[ne]=OASIS खुला कागजात ग्राफिक्स टेम्प्लेट
 Comment[nl]=OASIS OpenDocument illustratiesjabloon
Index: mimetypes/application/vnd.sun.xml.impress.template.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.impress.template.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.impress.template.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[ms]=OpenOffice.org Templat Persembahan
 Comment[nb]=OpenOffice.org-presentasjonsmal
 Comment[nds]=OpenOffice-Presentatschoonvörlaag
-Comment[ne]=ओपनअफिस.अर्ग प्रस्तुतिकरण टेम्प्लेट
+Comment[ne]=ओपनअफिस डट अर्ग प्रस्तुतिकरण टेम्प्लेट
 Comment[nl]=OpenOffice.org Presentation-sjabloon
 Comment[nn]=OpenOffice.org-presentasjonsmal
 Comment[pa]=OpenOffice.org ਪੇਸ਼ਕਾਰੀ ਨਮੂਨਾ
Index: mimetypes/application/Makefile.am
===================================================================
--- mimetypes/application/Makefile.am	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/Makefile.am	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -3,7 +3,7 @@
 	x-tex-gf.desktop x-gzip.desktop x-pak.desktop \
 	x-object.desktop x-tex-pk.desktop pdf.desktop \
 	x-tar.desktop x-trash.desktop x-zip.desktop \
-	x-core.desktop x-javascript.desktop \
+	x-zip-compressed.desktop x-core.desktop x-javascript.desktop \
 	java.desktop x-java.desktop x-java-applet.desktop \
 	x-jar.desktop x-arj.desktop x-tarz.desktop \
 	x-gzpostscript.desktop postscript.desktop octet-stream.desktop \
Index: mimetypes/application/vnd.stardivision.impress.desktop
===================================================================
--- mimetypes/application/vnd.stardivision.impress.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.stardivision.impress.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -48,7 +48,7 @@
 Comment[ms]=Persembahan StarOffice Impress
 Comment[nb]=StarOffice Impress presentasjon
 Comment[nds]="StarOffice Impress"-Presentatschoon
-Comment[ne]=स्टार अफिस इम्प्रेस प्रस्तुतिकरण
+Comment[ne]=स्टारअफिस इम्प्रेस प्रस्तुतिकरण
 Comment[nn]=StarOffice Impress-presentasjon
 Comment[nso]=Pontsho ya Kgahlego ya StarOffice
 Comment[pa]=ਸਟਾਰਆਫਿਸ Impress ਪੇਸ਼ਕਾਰ
Index: mimetypes/application/x-sqlite2.desktop
===================================================================
--- mimetypes/application/x-sqlite2.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-sqlite2.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -60,6 +60,7 @@
 Comment[te]=ఎస్క్యూఎల్ ఐట్౨ డెటాబేస్ దస్త్రం
 Comment[tg]=Файли Базаи Маълумотии SQLite2
 Comment[th]=แฟ้มฐานข้อมูล SQLite2
+Comment[tr]=SQLite2 Veritabanı Dosyası
 Comment[uk]=Файл бази даних SQLite2
 Comment[uz]=SQLite2 маълумот база файли
 Comment[vi]=Tập tin cơ sở dữ liệu SQLite2
Index: mimetypes/application/x-sqlite3.desktop
===================================================================
--- mimetypes/application/x-sqlite3.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-sqlite3.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -60,6 +60,7 @@
 Comment[te]=ఎస్క్యూఎల్ ఐట్౩ డెటాబేస్ దస్త్రం
 Comment[tg]=Файли Базаи Маълумотии SQLite3
 Comment[th]=แฟ้มฐานข้อมูล SQLite3
+Comment[tr]=SQLite3 Veritabanı Dosyası
 Comment[uk]=Файл бази даних SQLite3
 Comment[uz]=SQLite3 маълумот база файли
 Comment[vi]=Tập tin cơ sở dữ liệu SQLite3
Index: mimetypes/application/fits.desktop
===================================================================
--- mimetypes/application/fits.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/fits.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -53,6 +53,7 @@
 Comment[te]=FITS దత్తాంసం
 Comment[tg]=Маълумоти FITS
 Comment[th]=ข้อมูล FITS
+Comment[tr]=FITS Verisi
 Comment[uk]=Дані FITS
 Comment[uz]=FITS маълумот
 Comment[vi]=Dữ liệu FITS
Index: mimetypes/application/vnd.sun.xml.impress.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.impress.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.impress.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -45,7 +45,7 @@
 Comment[ms]=Persembahan OpenOffice.org
 Comment[nb]=OpenOffice.org presentasjon
 Comment[nds]=OpenOffice-Presentatschoon
-Comment[ne]=ओपनअफिस.अर्ग प्रस्तुतिकरण
+Comment[ne]=ओपनअफिस डट अर्ग प्रस्तुतिकरण
 Comment[nn]=OpenOffice.org-presentasjon
 Comment[pa]=OpenOffice.org ਪੇਸ਼ਕਾਰੀ
 Comment[pl]=Prezentacja OpenOffice.org
Index: mimetypes/application/vnd.oasis.opendocument.graphics.desktop
===================================================================
--- mimetypes/application/vnd.oasis.opendocument.graphics.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.oasis.opendocument.graphics.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[lv]=OASIS OpenDocument grafika
 Comment[mk]=OASIS OpenDocument-графика
 Comment[ms]=Grafik OpenDocument OASIS
-Comment[nb]=OASIS Åpen dokument grafikk
+Comment[nb]=OASIS Åpen dokument bilde
 Comment[nds]="OASIS OpenDocument"-Grafik
 Comment[ne]=OASIS खुला कागजात ग्राफिक्स
 Comment[nl]=OASIS OpenDocument illustraties
Index: mimetypes/application/vnd.stardivision.writer-global.desktop
===================================================================
--- mimetypes/application/vnd.stardivision.writer-global.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.stardivision.writer-global.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -43,7 +43,7 @@
 Comment[lt]=StarOffice Writer „master“ dokumentas
 Comment[mk]=StarOffice Writer-главен документ
 Comment[ms]=StarOffice Dokumen Writer Utama
-Comment[nb]=StarOffice Writer-hovuddokument
+Comment[nb]=StarOffice Writer-hoveddokument
 Comment[nds]="StarOffice Writer"-Dokment-Vörlaag
 Comment[ne]=स्टारअफिस राइटर मास्टर कागजात
 Comment[nl]=StarOffice Writer-hoofddocument
Index: mimetypes/application/x-applixgraphics.desktop
===================================================================
--- mimetypes/application/x-applixgraphics.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/x-applixgraphics.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -48,7 +48,7 @@
 Comment[mn]=Applix-Graphik-Баримт
 Comment[ms]=Dokumen Grafik Applix
 Comment[mt]=Dokument Applix Graphics
-Comment[nb]=Applix grafikk-dokument
+Comment[nb]=Applix bilde-dokument
 Comment[nds]=Applix Grafik-Dokment
 Comment[ne]=एप्लिक्स ग्राफिक्स कागजात
 Comment[nl]=Applix Graphics-document
Index: mimetypes/application/vnd.sun.xml.draw.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.draw.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.draw.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -44,7 +44,7 @@
 Comment[ms]=OpenOffice.org Lukis
 Comment[nb]=OpenOffice.org tegning
 Comment[nds]=OpenOffice-Teken
-Comment[ne]=ओपनअफिस.अर्ग रेखाचित्र
+Comment[ne]=ओपनअफिस डट अर्ग रेखाचित्र
 Comment[nn]=OpenOffice.org-teikning
 Comment[pa]=OpenOffice.org ਡਰਾਇੰਗ
 Comment[pl]=Rysunek OpenOffice.org
Index: mimetypes/application/vnd.sun.xml.draw.template.desktop
===================================================================
--- mimetypes/application/vnd.sun.xml.draw.template.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/vnd.sun.xml.draw.template.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[ms]=OpenOffice.org Templat Lukis
 Comment[nb]=OpenOffice.org-tegnemal
 Comment[nds]=OpenOffice-Tekenvörlaag
-Comment[ne]=ओपनअफिस.अर्ग रेखाचित्र टेम्प्लेट
+Comment[ne]=ओपनअफिस डट अर्ग रेखाचित्र टेम्प्लेट
 Comment[nl]=OpenOffice.org Drawing-sjabloon
 Comment[nn]=OpenOffice.org-teikningsmal
 Comment[pa]=OpenOffice.org ਡਰਾਇੰਗ ਨਮੂਨਾ
Index: mimetypes/application/mbox.desktop
===================================================================
--- mimetypes/application/mbox.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/application/mbox.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -58,6 +58,7 @@
 Comment[te]=MBOX తపాలా ఫోల్డర్
 Comment[tg]=MBOX Феҳристи почта
 Comment[th]=โฟลเดอร์จดหมาย MBOX
+Comment[tr]=MBOX E-posta Dizini
 Comment[uk]=Поштова тека MBOX
 Comment[uz]=MBOX хат қутиси
 Comment[vi]=Thư mục thư dạng .mbox.
Index: mimetypes/text/x-mswinurl.desktop
===================================================================
--- mimetypes/text/x-mswinurl.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ mimetypes/text/x-mswinurl.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -50,7 +50,7 @@
 Comment[mt]=Taqsira tal-internet
 Comment[nb]=Snarvei til internett
 Comment[nds]=Link in't Internet
-Comment[ne]=इन्टरनेट सर्टकर्ट
+Comment[ne]=इन्टरनेट सर्टकट
 Comment[nl]=Internet snelkoppeling
 Comment[nn]=Internett-snarveg
 Comment[nso]=Tselakopana ya Internet
Index: kioslave/http/http.cc
===================================================================
--- kioslave/http/http.cc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kioslave/http/http.cc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -4269,6 +4269,9 @@
 
         if ( m_cpMimeBuffer )
         {
+          // Do not make any assumption about the state of the QByteArray we received.
+          // Fix the crash described by BR# 130104.
+          d.detach();
           d.resize(0);
           d.resize(m_mimeTypeBuffer.size());
           memcpy( d.data(), m_mimeTypeBuffer.data(),
Index: kioslave/ftp/ftp.cc
===================================================================
--- kioslave/ftp/ftp.cc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kioslave/ftp/ftp.cc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1203,7 +1203,7 @@
   kdDebug(7102) << "ftpCloseCommand: reading command result" << endl;
   m_bBusy = false;
 
-  if(ftpResponse(-1) <= 0 || (m_iRespType != 2) )
+  if(!ftpResponse(-1) || (m_iRespType != 2) )
   {
     kdDebug(7102) << "ftpCloseCommand: no transfer complete message" << endl;
     return false;
@@ -2004,6 +2004,7 @@
   {
     const char* psz = strrchr( ftpResponse(4), '(' );
     if(psz) m_size = charToLongLong(psz+1);
+    if (!m_size) m_size = UnknownSize;
   }
 
   KIO::filesize_t bytesLeft = 0;
@@ -2390,6 +2391,7 @@
   if(!psz)
     return false;
   m_size = charToLongLong(psz);
+  if (!m_size) m_size = UnknownSize;
   return true;
 }
 
Index: kinit/start_kdeinit.c
===================================================================
--- kinit/start_kdeinit.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kinit/start_kdeinit.c	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -24,6 +24,7 @@
 #include <signal.h>
 #include <stdio.h>
 #include <stdlib.h>
+#include <string.h>
 #include <unistd.h>
 
 #ifdef KDEINIT_OOM_PROTECT
@@ -67,6 +68,8 @@
    const char** new_argv;
    char helper_num[ 1024 ];
    int i;
+   char** orig_environ = NULL;
+   char header[ 7 ];
    if( pipe( pipes ) < 0 ) {
       perror( "pipe()" );
       return 1;
@@ -89,6 +92,31 @@
             return 1;
          }
          close( pipes[ 0 ] );
+         /* read original environment passed by start_kdeinit_wrapper */
+         if( read( 0, header, 7 ) == 7 && strncmp( header, "environ", 7 ) == 0 ) {
+             int count;
+             if( read( 0, &count, sizeof( int )) == sizeof( int )) {
+                 char** env = malloc(( count + 1 ) * sizeof( char* ));
+                 int ok = 1;
+                 for( i = 0;
+                      i < count && ok;
+                      ++i ) {
+                     int len;
+                     if( read( 0, &len, sizeof( int )) == sizeof( int )) {
+                         env[ i ] = malloc( len + 1 );
+                         if( read( 0, env[ i ], len ) == len ) {
+                             env[ i ][ len ] = '\0';
+                         } else {
+                             ok = 0;
+                         }
+                     }
+                 }
+                 if( ok ) {
+                   env[ i ] = NULL;
+                   orig_environ = env;
+                 }
+             }
+         }
          if(argc == 0)
             return 1;
          new_argc = argc + 2;
@@ -103,7 +131,10 @@
               i <= argc;
               ++i )
              new_argv[ i + 2 ] = argv[ i ];
-         execv(EXECUTE, (char**)new_argv);
+         if( orig_environ )
+             execve(EXECUTE, (char**)new_argv, orig_environ);
+         else
+             execv(EXECUTE, (char**)new_argv);
          perror(EXECUTE);
          return 1;
       case 0: /* child, keep privileges and do the privileged work */
Index: kinit/start_kdeinit_wrapper.c
===================================================================
--- kinit/start_kdeinit_wrapper.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 0)
+++ kinit/start_kdeinit_wrapper.c	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -0,0 +1,92 @@
+/*
+ * This file is part of the KDE libraries
+ * Copyright (c) 2007 Lubos Lunak <l.lunak@kde.org>
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Library General Public
+ * License version 2 as published by the Free Software Foundation.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Library General Public License for more details.
+ *
+ * You should have received a copy of the GNU Library General Public License
+ * along with this library; see the file COPYING.LIB.  If not, write to
+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+ * Boston, MA 02110-1301, USA.
+ */
+
+#include <config.h>
+
+#include <stdio.h>
+#include <string.h>
+#include <unistd.h>
+
+#ifdef KDEINIT_OOM_PROTECT
+
+/*
+ The start_kdeinit wrapper is setuid, which means some shell variables like LD_LIBRARY_PATH
+ get unset before it's launched. However kdeinit is used to launch most of KDE, so such variables
+ should not be dropped. Therefore this wrapper for the setuid wrapper read the environment
+ and writes it to start_kdeinit's stdin, which after dropping priviledges reads it and uses it
+ for launching the real kdeinit.
+*/
+int main(int argc, char **argv)
+{
+   int pipes[ 2 ];
+   if(argc == 0)
+      return 1;
+   if( pipe( pipes ) < 0 ) {
+      perror( "pipe()" );
+      return 1;
+   }
+   switch( fork()) {
+      case -1:
+         perror( "fork()" );
+         return 1;
+      default: /* parent, exec */ 
+         close( pipes[ 1 ] );
+         close( 0 ); /* stdin */
+         dup2( pipes[ 0 ], 0 );
+         close( pipes[ 0 ] );
+         argv[ 0 ] = (char*)"start_kdeinit";
+         execvp("start_kdeinit", argv);
+         perror("start_kdeinit");
+         return 1;
+      case 0: { /* child, pass env and exit */
+         extern char** environ;
+         int i;
+         close( pipes[ 0 ] );
+         write( pipes[ 1 ], "environ", 7 ); /* header, just in case */
+         for( i = 0;
+              environ[ i ] != NULL;
+              ++i )
+             {}
+         write( pipes[ 1 ], &i, sizeof( int )); /* write count */
+         for( i = 0;
+              environ[ i ] != NULL;
+              ++i )
+             {
+             int len = strlen( environ[ i ] );
+             write( pipes[ 1 ], &len, sizeof( int )); /* write length */
+             write( pipes[ 1 ], environ[ i ], strlen( environ[ i ] ));
+             }
+         close( pipes[ 1 ] );
+         }     
+   }
+   return 0;
+}
+
+#else /* not Linux, the simple non-setuid case */
+
+int main(int argc, char **argv)
+{
+   if(argc == 0)
+      return 1;
+   argv[0] = "start_kdeinit";
+   execv("start_kdeinit",argv);
+   perror("start_kdeinit");
+   return 1;
+}
+#endif
Index: kinit/kinit.cpp
===================================================================
--- kinit/kinit.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kinit/kinit.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1755,7 +1755,6 @@
 
    /** Prepare to change process name **/
    kdeinit_initsetproctitle(argc, argv, envp);
-   kdeinit_setproctitle("kdeinit Starting up...");
    kdeinit_library_path();
    // Don't make our instance the global instance
    // (do it only after kdeinit_library_path, that one indirectly uses KConfig,
Index: kinit/wrapper.c
===================================================================
--- kinit/wrapper.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kinit/wrapper.c	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -351,6 +351,7 @@
       header.cmd = LAUNCHER_TERMINATE_KDE;
       header.arg_length = 0;
       write_socket(sock, (char *) &header, sizeof(header));
+      read_socket(sock, (char *) &header, 1); /* wait for the socket to close */
       return 0;
    }
 
Index: kinit/setproctitle.cpp
===================================================================
--- kinit/setproctitle.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kinit/setproctitle.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -173,6 +173,15 @@
 		else
 			continue;
 	}
+
+        /*
+         * On linux, we don't want to reuse the memory allocated for
+         * the environment, as there are tools that try to read our environment
+         * variables while we're running (ConsoleKit does that). 
+         * There is no way to move or resize it, so just not touchint it
+         * seems to be the only option
+         */
+#ifndef __linux__
 	for (i=0; envp[i] != NULL; i++)
 	{
 		if (LastArgv + 1 == envp[i])
@@ -180,6 +189,7 @@
 		else
 			continue;
 	}
+#endif
 }
 
 #if SPT_TYPE != SPT_BUILTIN
Index: kinit/Makefile.am
===================================================================
--- kinit/Makefile.am	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kinit/Makefile.am	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -20,7 +20,7 @@
 SUBDIRS = . tests
 
 bin_PROGRAMS = kdeinit kdeinit_wrapper kshell kdeinit_shutdown lnusertemp kwrapper kioslave \
-               kstartupconfig kdostartupconfig start_kdeinit
+               kstartupconfig kdostartupconfig start_kdeinit start_kdeinit_wrapper
 
 lib_LTLIBRARIES = 
 kdeinit_LTLIBRARIES = klauncher.la
@@ -71,6 +71,8 @@
 start_kdeinit_CFLAGS = $(KDE_USE_FPIE) -DEXECUTE=\"$(kdeinitpath)\"
 start_kdeinit_LDFLAGS = $(KDE_USE_PIE)
 
+start_kdeinit_wrapper_SOURCES = start_kdeinit_wrapper.c
+
 METASOURCES = AUTO
 
 noinst_HEADERS = klauncher.h autostart.h klauncher_cmds.h setproctitle.h
Index: kimgio/hdr.kimgio
===================================================================
--- kimgio/hdr.kimgio	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kimgio/hdr.kimgio	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -48,6 +48,7 @@
 Name[te]=ఎక్కువ పరిణామశీల వ్యాప్తి కలిగిన ప్రతిబింబం
 Name[tg]=Тасвири динамикии баландқатор
 Name[th]=แฟ้มภาพแบบช่วงไดนามิคสูง
+Name[tr]=HDR Resmi
 Name[tt]=Bik Tere Aralı Sürät
 Name[uk]=Зображення HDR (High Dynamic Range)
 Name[vi]=Ảnh phạm vị động cao
Index: kimgio/psd.kimgio
===================================================================
--- kimgio/psd.kimgio	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kimgio/psd.kimgio	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -56,6 +56,7 @@
 Name[te]=ఎడోబ్ ఫొటోషాప్ ప్రతిబింబం
 Name[tg]=Тасвири Adobe Photoshop
 Name[th]=แฟ้มภาพอโดบีโฟโต้ช้อป
+Name[tr]=Adobe Photoshop Resmi
 Name[uk]=Зображення Adobe Photoshop
 Name[uz]=Adobe Photoshop-расм
 Name[vi]=Ảnh Photoshop của Adobe
Index: kio/kio/knfsshare.cpp
===================================================================
--- kio/kio/knfsshare.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/knfsshare.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -180,7 +180,7 @@
   if ( path[path.length()-1] != '/' )
        fixedPath += '/';
   
-  return d->sharedPaths.find(fixedPath) > 0;
+  return d->sharedPaths.find(fixedPath) != 0;
 }
 
 QStringList KNFSShare::sharedDirectories() const {
Index: kio/kio/kmimetyperesolver.h
===================================================================
--- kio/kio/kmimetyperesolver.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/kmimetyperesolver.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -37,7 +37,7 @@
     virtual void slotViewportAdjusted() = 0;
     virtual void slotProcessMimeIcons() = 0;
 protected:
-    virtual void virtual_hook( int, void* ) {};
+    virtual void virtual_hook( int, void* ) {}
 };
 
 /**
Index: kio/kio/kmimemagic.cpp
===================================================================
--- kio/kio/kmimemagic.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/kmimemagic.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -230,6 +230,9 @@
 #define L_DIFF   0x400          /* Output of diff */
 #define L_OBJC   0x800          /* Objective C */
 
+// Note: this is not a type, it's just used to mark items that should count more
+#define FLAG_STRONG 0x1000
+
 #define P_HTML   0          /* HTML */
 #define P_C      1          /* first and foremost on UNIX */
 #define P_MAKE   2          /* Makefiles */
@@ -271,10 +274,10 @@
 	short type;
 } const names[] = {
 	{
-		"<html", L_HTML
+		"<html", L_HTML | FLAG_STRONG
 	},
 	{
-		"<HTML", L_HTML
+		"<HTML", L_HTML | FLAG_STRONG
 	},
 	{
 		"<head", L_HTML
@@ -340,10 +343,10 @@
 		"<FRAMESET", L_HTML
 	},
         {
-                "<script", L_HTML
+                "<script", L_HTML | FLAG_STRONG
         },
         {
-                "<SCRIPT", L_HTML
+                "<SCRIPT", L_HTML | FLAG_STRONG
         },
 	{
 		"/*", L_C|L_CPP|L_JAVA|L_OBJC
@@ -1881,7 +1884,7 @@
 			}
                     }
                     for (i = 0; i < (int)NTYPES; i++) {
-                        if ((1 << i) & p->type) typecount[i]++;
+                        if ((1 << i) & p->type) typecount[i]+= p->type & FLAG_STRONG ? 2 : 1;
                     }
 		}
             }
Index: kio/kio/klimitediodevice.h
===================================================================
--- kio/kio/klimitediodevice.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/klimitediodevice.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -91,7 +91,7 @@
         pos = QMIN( pos, m_length ); // Apply upper limit
         return m_dev->at( m_start + pos );
     }
-    virtual bool atEnd() const { return m_dev->at() >= m_start + m_length; }
+    virtual bool atEnd() const { return m_dev->atEnd() || m_dev->at() >= m_start + m_length; }
 private:
     QIODevice* m_dev;
     Q_ULONG m_start;
Index: kio/kio/kservicetypefactory.cpp
===================================================================
--- kio/kio/kservicetypefactory.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/kservicetypefactory.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -156,7 +156,7 @@
             // don't return newServiceType - there may be an "other" pattern that
             // matches best this file, like *.tar.bz
             if (match)
-                *match = "*."+pattern;
+                *match = "*."+pattern.stripWhiteSpace();
             break; // but get out of the fast patterns
          }
          else
Index: kio/kio/defaultprogress.cpp
===================================================================
--- kio/kio/defaultprogress.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kio/defaultprogress.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -236,7 +236,7 @@
                                             unsigned long totalFiles )
 {
   if ( totalSize )
-      return i18n( "%1 % of %2 " ).arg( percent ).arg( KIO::convertSize( totalSize ) );
+      return i18n( "%1 % of %2 " ).arg( QString::number(percent) , KIO::convertSize( totalSize ) );
   else if ( totalFiles )
       return i18n( "%1 % of 1 file", "%1 % of %n files", totalFiles ).arg( percent );
   else
Index: kio/kfile/kpropsdlgplugin.desktop
===================================================================
--- kio/kfile/kpropsdlgplugin.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kfile/kpropsdlgplugin.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -47,7 +47,7 @@
 Comment[mt]=Plugin għad-djalogu tal-propjetajiet
 Comment[nb]=Programtillegg for dialogvinduet for egenskaper
 Comment[nds]=Plugin för den Egenschappen-Dialoog
-Comment[ne]=गुण संवादका लागि प्लगइन
+Comment[ne]=विशेषता संवादका लागि प्लगइन
 Comment[nl]=Plugin voor de 'Eigenschappen'-dialoog
 Comment[nn]=Tillegg til eigenskapar-dialogen
 Comment[nso]=Tsenyo ya Poledisano ya Dithoto
Index: kio/kfile/kfilesharedlg.cpp
===================================================================
--- kio/kfile/kfilesharedlg.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kfile/kfilesharedlg.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -204,7 +204,7 @@
     if (d->m_configProc) return;
 
     d->m_configProc = new KProcess(this);
-    (*d->m_configProc) << KStandardDirs::findExe("kdesu") << "kcmshell" << "fileshare";
+    (*d->m_configProc) << KStandardDirs::findExe("kdesu") << locate("exe", "kcmshell") << "fileshare";
     if (!d->m_configProc->start( KProcess::NotifyOnExit ))
     {
        delete d->m_configProc;
Index: kio/tests/kmimetypetest.cpp
===================================================================
--- kio/tests/kmimetypetest.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/tests/kmimetypetest.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -63,5 +63,14 @@
     checkIcon( "trash:/foo/", "folder" );
   }
 
+  QString pdf;
+  KMimeType::diagnoseFileName("foo.pdf", pdf);
+  qDebug("extension: '%s'", pdf.latin1());
+  assert(pdf == QString("*.pdf"));
+  QString ps;
+  KMimeType::diagnoseFileName("foo.ps", ps);
+  qDebug("extension: '%s'", ps.latin1());
+  assert(ps == QString("*.ps"));
+
   return 0;
 }
Index: kio/data.protocol
===================================================================
--- kio/data.protocol	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/data.protocol	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -59,6 +59,7 @@
 Description[te]=దత్తాంశం యుఆరైల కొరకు కెఐఓబానిస (rfc2397)
 Description[tg]=kioslave барои URIs (rfc2397)
 Description[th]=kioslave สำหรับข้อมูล URIs (rfc2397)
+Description[tr]= Veri adresleri için bir kioslave (rfc2397)
 Description[tt]=Biremle URI öçen kioslave (rfc2397)
 Description[uk]=Підлеглий В/В для адрес (URI) даних (rfc2397)
 Description[vi]=Một kioslave cho các địa điểm URI kiểu dữ liệu (rfc2397).
Index: kio/kcmodule.desktop
===================================================================
--- kio/kcmodule.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kio/kcmodule.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -45,7 +45,7 @@
 Name[mk]=KDE Контролен Модул
 Name[mn]=KDED-Хяналтын Модул
 Name[ms]=Modul Kawalan KDE
-Name[nb]=KDE kontrollsenter-modul
+Name[nb]=KDE kontrollpanel-modul
 Name[nds]=KDE-Kuntrullmoduul
 Name[ne]=KDE नियन्त्रण मोड्युल
 Name[nl]=KDE Configuratiemodule
Index: kstyles/themes/mega.themerc
===================================================================
--- kstyles/themes/mega.themerc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kstyles/themes/mega.themerc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -38,7 +38,7 @@
 Name[mt]=Stil MegaGradient
 Name[nb]=MegaGradient mangefargestil
 Name[nds]=MegaGradient-Stil (Highcolor)
-Name[ne]=मेगाग्रेडिएन्ट उच्चरङ शैली
+Name[ne]=मेगाग्रेडियन्ट उच्चरङ शैली
 Name[nl]=MegaGradiënt hogekleurenstijl
 Name[nn]=MegaGradient-stil med mange fargar
 Name[nso]=Mokgwa wa kholoro ya godimo ya MegaGradient
Index: kstyles/themes/keramik.themerc
===================================================================
--- kstyles/themes/keramik.themerc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kstyles/themes/keramik.themerc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -82,6 +82,7 @@
 Comment[te]=ఆల్ఫా బ్లెండింగ్ వాడు ఒక శైలి
 Comment[tg]=Услуб бо истифодаи тобиши алфа
 Comment[th]=รูปแบบที่ใช้เทคนิคการไล่สีอัลฟา
+Comment[tr]=Alpha karışımı kullanan bir stil
 Comment[uk]=Стиль з використанням альфа-змішування
 Comment[uz]=Алфаблендингли услуб
 Comment[vi]=Kiểu dáng hợp nhau anfa.
Index: kstyles/plastik/plastik.h
===================================================================
--- kstyles/plastik/plastik.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kstyles/plastik/plastik.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -337,7 +337,7 @@
                         (height == other.height) &&
                         (c1Rgb == other.c1Rgb) &&
                         (c1Rgb == other.c1Rgb) &&
-                        (horizontal = other.horizontal);
+                        (horizontal == other.horizontal);
 //             if(!match) {
 //                 qDebug("operator ==: CacheEntries don't match!");
 //                 qDebug("width: %d\t\tother width: %d", width, other.width);
Index: kabc/ldapurl.h
===================================================================
--- kabc/ldapurl.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kabc/ldapurl.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -59,7 +59,7 @@
      * Returns the dn part of the LDAP Url (same as path(), but slash removed
      * from the beginning).
      */
-    const QString& dn() const { return m_dn; };
+    const QString& dn() const { return m_dn; }
     /** Sets the the dn part of the LDAP Url. */ 
     void setDn( const QString &dn );
 
@@ -70,7 +70,7 @@
       { m_attributes=attributes; updateQuery(); }
 
     /** Returns the scope part of the LDAP Url */
-    Scope scope() const { return m_scope; };
+    Scope scope() const { return m_scope; }
     /** Sets the scope part of the LDAP Url */
     void setScope(Scope scope) { m_scope = scope; updateQuery(); }
 
Index: kabc/ldif.h
===================================================================
--- kabc/ldif.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kabc/ldif.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -41,9 +41,9 @@
   {
   public:
 
-    typedef enum ParseVal{ None, NewEntry, EndEntry, Item, Control, Err, MoreData };
-    typedef enum EntryType{ Entry_None, Entry_Add, Entry_Del, Entry_Mod, Entry_Modrdn };
-    typedef enum ModType{ Mod_None, Mod_Add, Mod_Replace, Mod_Del };
+    enum ParseVal{ None, NewEntry, EndEntry, Item, Control, Err, MoreData };
+    enum EntryType{ Entry_None, Entry_Add, Entry_Del, Entry_Mod, Entry_Modrdn };
+    enum ModType{ Mod_None, Mod_Add, Mod_Replace, Mod_Del };
     LDIF();
     virtual ~LDIF();
     
@@ -108,7 +108,7 @@
      * Sets a chunk of LDIF. Call before startParsing(), or if nextItem() returned
      * MoreData.
      */
-    void setLDIF( const QByteArray &ldif ) { mLdif = ldif; mPos = 0; };
+    void setLDIF( const QByteArray &ldif ) { mLdif = ldif; mPos = 0; }
     /**
       * Indicates the end of the LDIF file/stream. Call if nextItem() returned
       * MoreData, but actually you don't have more data.
Index: kutils/kcmoduleproxy.cpp
===================================================================
--- kutils/kcmoduleproxy.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kutils/kcmoduleproxy.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -363,8 +363,8 @@
 		*d->rootProcess << kdesu;
 		*d->rootProcess << "--nonewdcop" << "-n" << "-d" << QString( "-i%1" ).arg(moduleInfo().icon());
 
-		*d->rootProcess << QString("kcmshell %1 --embed-proxy %2 --lang %3").arg(cmd).arg
-			(d->embedWidget->winId()).arg(KGlobal::locale()->language());
+		*d->rootProcess << QString("%1 %2 --embed-proxy %3 --lang %4").arg(locate("exe", "kcmshell"))
+			.arg(cmd).arg(d->embedWidget->winId()).arg(KGlobal::locale()->language());
 
 		connect(d->rootProcess, SIGNAL(processExited(KProcess*)), SLOT(rootExited()));
 
Index: kutils/kcmoduleinfo.cpp
===================================================================
--- kutils/kcmoduleinfo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kutils/kcmoduleinfo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -36,9 +36,9 @@
   public:
     KCModuleInfoPrivate() :
       testModule( false )
-    {};
+    {}
     ~KCModuleInfoPrivate()
-    { };
+    { }
 
     QString factoryName;
     bool testModule;
Index: kutils/kcmodulecontainer.cpp
===================================================================
--- kutils/kcmodulecontainer.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kutils/kcmodulecontainer.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -51,7 +51,7 @@
 			, btnRootMode( 0 )
 			, btnLayout( 0 )
 			, topLayout( 0 )
-			{};
+			{}
 
 		QStringList modules;
 		QTabWidget *tabWidget;
Index: kutils/kcmoduleinfo.h
===================================================================
--- kutils/kcmoduleinfo.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kutils/kcmoduleinfo.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -110,12 +110,12 @@
   /**
    * @return the filename of the .desktop file that describes the KCM
    */
-  QString fileName() const { return _fileName; };
+  QString fileName() const { return _fileName; }
 
   /**
    * @return the keywords associated with this KCM.
    */
-  const QStringList &keywords() const { return _keywords; };
+  const QStringList &keywords() const { return _keywords; }
 
   /**
    * Returns the module's factory name, if it's set. If not, the library
@@ -128,23 +128,23 @@
   /**
    * @return the module\'s (translated) name
    */
-  QString moduleName() const { return _name; };
+  QString moduleName() const { return _name; }
   // changed from name() to avoid ambiguity with QObject::name() on multiple inheritance
 
   /**
    * @return a KSharedPtr to KService created from the modules .desktop file
    */
-  KService::Ptr service() const { return _service; };
+  KService::Ptr service() const { return _service; }
 
   /**
    * @return the module's (translated) comment field
    */
-  QString comment() const { return _comment; };
+  QString comment() const { return _comment; }
 
   /**
    * @return the module's icon name
    */
-  QString icon() const { return _icon; };
+  QString icon() const { return _icon; }
 
   /**
    * @return the path of the module's documentation
@@ -154,7 +154,7 @@
   /**
    * @return the library name
    */
-  QString library() const { return _lib; };
+  QString library() const { return _lib; }
 
   /**
    * @return a handle (usually the contents of the FactoryName field)
@@ -193,37 +193,37 @@
    * Sets the object's keywords.
    * @param keyword the new keywords
    */
-  void setKeywords(const QStringList &keyword) { _keywords = keyword; };
+  void setKeywords(const QStringList &keyword) { _keywords = keyword; }
 
   /**
    * Sets the object's name.
    * @param name the new name
    */
-  void setName(const QString &name) { _name = name; };
+  void setName(const QString &name) { _name = name; }
 
   /**
    * Sets the object's name.
    * @param comment the new comment
    */
-  void setComment(const QString &comment) { _comment = comment; };
+  void setComment(const QString &comment) { _comment = comment; }
 
   /**
    * Sets the object's icon.
    * @param icon the name of the new icon
    */
-  void setIcon(const QString &icon) { _icon = icon; };
+  void setIcon(const QString &icon) { _icon = icon; }
 
   /**
    * Set the object's library
    * @param lib the name of the new library without any extensions or prefixs.
    */
-  void setLibrary(const QString &lib) { _lib = lib; };
+  void setLibrary(const QString &lib) { _lib = lib; }
 
   /**
    * Sets the factory name
    * @param handle The new factory name
    */
-  void setHandle(const QString &handle) { _handle = handle; };
+  void setHandle(const QString &handle) { _handle = handle; }
 
   /**
    * Sets the object's weight property which determines in what
@@ -231,7 +231,7 @@
    *
    * @param weight the new weight
    */
-  void setWeight(int weight) { _weight = weight; };
+  void setWeight(int weight) { _weight = weight; }
 
 
   /**
@@ -247,19 +247,19 @@
    * @param needsRootPrivileges if module needs root privilges
    */
   void setNeedsRootPrivileges(bool needsRootPrivileges)
-  { _needsRootPrivileges = needsRootPrivileges; };
+  { _needsRootPrivileges = needsRootPrivileges; }
 
   /**
    * @deprecated
    */
   void setIsHiddenByDefault(bool isHiddenByDefault)
-  { _isHiddenByDefault = isHiddenByDefault; };
+  { _isHiddenByDefault = isHiddenByDefault; }
 
   /**
    * Sets the object's documentation path
    * @param p the new documentation path
    */
-  void setDocPath(const QString &p) { _doc = p; };
+  void setDocPath(const QString &p) { _doc = p; }
 
   /**
    * Reads the service entries specific for KCModule from the desktop file.
Index: kutils/kplugininfo.cpp
===================================================================
--- kutils/kplugininfo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kutils/kplugininfo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -24,6 +24,7 @@
 #include <kconfigbase.h>
 #include <kglobal.h>
 #include <kstandarddirs.h>
+#include <kdesktopfile.h>
 #include <kservice.h>
 
 class KPluginInfo::KPluginInfoPrivate
@@ -69,7 +70,7 @@
 KPluginInfo::KPluginInfo( const QString & filename, const char* resource )
 : d( new KPluginInfoPrivate )
 {
-    KConfig file( filename, true, true, resource );
+    KDesktopFile file( filename, true, resource );
 
     d->specfile = filename;
 
@@ -80,8 +81,8 @@
         if( d->hidden )
             return;
 
-        d->name = file.readEntry( "Name" );
-        d->comment = file.readEntry( "Comment" );
+        d->name = file.readName();
+        d->comment = file.readComment();
         d->icon = file.readEntry( "Icon" );
         d->author = file.readEntry( "X-KDE-PluginInfo-Author" );
         d->email = file.readEntry( "X-KDE-PluginInfo-Email" );
@@ -97,8 +98,8 @@
     else if( filename.endsWith( QString::fromAscii( ".plugin" ) ) )
     { // provided for noatun style .plugin files compatibility
 
-        d->name = file.readEntry( "Name" );
-        d->comment = file.readEntry( "Comment" );
+        d->name = file.readName();
+        d->comment = file.readComment();
         d->icon = file.readEntry( "Icon" );
         d->author = file.readEntry( "Author" );
         d->email = file.readEntry( "Email" );
Index: kdesu/process.h
===================================================================
--- kdesu/process.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdesu/process.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -112,12 +112,12 @@
     /**
      * Returns the filedescriptor of the process.
      */
-    int fd() {return m_Fd;};
+    int fd() {return m_Fd;}
 
     /**
      * Returns the pid of the process.
      */
-    int pid() {return m_Pid;};
+    int pid() {return m_Pid;}
 
 public: /* static */
     /*
Index: kdesu/kcookie.cpp
===================================================================
--- kdesu/kcookie.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdesu/kcookie.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -172,7 +172,7 @@
 	    break;
 	}
 	QCStringList output;
-	while (fgets(buf, 1024, f) > 0)
+	while (fgets(buf, 1024, f))
 	    output += buf;
 	if (pclose(f) < 0) 
 	{
Index: kspell2/plugins/aspell/kspell_aspell.desktop
===================================================================
--- kspell2/plugins/aspell/kspell_aspell.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kspell2/plugins/aspell/kspell_aspell.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -16,7 +16,7 @@
 Name[bn]=এ-স্পেল
 Name[hi]=आ-स्पैल
 Name[it]=Aspell
-Name[ne]=एस्पेल
+Name[ne]=ए स्पेल
 Name[sv]=Aspell
 Name[ta]=psதேர்ந்தெடு
 Name[te]=ఏస్పెల్
Index: kspell2/plugins/hspell/kspell_hspell.desktop
===================================================================
--- kspell2/plugins/hspell/kspell_hspell.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kspell2/plugins/hspell/kspell_hspell.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -14,6 +14,6 @@
 X-KDE-PluginInfo-EnabledByDefault=true
 Name=HSpell
 Name[bn]=এইচ-স্পেল
-Name[ne]=एचस्पेल
+Name[ne]=एच स्पेल
 Name[sv]=Hspell
 Name[te]=హెచ్ స్పెల్
Index: kspell2/plugins/ispell/kspell_ispell.desktop
===================================================================
--- kspell2/plugins/ispell/kspell_ispell.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kspell2/plugins/ispell/kspell_ispell.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -16,7 +16,7 @@
 Name[bn]=আই-স্পেল
 Name[hi]=आई-स्पैल
 Name[it]=Ispell
-Name[ne]=आइस्पेल
+Name[ne]=आई स्पेल
 Name[sv]=Ispell
 Name[ta]=psதேர்ந்தெடு
 Name[te]=ఐస్పెల్
Index: kspell2/kspellclient.desktop
===================================================================
--- kspell2/kspellclient.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kspell2/kspellclient.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,7 +42,7 @@
 Comment[ms]=Klien KSpell
 Comment[nb]=KSpell-klient
 Comment[nds]=KSpell-Deenstprogramm
-Comment[ne]=केस्पेल क्लाइन्ट
+Comment[ne]=के स्पेल क्लाइन्ट
 Comment[nn]=KSpell-klient
 Comment[pa]=KSpell ਕਲਾਂਇਟ
 Comment[pl]=Klient KSpell
Index: kdecore/netwm.h
===================================================================
--- kdecore/netwm.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/netwm.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -373,6 +373,22 @@
     int virtualRootsCount() const;
 
     /**
+       Returns the desktop layout orientation.
+    **/
+    NET::Orientation desktopLayoutOrientation() const;
+
+    /**
+       Returns the desktop layout number of columns and rows. Note that
+       either may be 0 (see _NET_DESKTOP_LAYOUT).
+    **/
+    QSize desktopLayoutColumnsRows() const;
+
+    /**
+       Returns the desktop layout starting corner.
+    **/
+    NET::DesktopLayoutCorner desktopLayoutCorner() const;
+
+    /**
        Returns the number of desktops.
 
        @return the number of desktops
@@ -518,6 +534,13 @@
     void setVirtualRoots(Window *windows, unsigned int count);
     
     /**
+       Sets the desktop layout. This is set by the pager. When setting, the pager must
+       own the _NET_DESKTOP_LAYOUT_Sn manager selection. See _NET_DESKTOP_LAYOUT for details.
+    **/
+    void setDesktopLayout(NET::Orientation orientation, int columns, int rows,
+        NET::DesktopLayoutCorner corner);
+
+    /**
      * Sets the _NET_SHOWING_DESKTOP status (whether desktop is being shown).
      * @since 3.5
      */
Index: kdecore/klocale.h
===================================================================
--- kdecore/klocale.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/klocale.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1301,7 +1301,7 @@
    */
   static QString catalogueFileName(const QString & language,
 				   const KCatalogue & catalog);
-
+public:
   /**
    * @internal Checks whether or not theFind catalog for given language and given catalog name.
    *
Index: kdecore/kcmdlineargs.cpp
===================================================================
--- kdecore/kcmdlineargs.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kcmdlineargs.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1248,21 +1248,22 @@
 
 KURL KCmdLineArgs::makeURL(const char *_urlArg)
 {
-   QString urlArg = QFile::decodeName(_urlArg);
-   if (!QDir::isRelativePath(urlArg))
-   {
+   const QString urlArg = QFile::decodeName(_urlArg);
+   QFileInfo fileInfo(urlArg);
+   if (!fileInfo.isRelative()) { // i.e. starts with '/', on unix
       KURL result;
       result.setPath(urlArg);
       return result; // Absolute path.
    }
 
-   if ( !KURL::isRelativeURL(urlArg) )
-     return KURL(urlArg); // Argument is a URL
+   if ( KURL::isRelativeURL(urlArg) || fileInfo.exists() ) {
+      KURL result;
+      result.setPath( cwd()+'/'+urlArg );
+      result.cleanPath();
+      return result;  // Relative path
+   }
 
-   KURL result;
-   result.setPath( cwd()+"/"+urlArg );
-   result.cleanPath();
-   return result;  // Relative path
+   return KURL(urlArg); // Argument is a URL
 }
 
 void
Index: kdecore/kaccelmanager.cpp
===================================================================
--- kdecore/kaccelmanager.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kaccelmanager.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -267,7 +267,7 @@
   {
     QWidget *w = static_cast<QWidget*>(it);
 
-    if ( !w->isVisibleTo( widget ) || w->isTopLevel() )
+    if ( !w->isVisibleTo( widget ) || ( w->isTopLevel() && dynamic_cast<QPopupMenu*>(w) == NULL ) )
         continue;
 
     if ( KAcceleratorManagerPrivate::ignored_widgets.find( w ) != KAcceleratorManagerPrivate::ignored_widgets.end() )
Index: kdecore/eventsrc
===================================================================
--- kdecore/eventsrc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/eventsrc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1771,7 +1771,7 @@
 Comment[te]=కెడిఈ నిష్క్రమిస్తుంది
 Comment[tg]=Баромад аз KDE
 Comment[th]=กำลังออกจาก KDE
-Comment[tr]=KDE'den çıkılıyor
+Comment[tr]=KDE Masaüstünden çıkılıyor
 Comment[tt]=KDE tuqtatıla
 Comment[uk]=Триває завершення роботи KDE
 Comment[uz]=KDE ишини якунламоқда
@@ -1793,7 +1793,10 @@
 Name[el]=Η αποσύνδεση ακυρώθηκε
 Name[es]=Salida cancelada
 Name[et]=Väljalogimine katkestatud
+Name[fi]=Uloskirjautuminen peruttu
+Name[fr]=Annulation de la déconnexion
 Name[fy]=Ofmelding ôfbrutsen
+Name[hr]=Odjavljivanje prekinuto
 Name[hu]=Kijelentkezés megszakítva
 Name[is]=Hætt við útstimplun
 Name[it]=Uscita annullata
@@ -1801,8 +1804,10 @@
 Name[kk]=Шығу доғарылды
 Name[km]=ការ​ចេញ​បាន​បោះបង់
 Name[lt]=Išsiregistravimas atšauktas
+Name[mk]=Откажано одјавување
 Name[nds]=Afmellen afbraken
 Name[nl]=Afmelden geannuleerd
+Name[nn]=Utlogging avbroten
 Name[pa]=ਲਾਗਆਉਟ ਰੱਦ ਕੀਤਾ ਗਿਆ
 Name[pl]=Wylogowanie anulowane
 Name[pt]=Encerramento cancelado
@@ -1815,6 +1820,7 @@
 Name[sv]=Utloggning avbruten
 Name[te]=లాగౌట్ రద్దుచేయబడినది
 Name[th]=ยกเลิกการล็อกเอาต์
+Name[tr]=Oturumu kapatma işlemi iptal edildi
 Name[uk]=Вихід скасовано
 Name[zh_TW]=取消登出
 Comment=KDE logout was canceled
@@ -1827,7 +1833,10 @@
 Comment[el]=Η αποσύνδεση από το KDE ακυρώθηκε
 Comment[es]=La salida de KDE fue cancelada
 Comment[et]=KDE väljalogimine katkestati
+Comment[fi]=KDE:n uloskirjautuminen on peruttu
+Comment[fr]=La déconnexion de KDE a été annulée
 Comment[fy]=KDE ôfmelding wie ôfbrutsen
+Comment[hr]=KDE odjavljivanje je prekinuto
 Comment[hu]=A KDE-s kijelentkezés megszakadt
 Comment[is]=Hætt var við KDE útstimplun
 Comment[it]=L'uscita da KDE è stata annullata
@@ -1835,8 +1844,10 @@
 Comment[kk]=KDE-ден шығу доғарылды
 Comment[km]=ការ​ចេញ​របស់ KDE ត្រូវ​បាន​បោះបង់
 Comment[lt]=Išsiregistravimas iš KDE buvo atšauktas
+Comment[mk]=Одјавувањето од KDE е откажано
 Comment[nds]=Afmellen vun KDE wöör afbraken
 Comment[nl]=Uitloggen KDE was geannuleerd
+Comment[nn]=KDE-utlogginga vart avbroten
 Comment[pa]=KDE ਲਾਗ-ਆਉਟ ਰੱਦ ਕੀਤਾ ਗਿਆ ਹੈ
 Comment[pl]=Wylogowanie z KDE zostało anulowane
 Comment[pt]=O encerramento da sessão do KDE foi cancelado
@@ -1849,6 +1860,7 @@
 Comment[sv]=Utloggning från KDE avbröts
 Comment[te]=కెడిఈ లాగౌట్ రద్దుచేయబడినది
 Comment[th]=การล็อกเอาท์ออกจาก KDE ถูกยกเลิก
+Comment[tr]=KDE oturumunu kapatma işlemi iptal edildi
 Comment[uk]=Вихід з KDE скасовано
 Comment[zh_TW]=KDE 登出動作已被取消
 default_presentation=16
Index: kdecore/kiconloader.cpp
===================================================================
--- kdecore/kiconloader.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kiconloader.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -460,19 +460,17 @@
     static const QString &xpm_ext = KGlobal::staticQString(".xpm");
     ext[count++]=&xpm_ext;
 
-    /* antlarr: Multiple inheritance is a broken concept on icon themes, so
-       the next code doesn't support it on purpose because in fact, it was
-       never supported at all. This makes the order in which we look for an
-       icon as:
+    /* JRT: To follow the XDG spec, the order in which we look for an
+       icon 1s:
 
        png, svgz, svg, xpm exact match
+       png, svgz, svg, xpm best match
        next theme in inheritance tree : png, svgz, svg, xpm exact match
+                                        png, svgz, svg, xpm best match
        next theme in inheritance tree : png, svgz, svg, xpm exact match
+                                        png, svgz, svg, xpm best match
        and so on
 
-       And if the icon couldn't be found then it tries best match in the same
-       order.
-
        */
     for ( KIconThemeNode *themeNode = d->links.first() ; themeNode ;
 	themeNode = d->links.next() )
@@ -480,24 +478,16 @@
 	for (int i = 0 ; i < count ; i++)
 	{
 	    icon = themeNode->theme->iconPath(name + *ext[i], size, KIcon::MatchExact);
-	    if (icon.isValid())
-		return icon;
+	    if (icon.isValid()) goto icon_found ;
 	}
 
-    }
-
-    for ( KIconThemeNode *themeNode = d->links.first() ; themeNode ;
-	themeNode = d->links.next() )
-    {
 	for (int i = 0 ; i < count ; i++)
 	{
 	    icon = themeNode->theme->iconPath(name + *ext[i], size, KIcon::MatchBest);
-	    if (icon.isValid())
-		return icon;
+	    if (icon.isValid()) goto icon_found;	
 	}
-
     }
-
+    icon_found:
     return icon;
 }
 
@@ -940,21 +930,13 @@
 		themeNode = d->links.next() )
 	{
 	    icon = themeNode->theme->iconPath(file, size, KIcon::MatchExact);
-	    if (icon.isValid())
-		break;
-	}
+	    if (icon.isValid()) goto icon_found ;
 
-	if ( !icon.isValid() )
-	{
-	    for ( KIconThemeNode *themeNode = d->links.first() ; themeNode ;
-		    themeNode = d->links.next() )
-	    {
 		icon = themeNode->theme->iconPath(file, size, KIcon::MatchBest);
-		if (icon.isValid())
-		    break;
-	    }
+	    if (icon.isValid()) goto icon_found ;
 	}
 
+	icon_found:
 	file = icon.isValid() ? icon.path : QString::null;
     }
     return file;
Index: kdecore/netwm_p.h
===================================================================
--- kdecore/netwm_p.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/netwm_p.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -103,6 +103,9 @@
     unsigned long clients_count, stacking_count, virtual_roots_count,
 	kde_system_tray_windows_count;
     bool showing_desktop;
+    NET::Orientation desktop_layout_orientation;
+    NET::DesktopLayoutCorner desktop_layout_corner;
+    int desktop_layout_columns, desktop_layout_rows;
 
     unsigned long properties[ 5 ];
     unsigned long client_properties[ 5 ]; // properties the client is interested in
Index: kdecore/all_languages.desktop
===================================================================
--- kdecore/all_languages.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/all_languages.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -3060,6 +3060,7 @@
 Name[kk]=Ирланд галлша
 Name[km]=អៀរឡង់ ហ្កែលិគ
 Name[lb]=Irescht Gällesch
+Name[mk]=Ирски галски
 Name[nb]=Irsk gaelisk
 Name[nds]=Irsch Gäälsch
 Name[ne]=आइरिश ग्यालिक
@@ -3123,6 +3124,7 @@
 Name[km]=ហ្កែលិគ
 Name[lb]=Gällesch
 Name[lt]=Galų
+Name[mk]=Галски
 Name[mn]=Гаели
 Name[nb]=Gælisk
 Name[nds]=Gäälsch
@@ -3401,7 +3403,7 @@
 Name[mk]=Хауса
 Name[mn]=Хауса
 Name[nds]=Haussa
-Name[ne]=हौसा
+Name[ne]=हउसा
 Name[nso]=Se-Hausa
 Name[pa]=ਹਾਉਸਾ
 Name[ro]=Hausă
@@ -3472,7 +3474,7 @@
 Name[mt]=Lhudi
 Name[nb]=Hebraisk
 Name[nds]=Hebrääsch
-Name[ne]=हेब्रु
+Name[ne]=हिब्रु
 Name[nl]=Hebreeuws
 Name[nn]=Hebraisk
 Name[nso]=Se-Heberu
@@ -4043,7 +4045,7 @@
 Name[mt]=Indoneżjan
 Name[nb]=Indonesisk
 Name[nds]=Indoneesch
-Name[ne]=इन्डोनेसियन
+Name[ne]=इन्डोनेसियाली
 Name[nl]=Indonesisch
 Name[nn]=Indonesisk
 Name[nso]=Se-Indonesian
@@ -4099,7 +4101,7 @@
 Name[lv]=Interlingva
 Name[mk]=Интерлингва
 Name[mn]=Интерлингуе
-Name[ne]=इन्टरलिङ्गी
+Name[ne]=इन्टरलिङ्गुवा
 Name[nso]=Se-Interlingue
 Name[pa]=ਇੰਟਰਈਨੂਗੂਈ
 Name[rw]=Ikinyenterilinge
@@ -8198,6 +8200,7 @@
 Name[te]=రొమని
 Name[tg]=Романӣ
 Name[th]=ภาษาโรมานี
+Name[tr]=Çingene Dili
 Name[uk]=Циганська
 Name[vi]=Rô-ma-ny
 Name[zh_CN]=吉普赛语
@@ -9264,6 +9267,7 @@
 Name[te]=సెర్బియన్ లాటిన్
 Name[tg]=Лотини Сербиявӣ
 Name[th]=ภาษาละตินเซอร์เบีย
+Name[tr]=Sırpça Latin
 Name[uk]=Сербська (латинь)
 Name[uz]=Сербча (Лотин)
 Name[vi]=Xéc-bi (La-tinh)
@@ -11332,6 +11336,7 @@
 Name[te]=చైనీస్ (హాంగ్ కాంగ్)
 Name[tg]=Хитоӣ (Гон-Конг)
 Name[th]=ภาษาจีี (ฮ่องกง)น
+Name[tr]=Çince (Hong Kong)
 Name[uk]=Китайська (Гонконг)
 Name[uz]=Хитойча (Гонгконг)
 Name[vi]=Trung quốc (Hồng Kông)
Index: kdecore/tests/kurltest.cpp
===================================================================
--- kdecore/tests/kurltest.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/tests/kurltest.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -288,6 +288,16 @@
   check("KURL::prettyURL()", url15582.prettyURL(), "http://alain.knaff.linux.lu/bug-reports/kde/percentage%in%url.html");
   check("KURL::url()", url15582.url(), "http://alain.knaff.linux.lu/bug-reports/kde/percentage%25in%25url.html");
 
+  KURL whitespaceInUser("http://www.google.com%20%20%20%20%20@foobar.com/");
+  check("KURL::prettyURL()", whitespaceInUser.prettyURL(), "http://www.google.com%20%20%20%20%20@foobar.com/");
+
+  KURL whitespaceInPath("http://www.google.com/foo%20bar/");
+  check("KURL::prettyURL()", whitespaceInPath.prettyURL(), "http://www.google.com/foo bar/");
+
+   KURL whitespaceInPath2("http://www.google.com/foo%20%20%20%20%20%20%20bar/");
+  check("KURL::prettyURL()", whitespaceInPath2.prettyURL(),
+          "http://www.google.com/foo%20%20%20%20%20%20 bar/");
+
   KURL carsten;
   carsten.setPath("/home/gis/src/kde/kdelibs/kfile/.#kfiledetailview.cpp.1.18");
   check("KURL::path()", carsten.path(), "/home/gis/src/kde/kdelibs/kfile/.#kfiledetailview.cpp.1.18");
@@ -594,6 +604,15 @@
   check("http: URL with empty path string path", waba1.path(),
         "");
 
+  waba1 = "http://www.meinestadt.de&url_plain=http";
+  check("http: URL with empty path string", waba1.host(),
+         "www.meinestadt.de&url_plain=http");
+  check("http: URL with empty path string", waba1.htmlURL(),
+         "http://www.meinestadt.de&amp;url_plain=http");
+ 
+  check("http: URL with empty path string", waba1.path(),
+         "");
+
   waba1 = "http://a:389#b=c";
   check( "http: URL with port, ref, and empty path; url", waba1.url(), "http://a:389#b=c" );
   check( "http: URL with port, ref, and empty path; host", waba1.host(), "a" );
Index: kdecore/kprocess.h
===================================================================
--- kdecore/kprocess.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kprocess.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -35,6 +35,7 @@
 
 /**
  * Child process invocation, monitoring and control.
+ * This class works only in the application's main thread.
  *
  * <b>General usage and features:</b>\n
  *
@@ -407,6 +408,8 @@
    * If all the data has been sent to the client, the signal
    * wroteStdin() will be emitted.
    *
+   * This function does not work when the process is start()ed in Block mode.
+   *
    * @param buffer the buffer to write
    * @param buflen the length of the buffer
    * @return false if an error has occurred
Index: kdecore/kgrantpty.c
===================================================================
--- kdecore/kgrantpty.c	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kgrantpty.c	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -36,7 +36,7 @@
 #include <unistd.h>
 
 #include <sys/param.h>
-#if defined(__FreeBSD__)
+#if defined(__FreeBSD__) || defined(__DragonFly__)
 #  define BSD_PTY_HACK
 #  include <paths.h>
 #  include <dirent.h>
Index: kdecore/kapplication.cpp
===================================================================
--- kdecore/kapplication.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kapplication.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -518,7 +518,7 @@
     {
         QWidget* w = static_cast< QWidget* >( receiver );
 #if defined Q_WS_X11
-        if( w->isTopLevel() && !startupId().isEmpty()) // TODO better done using window group leader?
+        if( w->isTopLevel() && !startupId().isEmpty() && !static_cast<QShowEvent*>(event)->spontaneous()) // TODO better done using window group leader?
             KStartupInfo::setWindowStartupId( w->winId(), startupId());
 #endif
         if( w->isTopLevel() && !w->testWFlags( WX11BypassWM ) && !w->isPopup() && !event->spontaneous())
@@ -2597,6 +2597,9 @@
       {
          if (error)
             *error = i18n("Could not register with DCOP.\n");
+         if (!kapp)
+            delete dcopClient;
+
          return -1;
       }
    }
Index: kdecore/kurl.cpp
===================================================================
--- kdecore/kurl.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/kurl.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -183,7 +183,7 @@
         (character == '?') || // Start of query delimiter
         ((character == '@') && encodeAt) || // Username delimiter
         (character == '#') || // Start of reference delimiter
-        ((character == 32) && (i+1 == old_length))) // A trailing space
+        ((character == 32) && (i+1 == old_length || segment[i+1] == ' '))) // A trailing space
     {
       new_segment[ new_length++ ] = '%';
 
@@ -1540,7 +1540,7 @@
     u += "//";
     if ( hasUser() )
     {
-      u += lazy_encode(m_strUser);
+      u += encode(m_strUser, 0, 0);
       // Don't show password!
       u += "@";
     }
Index: kdecore/netwm_def.h
===================================================================
--- kdecore/netwm_def.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/netwm_def.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -590,6 +590,7 @@
         @li WM2WindowClass  WM_CLASS
         @li WM2WindowRole   WM_WINDOW_ROLE
         @li WM2ClientMachine WM_CLIENT_MACHINE
+        @li WM2DesktopLayout _NET_DESKTOP_LAYOUT
         
         @since 3.2
 
@@ -608,7 +609,8 @@
         WM2WindowClass         = 1<<10, ///< @since 3.3
         WM2WindowRole          = 1<<11, ///< @since 3.3
         WM2ClientMachine       = 1<<12, ///< @since 3.3
-        WM2ShowingDesktop      = 1<<13  ///< @since 3.5
+        WM2ShowingDesktop      = 1<<13, ///< @since 3.5
+        WM2DesktopLayout       = 1<<15  ///< @since 3.5.8
     };
 
     /**
@@ -632,6 +634,24 @@
     };
     
     /**
+      Orientation.
+    **/
+    enum Orientation {
+        OrientationHorizontal = 0,
+        OrientationVertical = 1
+    };
+    
+    /**
+     Starting corner for desktop layout.
+    **/
+    enum DesktopLayoutCorner {
+        DesktopLayoutCornerTopLeft = 0,
+        DesktopLayoutCornerTopRight = 1,
+        DesktopLayoutCornerBottomLeft = 2,
+        DesktopLayoutCornerBottomRight = 3
+    };
+    
+    /**
      Compares two X timestamps, taking into account wrapping and 64bit architectures.
      Return value is like with strcmp(), 0 for equal, -1 for time1 < time2, 1 for time1 > time2.
      @since 3.5.3
Index: kdecore/netwm.cpp
===================================================================
--- kdecore/netwm.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdecore/netwm.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -56,6 +56,7 @@
 static Atom net_supporting_wm_check  = 0;
 static Atom net_virtual_roots        = 0;
 static Atom net_showing_desktop      = 0;
+static Atom net_desktop_layout       = 0;
 
 // root window messages
 static Atom net_close_window         = 0;
@@ -235,7 +236,7 @@
 }
 
 
-static const int netAtomCount = 83;
+static const int netAtomCount = 84;
 static void create_atoms(Display *d) {
     static const char * const names[netAtomCount] =
     {
@@ -252,6 +253,7 @@
 	    "_NET_ACTIVE_WINDOW",
 	    "_NET_WORKAREA",
 	    "_NET_VIRTUAL_ROOTS",
+            "_NET_DESKTOP_LAYOUT",
             "_NET_SHOWING_DESKTOP",
 	    "_NET_CLOSE_WINDOW",
             "_NET_RESTACK_WINDOW",
@@ -346,6 +348,7 @@
 	    &net_active_window,
 	    &net_workarea,
 	    &net_virtual_roots,
+            &net_desktop_layout,
             &net_showing_desktop,
 	    &net_close_window,
             &net_restack_window,
@@ -613,6 +616,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     if( properties_size > PROPERTIES_SIZE ) {
         fprintf( stderr, "NETRootInfo::NETRootInfo(): properties array too large\n");
@@ -624,7 +630,7 @@
     p->properties[ PROTOCOLS ] |= ( Supported | SupportingWMCheck );
     p->client_properties[ PROTOCOLS ] = DesktopNames // the only thing that can be changed by clients
 			                | WMPing; // or they can reply to this
-    p->client_properties[ PROTOCOLS2 ] = WM2TakeActivity;
+    p->client_properties[ PROTOCOLS2 ] = WM2TakeActivity | WM2DesktopLayout;
 
     role = WindowManager;
 
@@ -711,6 +717,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     if( properties_size > 2 ) {
         fprintf( stderr, "NETWinInfo::NETWinInfo(): properties array too large\n");
@@ -769,6 +778,9 @@
     p->kde_system_tray_windows = 0;
     p->kde_system_tray_windows_count = 0;
     p->showing_desktop = false;
+    p->desktop_layout_orientation = OrientationHorizontal;
+    p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+    p->desktop_layout_columns = p->desktop_layout_rows = 0;
     setDefaultProperties();
     p->client_properties[ PROTOCOLS ] = properties;
     for( int i = 0; i < PROPERTIES_SIZE; ++i )
@@ -873,6 +885,7 @@
 #endif
 
 	setSupported();
+	update(p->client_properties);
     } else {
 
 #ifdef    NETWMDEBUG
@@ -1166,6 +1179,9 @@
     if (p->properties[ PROTOCOLS ] & VirtualRoots)
 	atoms[pnum++] = net_virtual_roots;
 
+    if (p->properties[ PROTOCOLS2 ] & WM2DesktopLayout)
+	atoms[pnum++] = net_desktop_layout;
+
     if (p->properties[ PROTOCOLS ] & CloseWindow)
 	atoms[pnum++] = net_close_window;
 
@@ -1398,6 +1414,9 @@
     else if( atom == net_virtual_roots )
         p->properties[ PROTOCOLS ] |= VirtualRoots;
 
+    else if( atom == net_desktop_layout )
+        p->properties[ PROTOCOLS2 ] |= WM2DesktopLayout;
+
     else if( atom == net_close_window )
         p->properties[ PROTOCOLS ] |= CloseWindow;
 
@@ -1652,6 +1671,29 @@
 }
 
 
+void NETRootInfo::setDesktopLayout(NET::Orientation orientation, int columns, int rows,
+    NET::DesktopLayoutCorner corner)
+{
+    p->desktop_layout_orientation = orientation;
+    p->desktop_layout_columns = columns;
+    p->desktop_layout_rows = rows;
+    p->desktop_layout_corner = corner;
+
+#ifdef   NETWMDEBUG
+    fprintf(stderr, "NETRootInfo::setDesktopLayout: %d %d %d %d\n",
+	    orientation, columns, rows, corner);
+#endif
+
+    long data[ 4 ];
+    data[ 0 ] = orientation;
+    data[ 1 ] = columns;
+    data[ 2 ] = rows;
+    data[ 3 ] = corner;
+    XChangeProperty(p->display, p->root, net_desktop_layout, XA_CARDINAL, 32,
+		    PropModeReplace, (unsigned char *) &data, 4);
+}
+
+
 void NETRootInfo::setShowingDesktop( bool showing ) {
     if (role == WindowManager) {
 	long d = p->showing_desktop = showing;
@@ -2082,6 +2124,14 @@
 		dirty |= ActiveWindow;
 	    else if (pe.xproperty.atom == net_showing_desktop)
 		dirty2 |= WM2ShowingDesktop;
+//            else if (pe.xproperty.atom == net_supported )
+//                dirty |= Supported; // update here?
+            else if (pe.xproperty.atom == net_supporting_wm_check )
+                dirty |= SupportingWMCheck;
+            else if (pe.xproperty.atom == net_virtual_roots )
+                dirty |= VirtualRoots;
+            else if (pe.xproperty.atom == net_desktop_layout )
+                dirty2 |= WM2DesktopLayout;
 	    else {
 
 #ifdef    NETWMDEBUG
@@ -2547,6 +2597,36 @@
 	}
     }
 
+    if (dirty2 & WM2DesktopLayout) {
+        p->desktop_layout_orientation = OrientationHorizontal;
+        p->desktop_layout_corner = DesktopLayoutCornerTopLeft;
+        p->desktop_layout_columns = p->desktop_layout_rows = 0;
+	if (XGetWindowProperty(p->display, p->root, net_desktop_layout,
+			       0, MAX_PROP_SIZE, False, XA_CARDINAL, &type_ret,
+			       &format_ret, &nitems_ret, &unused, &data_ret)
+	    == Success) {
+	    if (type_ret == XA_CARDINAL && format_ret == 32) {
+                long* data = (long*) data_ret;
+                if( nitems_ret >= 4 && data[ 3 ] >= 0 && data[ 3 ] <= 3 )
+                    p->desktop_layout_corner = (NET::DesktopLayoutCorner)data[ 3 ];
+                if( nitems_ret >= 3 ) {
+                    if( data[ 0 ] >= 0 && data[ 0 ] <= 1 )
+                        p->desktop_layout_orientation = (NET::Orientation)data[ 0 ];
+                    p->desktop_layout_columns = data[ 1 ];
+                    p->desktop_layout_rows = data[ 2 ];
+                }
+	    }
+
+#ifdef    NETWMDEBUG
+	    fprintf(stderr, "NETRootInfo::updated: desktop layout updated (%d %d %d %d)\n",
+                p->desktop_layout_orientation, p->desktop_layout_columns,
+                p->desktop_layout_rows, p->desktop_layout_corner );
+#endif
+	    if ( data_ret )
+		XFree(data_ret);
+	}
+    }
+
     if (dirty2 & WM2ShowingDesktop) {
         p->showing_desktop = false;
 	if (XGetWindowProperty(p->display, p->root, net_showing_desktop,
@@ -2702,6 +2782,21 @@
 }
 
 
+NET::Orientation NETRootInfo::desktopLayoutOrientation() const {
+    return p->desktop_layout_orientation;
+}
+
+
+QSize NETRootInfo::desktopLayoutColumnsRows() const {
+    return QSize( p->desktop_layout_columns, p->desktop_layout_rows );
+}
+
+
+NET::DesktopLayoutCorner NETRootInfo::desktopLayoutCorner() const {
+    return p->desktop_layout_corner;
+}
+
+
 int NETRootInfo::numberOfDesktops() const {
     return p->number_of_desktops == 0 ? 1 : p->number_of_desktops;
 }
Index: khtml/khtml_ext.cpp
===================================================================
--- khtml/khtml_ext.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/khtml_ext.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -685,7 +685,7 @@
     bool ok = false;
 
     QString url = KInputDialog::getText( i18n("Add URL to Filter"),
-                                         "Enter the URL:",
+                                         i18n("Enter the URL:"),
                                          d->m_imageURL.url(),
                                          &ok);
     if ( ok ) {
@@ -698,7 +698,7 @@
 {
     bool ok = false;
     QString url = KInputDialog::getText( i18n( "Add URL to Filter"),
-                                               "Enter the URL:",
+                                               i18n("Enter the URL:"),
                                                d->m_khtml->url().url(),
                                                &ok );
     if ( ok ) {
Index: khtml/khtmlview.cpp
===================================================================
--- khtml/khtmlview.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/khtmlview.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -1252,8 +1252,17 @@
 
     if ( ( mailtoCursor || newWindowCursor ) && isVisible() && hasFocus() ) {
 #ifdef Q_WS_X11
+        QPixmap icon_pixmap = KGlobal::iconLoader()->loadIcon( mailtoCursor ? "mail_generic" : "window_new", KIcon::Small, 0, KIcon::DefaultState, 0, true );
+
+        if (d->cursor_icon_widget) {
+            const QPixmap *pm = d->cursor_icon_widget->backgroundPixmap();
+            if (!pm || pm->serialNumber()!=icon_pixmap.serialNumber()) {
+                delete d->cursor_icon_widget;
+                d->cursor_icon_widget = 0;
+            }
+        }
+
         if( !d->cursor_icon_widget ) {
-            QPixmap icon_pixmap = KGlobal::iconLoader()->loadIcon( mailtoCursor ? "mail_generic" : "window_new", KIcon::Small, 0, KIcon::DefaultState, 0, true );
             d->cursor_icon_widget = new QWidget( NULL, NULL, WX11BypassWM );
             XSetWindowAttributes attr;
             attr.save_under = True;
Index: khtml/html/html_elementimpl.cpp
===================================================================
--- khtml/html/html_elementimpl.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/html/html_elementimpl.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -503,7 +503,6 @@
         case ID_COLGROUP:
         case ID_FRAMESET:
         case ID_HEAD:
-        case ID_STYLE:
         case ID_TABLE:
         case ID_TBODY:
         case ID_TFOOT:
Index: khtml/ecma/kjs_events.cpp
===================================================================
--- khtml/ecma/kjs_events.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/ecma/kjs_events.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -286,7 +286,8 @@
   case TimeStamp:
     return Number((long unsigned int)event.timeStamp()); // ### long long ?
   case ReturnValue: // MSIE extension
-    return Boolean(event.handle()->defaultPrevented());
+    // return false == cancel, so this returns the -opposite- of defaultPrevented
+    return Boolean(!event.handle()->defaultPrevented());
   case CancelBubble: // MSIE extension
     return Boolean(event.handle()->propagationStopped());
   default:
Index: khtml/rendering/render_flow.cpp
===================================================================
--- khtml/rendering/render_flow.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/rendering/render_flow.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -85,7 +85,7 @@
 void RenderFlow::addChildWithContinuation(RenderObject* newChild, RenderObject* beforeChild)
 {
     RenderFlow* flow = continuationBefore(beforeChild);
-    while(beforeChild && beforeChild->parent() != this && !beforeChild->parent()->isAnonymousBlock()) {
+    while(beforeChild && beforeChild->parent() != flow && !beforeChild->parent()->isAnonymousBlock()) {
         // skip implicit containers around beforeChild
         beforeChild = beforeChild->parent();
     }
Index: khtml/dom/dom2_events.cpp
===================================================================
--- khtml/dom/dom2_events.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/dom/dom2_events.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -317,8 +317,12 @@
     if( impl->isMouseEvent() )
         return static_cast<MouseEventImpl*>( impl )->button() + 1;
     else if( impl->isTextInputEvent() ||  impl->isKeyboardEvent() )
-        return static_cast<KeyEventBaseImpl*>( impl )->keyCode();
-
+    {
+        // return 0 unless the key has an ascii value
+        if ( static_cast<KeyEventBaseImpl*>( impl )->keyVal() )
+            return static_cast<KeyEventBaseImpl*>( impl )->keyCode();
+    }
+    
     return 0;
 }
 
Index: khtml/css/cssstyleselector.cpp
===================================================================
--- khtml/css/cssstyleselector.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ khtml/css/cssstyleselector.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -2303,7 +2303,7 @@
     {
         FontDef fontDef = style->htmlFont().fontDef;
         if (isInherit)
-            fontDef.smallCaps = parentStyle->htmlFont().fontDef.weight;
+            fontDef.smallCaps = parentStyle->htmlFont().fontDef.smallCaps;
         else if (isInitial)
             fontDef.smallCaps = false;
         else {
Index: kresources/kresources.desktop
===================================================================
--- kresources/kresources.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kresources/kresources.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -80,7 +80,7 @@
 Comment=Configure KDE Resources
 Comment[af]=Stel KDE Hulpbronne op
 Comment[be]=Настаўленне рэсурсаў KDE
-Comment[bg]=Настройки на системните ресурси
+Comment[bg]=Настройване на системните ресурси
 Comment[bn]=কে.ডি.ই. রিসোর্সসমূহ কনফিগার করো
 Comment[br]=Kefluniañ danvezioù KDE
 Comment[bs]=Podesite KDE resurse
@@ -179,7 +179,7 @@
 Keywords[ms]=sumber, sumber konnector, sumber hubungan, sumber kalendar, sumber nota,imap
 Keywords[nb]=ressurser,konnector-ressurs,kontaktressurs,kalenderressurs, notatressurs,imap
 Keywords[nds]=Ressourcen,konnector-Ressource,Kontakt-Ressource,Kalenner-Ressource,Notiz-Ressource,IMAP
-Keywords[ne]=संसाधन, जडानकर्ता संसाधन, सम्पर्क संसाधन, पात्रो संसाधन, द्रष्टव्य संसाधन, आई म्याप
+Keywords[ne]=संसाधन, जडानकर्ता संसाधन, सम्पर्क संसाधन, पात्रो संसाधन, टिपोट संसाधन, आई म्याप
 Keywords[nl]=gegevensbron,verbindingsgegevensbron,contact-gegevensbron,kalender-gegevensbron,notities-gegevensbron,imap,contact,kalender,notitie,verbinding
 Keywords[nn]=ressursar,konnector-ressurs,kontaktressurs,kalenderressurs,notatressurs,imap
 Keywords[pl]=zasoby,konnector,zasoby wizytówek,zasoby kalendarzy,zasoby notatek,źródła danych wizytówek,źródła danych kalendarzy,źródła danych notatek,imap
Index: dcop/dcopserver.cpp
===================================================================
--- dcop/dcopserver.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ dcop/dcopserver.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -35,6 +35,7 @@
 #include <sys/param.h>
 #endif
 #include <sys/resource.h>
+#include <sys/socket.h>
 
 #include <unistd.h>
 #include <stdlib.h>
@@ -171,19 +172,7 @@
 
 	if (iceConn->io_ok)
 	{
-		
-//		nwritten = _kde_IceTransWrite (iceConn->trans_conn, ptr, (int) nleft);
-
-		/*
-		Use special write handling on windows platform. The write function from
-		the runtime library (on MSVC) does not allow to write on sockets.
-		*/
-#ifdef Q_OS_WIN
 		nwritten = send(fd, ptr, (int) nleft, 0);
-#else
-		nwritten = write(fd, ptr, (int) nleft);
-#endif
-
 	}
 	else
 	    return 0;
@@ -355,11 +344,7 @@
 	the runtime library (on MSVC) does not allow to write on sockets.
    */
    int nwritten;
-#ifdef Q_OS_WIN
    nwritten = ::send(fd,data.data()+outputBufferStart,data.size()-outputBufferStart,0);
-#else
-   nwritten = write(fd, data.data()+outputBufferStart, data.size()-outputBufferStart);
-#endif
    
    int e = errno;
    fcntl(fd, F_SETFL, fd_fl);
Index: dcop/dcopclient.cpp
===================================================================
--- dcop/dcopclient.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ dcop/dcopclient.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -41,6 +41,8 @@
 #include <sys/stat.h>
 #include <sys/file.h>
 #include <sys/socket.h>
+#include <fcntl.h>
+#include <unistd.h>
 
 #include <ctype.h>
 #include <unistd.h>
@@ -818,6 +820,7 @@
         emit attachFailed(QString::fromLatin1( errBuf ));
         return false;
     }
+    fcntl(socket(), F_SETFL, FD_CLOEXEC);
 
     IceSetShutdownNegotiation(d->iceConn, False);
 
Index: kjs/configure.in.in
===================================================================
--- kjs/configure.in.in	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kjs/configure.in.in	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -16,7 +16,8 @@
     LIBS="-lm"
     AC_MSG_CHECKING([for isnan with <math.h>])
     AC_TRY_LINK(
-	[#include <math.h>], [float f = 0.0; isnan(f)],
+	[#include <math.h>
+         float f;], [return isnan(f)],
 	[AC_MSG_RESULT(yes)
 	    AC_DEFINE([HAVE_FUNC_ISNAN], [1], [Define if you have isnan])],
 	AC_MSG_RESULT(no)
@@ -29,7 +30,8 @@
     LIBS="-lm"
     AC_MSG_CHECKING([for isinf with <math.h>])
     AC_TRY_LINK(
-	[#include <math.h>], [float f = 0.0; isinf(f)],
+	[#include <math.h>
+         float f;], [return isinf(f)],
 	[AC_MSG_RESULT(yes)
 	    AC_DEFINE([HAVE_FUNC_ISINF], [1], [Define if you have isinf])],
 	AC_MSG_RESULT(no)
Index: kdoctools/customization/fr/user.entities
===================================================================
--- kdoctools/customization/fr/user.entities	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdoctools/customization/fr/user.entities	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -164,6 +164,9 @@
 <!ENTITY traducteurBrunoPinaud        '<othercredit role="translator"><firstname>Bruno</firstname><surname>Pinaud</surname><affiliation><address><email>bpinaud@ifrance.com</email></address></affiliation><contrib>Traduction française</contrib></othercredit>'>
 <!ENTITY relecteurBrunoPinaud        '<othercredit role="reviewer"><firstname>Bruno</firstname><surname>Pinaud</surname><affiliation><address><email>bpinaud@ifrance.com</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
 
+<!ENTITY traducteurGillesPoulain        '<othercredit role="translator"><firstname>Gilles</firstname><surname>Poulain</surname><affiliation><address><email>poulain.gilles@gmail.com</email></address></affiliation><contrib>Traduction française</contrib></othercredit>'>
+<!ENTITY relecteurGillesPoulain        '<othercredit role="reviewer"><firstname>Gilles</firstname><surname>Poulain</surname><affiliation><address><email>poulain.gilles@gmail.com</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
+
 <!ENTITY traducteurRomainQuidet      '<othercredit role="translator"><firstname>Romain</firstname><surname>Quidet</surname><affiliation><address><email>rquidet@yahoo.com</email></address></affiliation><contrib>Traduction française</contrib></othercredit>'>
 <!ENTITY relecteurRomainQuidet       '<othercredit role="relecteur"><firstname>Romain</firstname><surname>Quidet</surname><affiliation><address><email>rquidet@yahoo.com</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
 
@@ -185,9 +188,12 @@
 <!ENTITY traducteurBriceRothschild '<othercredit role="translator"><firstname>Brice</firstname><surname>Rothschild</surname><affiliation><address><email>brice.rothschild@gmail.com</email></address> </affiliation><contrib>Traduction française</contrib></othercredit>'>
 <!ENTITY relecteurBriceRothschild         '<othercredit role="reviewer"><firstname>Brice</firstname><surname>Rothschild</surname><affiliation><address><email>brice.rothschild@gmail.com</email></address> </affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
 
-<!ENTITY traducteurMickaelSibelle   '<othercredit role="translator"><firstname>Mickaël</firstname><surname>Sibelle</surname><affiliation><address><email></email>kimael@gmail.com</address></affiliation><contrib>Traduction française</contrib></othercredit>'>
+<!ENTITY traducteurMickaelSibelle   '<othercredit role="translator"><firstname>Mickaël</firstname><surname>Sibelle</surname><affiliation><address><email>kimael@gmail.com</email></address></affiliation><contrib>Traduction française</contrib></othercredit>'>
 <!ENTITY relecteurMickaelSibelle    '<othercredit role="reviewer"><firstname>Mickaël</firstname><surname>Sibelle</surname><affiliation><address><email>kimael@gmail.com</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
 
+<!ENTITY traducteurArnaudMuchembled   '<othercredit role="translator"><firstname>Arnaud</firstname><surname>Muchembled</surname><affiliation><address><email>arno.muchembled@orange.fr</email></address></affiliation><contrib>Traduction française</contrib></othercredit>'>
+<!ENTITY relecteurArnaudMuchembled    '<othercredit role="reviewer"><firstname>Arnaud</firstname><surname>Muchembled</surname><affiliation><address><email>arno.muchembled@orange.fr</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
+
 <!ENTITY traducteurPenelopeSorveyron   '<othercredit role="translator"><firstname>Pénélope</firstname><surname>Sorveyron</surname><affiliation><address><email></email>goneri@free.fr</address></affiliation><contrib>Traduction française</contrib></othercredit>'>
 <!ENTITY relecteurPenelopeSorveyron    '<othercredit role="reviewer"><firstname>Pénélope</firstname><surname>Sorveyron</surname><affiliation><address><email>goneri@free.fr</email></address></affiliation><contrib>Relecture de la documentation française</contrib></othercredit>'>
 
@@ -260,6 +266,7 @@
 <!ENTITY PatricePawlak 'Patrice Pawlak <email>patrice.pawlak@free.fr</email>'>
 <!ENTITY RomainPelisse 'Romain Pelisse <email>belaran@gmail.com</email>'>
 <!ENTITY BrunoPinaud       'Bruno Pinaud <email>bpinaud@ifrance.com</email>'>
+<!ENTITY GillesPoulain       'Gilles Poulain <email>poulain.gilles@gmail.com</email>'>
 <!ENTITY RomainQuidet      'Romain Quidet <email>rquidet@yahoo.com</email>'>
 <!ENTITY LaurentRathle     'Laurent Rathle <email>lrathle@kde-france.org</email>'>
 <!ENTITY DamienRaudeMorvan 'Damien  Raude-Morvan <email>drazzib@drazzib.com</email>'>
@@ -268,6 +275,7 @@
 <!ENTITY ChristopheRolland 'Christophe Rolland <email>crolland@freesurf.fr</email>'>
 <!ENTITY BriceRothschild 'Brice Rothschild <email>brice.rothschild@gmail.com</email>'>
 <!ENTITY MickaelSibelle 'Mickaël Sibelle <email>kimael@gmail.com</email>'>
+<!ENTITY ArnaudMuchembled 'Arnaud Muchembled <email>arno.muchembled@orange.fr</email>'>
 <!ENTITY PenelopeSorveyron 'Pénélope Sorveyron <email>goneri@free.fr</email>'>
 <!ENTITY NicolasTernissien   'Nicolas Ternissien <email>nicolast@libertysurf.fr</email>'>
 <!ENTITY GillesThioliere   'Gilles Thiolière <email>zhovirax@wanadoo.fr</email>'>
Index: kdoctools/customization/nl/user.entities
===================================================================
--- kdoctools/customization/nl/user.entities	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdoctools/customization/nl/user.entities	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -36,6 +36,7 @@
 <!ENTITY Sander.Koning      '<othercredit role="translator"><firstname>Alexander</firstname><surname>S. Koning</surname><affiliation><address><email>sanderkoning@kde.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY Natalie.Koning      '<othercredit role="translator"><firstname>Natalie</firstname><surname>Koning</surname><affiliation><address><email>nat@switch.demon.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY Antoon.Tolboom      '<othercredit role="translator"><firstname>Antoon</firstname><surname>Tolboom</surname><affiliation><address><email>atolboo@casema.nl</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
+<!ENTITY Jordy.Ritico      '<othercredit role="translator"><firstname>Jordy</firstname><surname>Ritico</surname><affiliation><address><email>jordyritico@hotmail.com</email></address></affiliation><contrib>Vertaler/Nalezer</contrib></othercredit>'>
 <!ENTITY kde.nl.groep       "<email>i18n@kde.nl</email>">
 
 <!-- Tekstschema's -->
@@ -70,6 +71,7 @@
 <!ENTITY vertaling.sander       "<para>Dit document is vertaald in het Nederlands door &Sander.Koning;.</para>">
 <!ENTITY vertaling.natalie      "<para>Dit document is vertaald in het Nederlands door &Natalie.Koning;.</para>">
 <!ENTITY vertaling.antoon       "<para>Dit document is vertaald in het Nederlands door &Antoon.Tolboom;.</para>">
+<!ENTITY vertaling.jordy        "<para>Dit document is vertaald in het Nederlands door &Jordy.Ritico;.</para>">
 
 
 <!-- Gebruiken als template voor nieuwe vertalers/nalezers
@@ -105,6 +107,7 @@
 <!ENTITY nagelezen.sander     "<para>De vertaling werd nagelezen door &Sander.Koning;.</para>">
 <!ENTITY nagelezen.natalie    "<para>De vertaling werd nagelezen door &Natalie.Koning;.</para>">
 <!ENTITY nagelezen.antoon     "<para>De vertaling werd nagelezen door &Antoon.Tolboom;.</para>">
+<!ENTITY nagelezen.jordy      "<para>De vertaling werd nagelezen door &Jordy.Ritico;.</para>">
 
 <!-- Algemene afkortingen -->
 <!ENTITY Alt     "<keycap>Alt</keycap>">
Index: kdeprint/filters/poster.desktop
===================================================================
--- kdeprint/filters/poster.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeprint/filters/poster.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -121,7 +121,7 @@
 Description[ms]=Utiliti untuk mencetak poster besar pada banyak helaian kertas. Untuk menggunakan fungsi ini ini, <b>poster</b> boleh laksana mesti ada pada <tt>PATH</tt> anda.Kod sumber untuk utiliti ini ada di <a href="http://printing.kde.org/downloads">Laman KDEPrint</a>. <p><b><u>AMARAN:</u></b> Pakej di laman KDEPrint ialah versi telah diubah dari versi asal yang boleh diperoleh dari mana-mana cermin arkib CTAN. Namun, pakej asal <b>tidak</b> boleh berfungsi dengan KDE. Anda <b>mesti</b> menggunakan pakej yang terdapat di <a href="http://printing.kde.org/downloads">Laman KDEPrint</a>.
 Description[nb]=Hjelpeprogram for å skrive ut store plakater fordelt på mange små papirark. Du må ha <b>poster</b>-programmet i søkestien din, <tt>PATH</tt>. Kildekoden for dette programmet kan hentes fra <a href="http://printing.kde.org/downloads">KDEPrint-siden</a>. <p><b>ADVARSEL</u></b> Pakken som finnes på KDEPrint-siden er en modifisert utgave av originalen som kan finnes på alle CTAN-arkivspeil, men originalen virker <b>ikke</b> med KDE. Du <b>må</b> bruke utgaven fra <a href="http://printing.kde.org/downloads">KDEPrint-siden</a>.
 Description[nds]=Warktüüch, mit dat grote Biller op mennige lütte Sieden druckt warrn kann. Wenn Du dat bruken wullt, mutt dat Programm <b>poster</b> binnen Dien <tt>PATH</tt> wesen. De Bornkode dorför kann vun de <a href="http://printing.kde.org/downloads">KDEPrint-Nettsiet</a> daallaadt warrn.<p><b><u>Wohrscho:</u></b> Dat Paket vun KDEPrint is en ännert Verschoon vun dat Orginaalpaket, dat op jichtenseen CTAN Archiv-Mirror liggt, aver dat Orginaalpaket warrt <b>nich</b> mit KDE arbeiden. Du <b>muttst</b> dat Paket vun de <a href="http://printing.kde.org/downloads">KDEPrint-Nettsiet</a> bruken.
-Description[ne]=बहुँविध साना कागज पानाहरूमा ठूला पोष्टरहरू मुद्रण गर्न उपयोगी हुन्छ । यो आदेश प्रयोग गर्न, <b>पोष्टर</b> कार्यान्वयन योग्य तपाईँको <tt>बाटो</tt> मा पहुँच पुग्ने हुनुपर्छ । <a href="http://printing.kde.org/downloads">KDE मुद्रण वेब साइट </a> मा उपयोगिताका लागि स्रोत सङ्केत हुनुसक्छ । <p><b><u>चेतावनी:</u></b> KDE मुद्रण वेब साइडमा फेला परेको प्याकेज मौलिक एकको परिमार्जित सस्करण हो जुन कुनैपनि CTAN सङ्ग्रह ऐनामा फेला पर्न सक्छ, तर मौलिक प्याकेज KDE सँग कार्य <b>नगर्न</b>सक्छ । तपाईँले <b>प्रयोग गर्नुपर्छ</b> जुन प्याकेज <a href="http://printing.kde.org/downloads">मा फेला पर्छ </a>
+Description[ne]=बहुविध साना कागज पानाहरूमा ठूला पोष्टरहरू मुद्रण गर्न उपयोगी हुन्छ । यो आदेश प्रयोग गर्न, <b>पोष्टर</b> कार्यान्वयन योग्य तपाईँको <tt>बाटो</tt> मा पहुँच पुग्ने हुनुपर्छ । <a href="http://printing.kde.org/downloads">KDE मुद्रण वेब साइट </a> मा युटिलिटीका लागि स्रोत सङ्केत हुनुसक्छ । <p><b><u>चेतावनी:</u></b> KDE मुद्रण वेब साइडमा फेला परेको प्याकेज मौलिक एकको परिमार्जित सस्करण हो जुन कुनैपनि CTAN सङ्ग्रह ऐनामा फेला पर्न सक्छ, तर मौलिक प्याकेज KDE सँग कार्य <b>नगर्न</b>सक्छ । तपाईँले <b>प्रयोग गर्नुपर्छ</b> जुन प्याकेज <a href="http://printing.kde.org/downloads">मा फेला पर्छ </a>
 Description[nl]=Hulpprogramma voor het afdrukken van grote posterformaten op kleine vellen papier. Om dit commando te gebruiken dient het programmma <b>poster</b> zich in uw zoekpad (<tt>$PATH</tt>) te bevinden. De broncode voor dit hulpprogramma kunt u vinden op de <a href="http://printing.kde.org/downloads">website</a> van KDEPrint. <p><b><u>Waarschuwing:</u></b> het pakket dat aangeboden wordt op de website van KDEPrint is een afgeleide versie. Het originele pakket kunt u vinden op elke CTAN-archiefmirror, maar dit pakket zal <b>niet</b> met KDE werken. U kunt <b>alleen</b> het pakket dat aangeboden wordt op de <a href="http://printing.kde.org/downloads">website</a> van KDEPrint gebruiken.
 Description[nn]=Verktøy som let deg skriva ut store plakatar på fleire små ark. For å bruka denne kommandoen, må programmet <b>poster</b> vera tilgjengeleg i søkjestigen (<tt>PATH</tt>). Kjeldekoden til dette verktøyet finn du på <a href="http://printing.kde.org/downloads">nettstaden til KDEPrint</a>. <p><b><u>ÅTVARING:</u></b> Pakken som ligg på KDEPrint-nettstaden er ei tilpassa utgåve av den opphavlege som du kan finna i CTAN-arkivet. Den opphavlege pakken fungerer <b>ikkje</b> med KDE. Du <b>må</b> bruka pakken som ligg på <a href="http://printing.kde.org/downloads">KDEPrint-nettstaden</a>.
 Description[nso]=Sebereka sago gatisa diswantsho tse kgolo go matlakala a mantshi a mannyane. Go somisa taelo ye, phethagatsego ya <b>seswantsho</b> e swanetse go tsenelega kago <tt>TSEJANA</tt> ya gago. Khoutu ya mothopo wa sebereka se ekaba ele go <a href="http://printing.kde.org/downloads">Lefelo la web la Kgatiso ya KDE</a>. <p> <b><u>TEMOSO:</u></b> Pakana yeo e hweditswego kago lefelo la web la Kgatiso ya KDE ke tsweletso yeo e kaonafaditswego ya ya mathomothomo yeo eka hwetswago kago seipone sa polokelo ya CTAN, efela pakana ya mathomothomo e <b>kase</b> beereke le KDE. O <b>swanetse</b> go somisa pakana yeo e hweditswego kago <a href="http://printing.kde.org/downloads">lefelo la web la Kgatiso ya KDE</a>.
Index: kdeprint/filters/psnup.desktop
===================================================================
--- kdeprint/filters/psnup.desktop	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeprint/filters/psnup.desktop	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -48,7 +48,7 @@
 Comment[mt]=Filtru għal iżjed minn paġna waħda fuq kull karta
 Comment[nb]=Filter for flere sider på hvert ark
 Comment[nds]=Mehr as een Siet per Blatt drucken
-Comment[ne]=प्रति पाना फिल्टर बहुँविध पृष्ठ
+Comment[ne]=प्रति पाना फिल्टर बहुविध पृष्ठ
 Comment[nl]=Meerdere pagina's per vel afdrukken
 Comment[nn]=Filter for fleire sider på kvart ark
 Comment[nso]=Matlakala A Mantshintshi ka Sesekodi sa Letlakala
Index: kdeprint/management/kxmlcommanddlg.cpp
===================================================================
--- kdeprint/management/kxmlcommanddlg.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeprint/management/kxmlcommanddlg.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -171,7 +171,8 @@
 	m_outputpipe = new QLineEdit(gb_output);
 
 	m_comment = new KTextEdit( this );
-	m_comment->setTextFormat( Qt::PlainText );
+	m_comment->setTextFormat(Qt::RichText );
+	m_comment->setReadOnly(true);
 	QLabel *m_commentlab = new QLabel( i18n( "Comment:" ), this );
 
 	QVBoxLayout	*l2 = new QVBoxLayout(this, 0, KDialog::spacingHint());
Index: kdeui/kcolordialog.cpp
===================================================================
--- kdeui/kcolordialog.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kcolordialog.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -39,7 +39,6 @@
 #include <qimage.h>
 #include <qlabel.h>
 #include <qlayout.h>
-#include <qlineedit.h>
 #include <qvalidator.h>
 #include <qpainter.h>
 #include <qpushbutton.h>
@@ -51,6 +50,7 @@
 #include <kglobal.h>
 #include <kglobalsettings.h>
 #include <kiconloader.h>
+#include <klineedit.h>
 #include <klistbox.h>
 #include <klocale.h>
 #include <kmessagebox.h>
@@ -914,7 +914,7 @@
     bool bEditHtml;
     bool bColorPicking;
     QLabel *colorName;
-    QLineEdit *htmlName;
+    KLineEdit *htmlName;
     KColorSpinBox *hedit;
     KColorSpinBox *sedit;
     KColorSpinBox *vedit;
@@ -1140,7 +1140,7 @@
   label->setText(i18n("HTML:"));
   l_grid->addWidget(label, 1, 1, AlignLeft);
 
-  d->htmlName = new QLineEdit( page );
+  d->htmlName = new KLineEdit( page );
   d->htmlName->setMaxLength( 13 ); // Qt's QColor allows 12 hexa-digits
   d->htmlName->setText("#FFFFFF"); // But HTML uses only 6, so do not worry about the size
   w = d->htmlName->fontMetrics().width(QString::fromLatin1("#DDDDDDD"));
Index: kdeui/kdatepicker.h
===================================================================
--- kdeui/kdatepicker.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kdatepicker.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -121,7 +121,7 @@
    * widget.
    * @since 3.2
    */
-  KDateTable *dateTable() const { return table; };
+  KDateTable *dateTable() const { return table; }
 
   /**
    * Sets the font size of the widgets elements.
Index: kdeui/kswitchlanguagedialog.h
===================================================================
--- kdeui/kswitchlanguagedialog.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 0)
+++ kdeui/kswitchlanguagedialog.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -0,0 +1,87 @@
+/*
+ * This file is part of the KDE Libraries
+ * Copyright (C) 2007 Krzysztof Lichota (lichota@mimuw.edu.pl)
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Library General Public
+ * License as published by the Free Software Foundation; either
+ * version 2 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Library General Public License for more details.
+ *
+ * You should have received a copy of the GNU Library General Public License
+ * along with this library; see the file COPYING.LIB.  If not, write to
+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+ * Boston, MA 02110-1301, USA.
+ *
+ */
+ 
+#ifndef _KSWITCHLANGUAGEDIALOG_H_
+#define _KSWITCHLANGUAGEDIALOG_H_
+
+#include <kdialogbase.h>
+
+class KSwitchLanguageDialogPrivate;
+
+/**
+ * @short Standard "switch application language" dialog box.
+ *
+ * This class provides "switch application language" dialog box that is used
+ * in KHelpMenu
+ *
+ * @author Krzysztof Lichota (lichota@mimuw.edu.pl)
+ */
+
+class KDEUI_EXPORT KSwitchLanguageDialog : public KDialogBase
+{
+  Q_OBJECT
+
+  public:
+        /**
+            * Constructor. Creates a fully featured "Switch application language" dialog box.
+            * Note that this dialog is made modeless in the KHelpMenu class so
+            * the users may expect a modeless dialog.
+            *
+            * @param parent The parent of the dialog box. You should use the
+            *        toplevel window so that the dialog becomes centered.
+            * @param name Internal name of the widget. This name in not used in the
+            *        caption.
+            * @param modal If false, this widget will be modeless and must be
+            *        made visible using QWidget::show(). Otherwise it will be
+            *        modal and must be made visible using QWidget::exec()
+            */
+        KSwitchLanguageDialog( QWidget *parent=0, const char *name=0, bool modal=true );
+        
+        virtual ~KSwitchLanguageDialog();
+    
+    protected slots:
+        /**
+        * Activated when the Ok button has been clicked. Overridden from KDialogBase.
+        */
+        virtual void slotOk();
+        
+        /**
+            Called when one of language buttons changes state.
+        */
+        virtual void languageOnButtonChanged(const QString & );
+        
+        /**
+            Called to add one language button to dialog.
+        */
+        virtual void slotAddLanguageButton();
+        
+        /**
+            Called when "Remove" language button is clicked.
+        */
+        virtual void removeButtonClicked();
+        
+    protected:
+        KSwitchLanguageDialogPrivate * const d;
+        
+        friend class KSwitchLanguageDialogPrivate;
+};
+
+#endif
Index: kdeui/kpixmapregionselectordialog.h
===================================================================
--- kdeui/kpixmapregionselectordialog.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kpixmapregionselectordialog.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -59,7 +59,7 @@
     * parameters can be set by using it.
     */
    KPixmapRegionSelectorWidget *pixmapRegionSelectorWidget() const 
-      { return m_pixmapSelectorWidget; };
+      { return m_pixmapSelectorWidget; }
    
    /**
     * Creates a modal dialog, lets the user to select a region of the @p pixmap
Index: kdeui/kcmodule.h
===================================================================
--- kdeui/kcmodule.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kcmodule.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -163,7 +163,7 @@
    *
    * @note The default behavior is to call defaults().
    */
-  virtual void sysdefaults() { defaults(); };
+  virtual void sysdefaults() { defaults(); }
   // KDE 4 deprecate
 
   /**
@@ -200,7 +200,7 @@
    *
    * @see KCModule::setButtons
    */
-  int buttons() const { return _btn; };
+  int buttons() const { return _btn; }
 
   /**
    * Get the RootOnly message for this module.
@@ -306,7 +306,7 @@
    *
    * @see KCModule::buttons
    */
-  void setButtons(int btn) { _btn = btn; };
+  void setButtons(int btn) { _btn = btn; }
 
   /**
    * Sets the RootOnly message.
Index: kdeui/kcharselect.cpp
===================================================================
--- kdeui/kcharselect.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kcharselect.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -29,7 +29,6 @@
 #include <qhbox.h>
 #include <qkeycode.h>
 #include <qlabel.h>
-#include <qlineedit.h>
 #include <qpainter.h>
 #include <qpen.h>
 #include <qregexp.h>
@@ -40,6 +39,7 @@
 #include <kapplication.h>
 #include <kdebug.h>
 #include <kdialog.h>
+#include <klineedit.h>
 #include <klocale.h>
 
 class KCharSelect::KCharSelectPrivate
@@ -409,7 +409,7 @@
     const QRegExp rx( "[a-fA-F0-9]{1,4}" );
     QValidator* const validator = new QRegExpValidator( rx, this );
 
-    d->unicodeLine = new QLineEdit( bar );
+    d->unicodeLine = new KLineEdit( bar );
     d->unicodeLine->setValidator(validator);
     lUnicode->setBuddy(d->unicodeLine);
     d->unicodeLine->resize( d->unicodeLine->sizeHint() );
Index: kdeui/Makefile.am
===================================================================
--- kdeui/Makefile.am	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/Makefile.am	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -55,7 +55,7 @@
 		kauthicon.h kmessagebox.h ksharedpixmap.h \
 		kdualcolorbtn.h kdualcolorbutton.h ktoolbarbutton.h \
 		ktoolbarradiogroup.h ktextbrowser.h \
-		kaction.h kactioncollection.h kactionclasses.h khelpmenu.h \
+		kaction.h kactioncollection.h kactionclasses.h khelpmenu.h kswitchlanguagedialog.h \
 		kcmodule.h kcmenumngr.h kpanelmenu.h kpanelappmenu.h \
 		kactionshortcutlist.h kstdaction.h kcombobox.h \
 		kiconview.h klistview.h klistbox.h kbugreport.h kpassdlg.h \
@@ -102,7 +102,7 @@
 		kjanuswidget.cpp kaboutdialog.cpp \
 		kauthicon.cpp kmessagebox.cpp kdualcolorbutton.cpp \
 		ktoolbarradiogroup.cpp ktoolbarbutton.cpp \
-		ktextbrowser.cpp khelpmenu.cpp \
+		ktextbrowser.cpp khelpmenu.cpp kswitchlanguagedialog.cpp \
 		kcmenumngr.cpp kpanelmenu.cpp \
 		kiconview.cpp klistbox.cpp kwordwrap.cpp kbugreport.cpp \
 		kcombobox.cpp kpassdlg.cpp kxmlguiclient.cpp kxmlguifactory.cpp \
Index: kdeui/kcolordrag.h
===================================================================
--- kdeui/kcolordrag.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kcolordrag.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -45,7 +45,7 @@
      * Constructs a color drag with the color @p col.
      */
     KColorDrag( const QColor &col, QWidget *dragsource = 0, const char *name = 0 );
-    virtual ~KColorDrag() {};
+    virtual ~KColorDrag() {}
 
     virtual const char *format(int i) const;
     virtual QByteArray encodedData ( const char * m ) const;
Index: kdeui/kactionselector.h
===================================================================
--- kdeui/kactionselector.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kactionselector.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -370,7 +370,7 @@
   /**
     connected to both list boxes to set the buttons enabled
   */
-  void slotCurrentChanged( QListBoxItem * ) { setButtonsEnabled(); };
+  void slotCurrentChanged( QListBoxItem * ) { setButtonsEnabled(); }
 
 private:
 
Index: kdeui/ui_standards.rc
===================================================================
--- kdeui/ui_standards.rc	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/ui_standards.rc	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -176,6 +176,8 @@
     <Separator/>
     <Action name="help_report_bug"/>
     <Separator/>
+    <Action name="switch_application_language"/>
+    <Separator/>
     <MergeLocal name="about_merge"/>
     <Action name="help_about_app"/>
     <Action name="help_about_kde"/>
Index: kdeui/kstdaction_p.h
===================================================================
--- kdeui/kstdaction_p.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kstdaction_p.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -109,6 +109,7 @@
 	{ WhatsThis,     KStdAccel::WhatsThis, "help_whats_this", I18N_NOOP("What's &This?"), 0, "contexthelp" },
 	{ TipofDay,      KStdAccel::AccelNone, "help_show_tip", I18N_NOOP("Tip of the &Day"), 0, "idea" },
 	{ ReportBug,     KStdAccel::AccelNone, "help_report_bug", I18N_NOOP("&Report Bug..."), 0, 0 },
+	{ SwitchApplicationLanguage,     KStdAccel::AccelNone, "switch_application_language", I18N_NOOP("Switch application &language..."), 0, 0 },
 	{ AboutApp,      KStdAccel::AccelNone, "help_about_app", I18N_NOOP("&About %1"), 0, 0 },
 	{ AboutKDE,      KStdAccel::AccelNone, "help_about_kde", I18N_NOOP("About &KDE"), 0,"about_kde" },
 	{ ActionNone, KStdAccel::AccelNone, 0, 0, 0, 0 }
Index: kdeui/kdatetbl.cpp
===================================================================
--- kdeui/kdatetbl.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kdatetbl.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -665,7 +665,7 @@
 public:
         KDateInternalMonthPrivate (int y, int m, int d)
         : year(y), month(m), day(d)
-        {};
+        {}
         int year;
         int month;
         int day;
Index: kdeui/kpanelextension.h
===================================================================
--- kdeui/kpanelextension.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kpanelextension.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -303,14 +303,14 @@
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void positionChange( Position ) {};
+    virtual void positionChange( Position ) {}
 
     /**
      * This extension has changed its alignment.
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void alignmentChange( Alignment ) {};
+    virtual void alignmentChange( Alignment ) {}
 
     /**
      * Use this method to set the custom menu for this extensions so that it can be shown
Index: kdeui/kmainwindow.cpp
===================================================================
--- kdeui/kmainwindow.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kmainwindow.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -86,7 +86,7 @@
 public:
     KMWSessionManaged()
     {
-    };
+    }
     ~KMWSessionManaged()
     {
     }
Index: kdeui/khelpmenu.cpp
===================================================================
--- kdeui/khelpmenu.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/khelpmenu.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -42,20 +42,24 @@
 #include <kstdaccel.h>
 #include <kstdaction.h>
 
+#include "kswitchlanguagedialog.h"
+
 #include "config.h"
 #include <qxembed.h>
 
 class KHelpMenuPrivate
 {
 public:
-    KHelpMenuPrivate()
+    KHelpMenuPrivate():mSwitchApplicationLanguage(NULL)
     {
     }
     ~KHelpMenuPrivate()
     {
+        delete mSwitchApplicationLanguage;
     }
 
     const KAboutData *mAboutData;
+    KSwitchLanguageDialog *mSwitchApplicationLanguage;
 };
 
 KHelpMenu::KHelpMenu( QWidget *parent, const QString &aboutAppText,
@@ -147,6 +151,15 @@
       need_separator = true;
     }
 
+    if (kapp->authorizeKAction("switch_application_language"))
+    {
+      if (need_separator)
+        mMenu->insertSeparator();
+      mMenu->insertItem( i18n( "Switch application &language..." ), menuSwitchLanguage );
+      mMenu->connectItem( menuSwitchLanguage, this, SLOT(switchApplicationLanguage()) );
+      need_separator = true;
+    }
+    
     if (need_separator)
       mMenu->insertSeparator();
 
@@ -240,7 +253,17 @@
   mBugReport->show();
 }
 
+void KHelpMenu::switchApplicationLanguage()
+{
+  if ( !d->mSwitchApplicationLanguage )
+  {
+    d->mSwitchApplicationLanguage = new KSwitchLanguageDialog( mParent, "switchlanguagedialog", false );
+    connect( d->mSwitchApplicationLanguage, SIGNAL(finished()), this, SLOT( dialogFinished()) );
+  }
+  d->mSwitchApplicationLanguage->show();
+}
 
+
 void KHelpMenu::dialogFinished()
 {
   QTimer::singleShot( 0, this, SLOT(timerExpired()) );
@@ -263,6 +286,11 @@
   {
     delete mAboutApp; mAboutApp = 0;
   }
+  
+  if (d->mSwitchApplicationLanguage && !d->mSwitchApplicationLanguage->isVisible())
+  {
+    delete d->mSwitchApplicationLanguage; d->mSwitchApplicationLanguage = 0;
+  }
 }
 
 
Index: kdeui/kcombobox.h
===================================================================
--- kdeui/kcombobox.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kcombobox.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -457,7 +457,7 @@
     /**
     * @deprecated
     */
-    virtual void itemSelected( QListBoxItem* ) {};
+    virtual void itemSelected( QListBoxItem* ) {}
 
     /**
     * Completes text according to the completion mode.
Index: kdeui/kbuttonbox.cpp
===================================================================
--- kdeui/kbuttonbox.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kbuttonbox.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -65,7 +65,7 @@
   unsigned short stretch;
   unsigned short actual_size;
 
-  Item(KPushButton* const _button) : button(_button) {};
+  Item(KPushButton* const _button) : button(_button) {}
 };
 
 template class QPtrList<KButtonBox::Item>;
Index: kdeui/kwindowlistmenu.cpp
===================================================================
--- kdeui/kwindowlistmenu.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kwindowlistmenu.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -61,8 +61,8 @@
 class NameSortedInfoList : public QPtrList<KWin::WindowInfo>
 {
 public:
-    NameSortedInfoList() { setAutoDelete(true); };
-    ~NameSortedInfoList() {};
+    NameSortedInfoList() { setAutoDelete(true); }
+    ~NameSortedInfoList() {}
 
 private:
     int compareItems( QPtrCollection::Item s1, QPtrCollection::Item s2 );
Index: kdeui/kstdaction.h
===================================================================
--- kdeui/kstdaction.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kstdaction.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -157,7 +157,8 @@
 		ConfigureNotifications,
 		FullScreen, ///< @since 3.2
 		Clear, ///< @since 3.2
-        PasteText ///< @since 3.2
+		PasteText, ///< @since 3.2
+		SwitchApplicationLanguage ///< @since 3.5.8
 	};
 
 	/**
Index: kdeui/kstdaction.cpp
===================================================================
--- kdeui/kstdaction.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kstdaction.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -313,6 +313,8 @@
 	{ return KStdAction::create( TipofDay, name, recvr, slot, parent ); }
 KAction *reportBug( const QObject *recvr, const char *slot, KActionCollection* parent, const char *name )
 	{ return KStdAction::create( ReportBug, name, recvr, slot, parent ); }
+KAction *switchApplicationLanguage( const QObject *recvr, const char *slot, KActionCollection* parent, const char *name )
+	{ return KStdAction::create( SwitchApplicationLanguage, name, recvr, slot, parent ); }
 KAction *aboutApp( const QObject *recvr, const char *slot, KActionCollection* parent, const char *name )
 	{ return KStdAction::create( AboutApp, name, recvr, slot, parent ); }
 KAction *aboutKDE( const QObject *recvr, const char *slot, KActionCollection* parent, const char *name )
Index: kdeui/kpanelapplet.h
===================================================================
--- kdeui/kpanelapplet.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kpanelapplet.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -324,7 +324,7 @@
      * Reimplement this change handler in order to adjust the look of your
      * applet.
      **/
-    virtual void alignmentChange( Alignment /*a*/ ) {};
+    virtual void alignmentChange( Alignment /*a*/ ) {}
 
     /**
      * Use this method to set the custom menu for this applet so that it can be shown
Index: kdeui/khelpmenu.h
===================================================================
--- kdeui/khelpmenu.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/khelpmenu.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -139,7 +139,8 @@
       menuWhatsThis = 1,
       menuAboutApp = 2,
       menuAboutKDE = 3,
-      menuReportBug = 4
+      menuReportBug = 4,
+      menuSwitchLanguage = 5
     };
 
     /**
@@ -222,6 +223,11 @@
      * Opens the standard "Report Bugs" dialog box.
      */
     void reportBug();
+    
+    /**
+     * Opens changing default application language dialog box.
+     */
+    void switchApplicationLanguage();
 
   private slots:
     /**
Index: kdeui/kdockwidget_private.h
===================================================================
--- kdeui/kdockwidget_private.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kdockwidget_private.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -57,7 +57,7 @@
    * @param pos procentual position of the splitter. Must be int [0...100].
    */
   KDockSplitter(QWidget *parent= 0, const char *name= 0, Orientation orient= Vertical, int pos= 50);
-  virtual ~KDockSplitter(){};
+  virtual ~KDockSplitter(){}
 
   /**
    * Initialize the splitter. If @p c0 or @p c1 is 0L the child will not
Index: kdeui/kswitchlanguagedialog.cpp
===================================================================
--- kdeui/kswitchlanguagedialog.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 0)
+++ kdeui/kswitchlanguagedialog.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -0,0 +1,349 @@
+/*
+ * This file is part of the KDE Libraries
+ * Copyright (C) 2007 Krzysztof Lichota (lichota@mimuw.edu.pl)
+ *
+ * This library is free software; you can redistribute it and/or
+ * modify it under the terms of the GNU Library General Public
+ * License as published by the Free Software Foundation; either
+ * version 2 of the License, or (at your option) any later version.
+ *
+ * This library is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+ * Library General Public License for more details.
+ *
+ * You should have received a copy of the GNU Library General Public License
+ * along with this library; see the file COPYING.LIB.  If not, write to
+ * the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor,
+ * Boston, MA 02110-1301, USA.
+ *
+ */
+
+#include "kswitchlanguagedialog.h"
+
+#include <qlayout.h>
+#include <qtooltip.h>
+#include <qlabel.h>
+#include <qmap.h>
+
+#include <klanguagebutton.h>
+#include <kconfig.h>
+#include <klocale.h>
+#include <kmessagebox.h>
+#include <kdebug.h>
+#include <kpushbutton.h>
+
+struct LanguageRowData
+{
+    QLabel *label;
+    KLanguageButton *languageButton;
+    KPushButton *removeButton;
+    
+    void setRowWidgets(
+        QLabel *label,
+        KLanguageButton *languageButton,
+        KPushButton *removeButton
+        )
+    {
+        this->label = label;
+        this->languageButton = languageButton;
+        this->removeButton = removeButton;
+    }
+    
+};
+
+class KSwitchLanguageDialogPrivate
+{
+public:
+    KSwitchLanguageDialogPrivate(KSwitchLanguageDialog *parent);
+    
+    KSwitchLanguageDialog *p; //parent class
+    
+    /**
+        Fills language button with names of languages for which given application has translation.
+    */
+    void fillApplicationLanguages(KLanguageButton *button);
+    
+    /**
+        Adds one button with language to widget.
+    */
+    void addLanguageButton(const QString & languageCode, bool primaryLanguage);
+    
+    /**
+        Returns list of languages chosen for application or default languages is they are not set.
+    */
+    QStringList applicationLanguageList();
+    
+    QMap<KPushButton*, LanguageRowData> languageRows;
+    QPtrList<KLanguageButton> languageButtons;
+    QGridLayout *languagesLayout;
+    QWidget *page;
+};
+
+/*************************** KSwitchLanguageDialog **************************/
+
+KSwitchLanguageDialog::KSwitchLanguageDialog(
+    QWidget *parent, 
+    const char *name, 
+    bool modal
+    ):
+    KDialogBase(parent, name, modal, i18n("Switch application language"), Ok|Cancel, Ok, true ),
+    d(new KSwitchLanguageDialogPrivate(this))
+{
+    d->page = new QWidget( this );
+    setMainWidget(d->page);
+    QVBoxLayout *topLayout = new QVBoxLayout( d->page, 0, spacingHint() );
+    QLabel *label = new QLabel( i18n("Please choose language which should be used for this application"), d->page, "label1" );
+    topLayout->addWidget( label );
+    
+    QHBoxLayout *languageHorizontalLayout = new QHBoxLayout();
+    topLayout->addLayout(languageHorizontalLayout);
+    
+    d->languagesLayout = new QGridLayout(0 , 2);
+    languageHorizontalLayout->addLayout(d->languagesLayout);
+    languageHorizontalLayout->addStretch();
+    
+    QStringList defaultLanguages = d->applicationLanguageList();
+    
+    for ( QStringList::ConstIterator it = defaultLanguages.begin(); it != defaultLanguages.end(); ++it )
+    {
+        QString language = *it;
+        bool primaryLanguage = (it == defaultLanguages.begin());
+        d->addLanguageButton(language, primaryLanguage);
+    }
+    
+    if (defaultLanguages.count() == 0)
+    {
+        d->addLanguageButton(KGlobal::locale()->defaultLanguage(), true);
+    }
+    
+    QHBoxLayout *addButtonHorizontalLayout = new QHBoxLayout();
+    topLayout->addLayout(addButtonHorizontalLayout);
+    
+    KPushButton *addLangButton = new KPushButton(i18n("Add fallback language"), d->page, "addLangButton");
+    QToolTip::add(addLangButton, i18n("Adds one more language which will be used if other translations do not contain proper translation"));
+    connect(addLangButton, SIGNAL(clicked()), this, SLOT(slotAddLanguageButton()));
+    addButtonHorizontalLayout->addWidget(addLangButton);
+    addButtonHorizontalLayout->addStretch();
+    
+    topLayout->addStretch(10);
+}
+
+KSwitchLanguageDialog::~KSwitchLanguageDialog()
+{
+    delete this->d;
+}
+
+void KSwitchLanguageDialog::slotAddLanguageButton()
+{
+    //adding new button with en_US as it should always be present
+    d->addLanguageButton("en_US", d->languageButtons.isEmpty() ? true : false);
+}
+
+void KSwitchLanguageDialog::removeButtonClicked()
+{
+    QObject const *signalSender = sender();
+    
+    if (signalSender == NULL)
+    {
+        kdError() << "KSwitchLanguageDialog::removeButtonClicked() called directly, not using signal";
+        return;
+    }
+    
+    KPushButton *removeButton = const_cast<KPushButton*>(::qt_cast<const KPushButton*>(signalSender));
+    
+    if (removeButton == NULL)
+    {
+        kdError() << "KSwitchLanguageDialog::removeButtonClicked() called from something else than KPushButton";
+        return;
+    }
+    
+    QMap<KPushButton *, LanguageRowData>::iterator it = d->languageRows.find(removeButton);
+    
+    if (it == d->languageRows.end())
+    {
+        kdError() << "KSwitchLanguageDialog::removeButtonClicked called from unknown KPushButton";
+        return;
+    }
+
+    LanguageRowData languageRowData = it.data();
+    
+    d->languageButtons.removeRef(languageRowData.languageButton);
+    
+    languageRowData.label->deleteLater();
+    languageRowData.languageButton->deleteLater();
+    languageRowData.removeButton->deleteLater();
+    d->languageRows.erase(it);
+}
+
+void KSwitchLanguageDialog::languageOnButtonChanged(const QString & languageCode)
+{
+    for ( QPtrList<KLanguageButton>::ConstIterator it = d->languageButtons.begin(); it != d->languageButtons.end(); ++it )
+    {
+        KLanguageButton *languageButton = *it;
+        if (languageButton->current() == languageCode)
+        {
+            //update all buttons which have matching id
+            //might update buttons which were not changed, but well...
+            languageButton->setText(KGlobal::locale()->twoAlphaToLanguageName(languageCode));
+        }
+    }
+}
+
+void KSwitchLanguageDialog::slotOk()
+{
+    QString languageString;
+    bool first = true;
+    
+    for ( QPtrList<KLanguageButton>::ConstIterator it = d->languageButtons.begin(); it != d->languageButtons.end(); ++it )
+    {
+        KLanguageButton *languageButton = *it;
+        
+        if (first == false)
+        {
+            languageString += ':';
+        }
+        languageString += languageButton->current();
+        first = false;
+    }
+    
+    KConfig *config = KGlobal::config();
+    
+    if (d->applicationLanguageList().join(":") != languageString)
+    {
+        //list is different from defaults or saved languages list
+        KConfigGroup group(config, "Locale");
+    
+        group.writeEntry("Language", languageString);
+        config->sync();
+        
+        KMessageBox::information(
+            this,
+            i18n("Language for this application has been changed. The change will take effect upon next start of application"), //text
+            i18n("Application language changed"), //caption
+            "ApplicationLanguageChangedWarning" //dontShowAgainName
+            );
+    }
+
+    emit okClicked();
+    accept();
+}
+
+/************************ KSwitchLanguageDialogPrivate ***********************/
+
+KSwitchLanguageDialogPrivate::KSwitchLanguageDialogPrivate(
+    KSwitchLanguageDialog *parent
+    ):
+    p(parent)
+{
+    //NOTE: do NOT use "p" in constructor, it is not fully constructed
+}
+
+void KSwitchLanguageDialogPrivate::fillApplicationLanguages(KLanguageButton *button)
+{
+    KLocale *locale = KGlobal::locale();
+    QStringList allLanguages = locale->allLanguagesTwoAlpha();
+    for ( QStringList::ConstIterator it = allLanguages.begin(); it != allLanguages.end(); ++it )
+    {
+        QString languageCode = *it;
+        if (locale->isApplicationTranslatedInto(languageCode))
+        {
+            button->insertItem(
+                locale->twoAlphaToLanguageName(languageCode),
+                languageCode
+                );
+        }
+    }
+}
+
+QStringList KSwitchLanguageDialogPrivate::applicationLanguageList()
+{
+    KConfig *config = KGlobal::config();
+    QStringList languagesList;
+    
+    if (config->hasGroup("Locale"))
+    {
+        KConfigGroupSaver saver(config, "Locale");
+        
+        if (config->hasKey("Language"))
+        {
+            languagesList = config->readListEntry("Language", ':');
+        }
+    }
+    if (languagesList.empty())
+    {
+        languagesList = KGlobal::locale()->languageList();
+    }
+    return languagesList;
+}
+
+void KSwitchLanguageDialogPrivate::addLanguageButton(const QString & languageCode, bool primaryLanguage)
+{
+    QString labelText = primaryLanguage ? i18n("Primary language:") : i18n("Fallback language:");
+    
+    KLanguageButton *languageButton = new KLanguageButton(page);
+    
+    languageButton->setText(KGlobal::locale()->twoAlphaToLanguageName(languageCode));
+    
+    fillApplicationLanguages(languageButton);
+    
+    languageButton->setCurrentItem(languageCode);
+    
+    QObject::connect(
+        languageButton, 
+        SIGNAL(activated( const QString &)), 
+        p,
+        SLOT(languageOnButtonChanged(const QString &))
+        );
+    
+    LanguageRowData languageRowData;
+    KPushButton *removeButton = NULL;
+    
+    if (primaryLanguage == false)
+    {
+        removeButton = new KPushButton(i18n("Remove"), page);
+        
+        QObject::connect(
+            removeButton, 
+            SIGNAL(clicked()),
+            p,
+            SLOT(removeButtonClicked())
+            );
+    }
+        
+    if (primaryLanguage)
+    {
+        QToolTip::add(languageButton, i18n("This is main application language which will be used first before any other languages"));
+    }
+    else
+    {
+        QToolTip::add(languageButton, i18n("This is language which will be used if any previous languages does not contain proper translation"));
+    }
+    
+    int numRows = languagesLayout->numRows();
+    
+    QLabel *languageLabel = new QLabel(labelText, page);
+    languagesLayout->addWidget( languageLabel, numRows + 1, 1, Qt::AlignAuto );
+    languagesLayout->addWidget( languageButton, numRows + 1, 2, Qt::AlignAuto );
+    
+    if (primaryLanguage == false)
+    {
+        languagesLayout->addWidget( removeButton, numRows + 1, 3, Qt::AlignAuto );
+        
+        languageRowData.setRowWidgets(
+            languageLabel,
+            languageButton,
+            removeButton
+            );
+        removeButton->show();
+    }
+    
+    languageRows.insert(removeButton, languageRowData);
+    
+    languageButtons.append(languageButton);
+    languageButton->show();
+    languageLabel->show();
+}
+
+#include "kswitchlanguagedialog.moc"
+
Index: kdeui/qxembed.cpp
===================================================================
--- kdeui/qxembed.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/qxembed.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -136,7 +136,7 @@
         mapAfterRelease = false;
         lastPos = QPoint(0,0);
     }
-    ~QXEmbedData(){};
+    ~QXEmbedData(){}
 
     bool autoDelete;      // L0101: See L2600
     bool xplain;          // L0102: See L1100
@@ -154,7 +154,7 @@
     {
     public:
         QXEmbedAppFilter()  { qApp->installEventFilter( this ); } 
-        ~QXEmbedAppFilter() { };
+        ~QXEmbedAppFilter() { }
         bool eventFilter( QObject *, QEvent * );
     };
 }
Index: kdeui/kfontcombo.cpp
===================================================================
--- kdeui/kfontcombo.cpp	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kfontcombo.cpp	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -40,7 +40,7 @@
           size(0),
           lineSpacing(0)
     {
-    };
+    }
 
     bool bold : 1;
     bool italic : 1;
Index: kdeui/kdockwidget.h
===================================================================
--- kdeui/kdockwidget.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kdockwidget.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -116,23 +116,23 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetAbstractHeader(){};
+  virtual ~KDockWidgetAbstractHeader(){}
 
   /**
    * Provides things concerning to switching to toplevel mode. Must be overridden by an inheriting class.
    */
-  virtual void setTopLevel( bool ){};
+  virtual void setTopLevel( bool ){}
 
 #ifndef NO_KDE2
   /**
    * Provides saving the current configuration. Must be overridden by an inheriting class.
    */
-  virtual void saveConfig( KConfig* ){};
+  virtual void saveConfig( KConfig* ){}
 
   /**
    * Provides loading the current configuration.  Must be overridden by an inheriting class
    */
-  virtual void loadConfig( KConfig* ){};
+  virtual void loadConfig( KConfig* ){}
 #endif
 
 protected:
@@ -167,7 +167,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetAbstractHeaderDrag(){};
+  virtual ~KDockWidgetAbstractHeaderDrag(){}
 
   /**
    * @return the dockwidget where this belongs to
@@ -212,7 +212,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetHeaderDrag(){};
+  virtual ~KDockWidgetHeaderDrag(){}
 
 protected:
 
@@ -251,7 +251,7 @@
   /**
    * Destructs this.
    */
-  virtual ~KDockWidgetHeader(){};
+  virtual ~KDockWidgetHeader(){}
 
   /**
    * Hides the close button and stay button when switching to toplevel or vice versa shows them.
@@ -368,12 +368,12 @@
    * Constructs this. It just calls the method of the base class.
    */
   KDockTabGroup( QWidget *parent = 0, const char *name = 0 )
-  :QTabWidget( parent, name ){};
+  :QTabWidget( parent, name ){}
 
   /**
    * Destructs a KDockTabGroup.
    */
-  virtual ~KDockTabGroup(){};
+  virtual ~KDockTabGroup(){}
 
   QWidget *transientTo();
 protected:
@@ -535,7 +535,7 @@
    *
    * @return The pointer to the dockwidget's child widget, 0L if there's no such child.
    */
-  QWidget* getWidget() const { return widget; };
+  QWidget* getWidget() const { return widget; }
 
   /**
    * Sets the header of this dockwidget.
@@ -594,12 +594,12 @@
    *
    * @param ttStr A string for the tooltip on the tab.
    */
-  void setToolTipString(const QString& ttStr) { toolTipStr = ttStr; };
+  void setToolTipString(const QString& ttStr) { toolTipStr = ttStr; }
 
   /**
    * @return The tooltip string being shown on the appropriate tab page header when in dock-centered mode.
    */
-  const QString& toolTipString() const { return toolTipStr; };
+  const QString& toolTipString() const { return toolTipStr; }
 
   /**
    * @return result @p true, if a dockback is possible, otherwise @p false.
@@ -610,12 +610,12 @@
    * Sets a string that is used for the label of the tab page when in tab page mode
    * @param label The new tab page label.
    */
-  void setTabPageLabel( const QString& label) { tabPageTitle = label; };
+  void setTabPageLabel( const QString& label) { tabPageTitle = label; }
 
   /**
    * @return A string that is used for the label of the tab page when in tab page mode.
    */
-  const QString& tabPageLabel() const { return tabPageTitle; };
+  const QString& tabPageLabel() const { return tabPageTitle; }
 
   /**
    * Catches and processes some QWidget events that are interesting for dockwidgets.
@@ -1123,8 +1123,8 @@
     {
       dock = _dock;
       hide = _hide;
-    };
-    ~MenuDockData(){};
+    }
+    ~MenuDockData(){}
 
     KDockWidget* dock;
     bool hide;
Index: kdeui/kpixmapregionselectorwidget.h
===================================================================
--- kdeui/kpixmapregionselectorwidget.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kpixmapregionselectorwidget.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -66,7 +66,7 @@
     * @return the original whole pixmap that we're using in this widget as the
     * pixmap the user is selecting a region from.
     */
-   QPixmap pixmap() const { return m_unzoomedPixmap; };
+   QPixmap pixmap() const { return m_unzoomedPixmap; }
 
    /**
     * Sets the selected region to be @p rect (in zoomed pixmap coordinates)
Index: kdeui/kstatusbar.h
===================================================================
--- kdeui/kstatusbar.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ kdeui/kstatusbar.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -40,7 +40,7 @@
 
 
   KStatusBarLabel( const QString& text, int _id, KStatusBar* parent = 0L, const char *name=0L );
-  ~KStatusBarLabel () {};
+  ~KStatusBarLabel () {}
 
 protected:
 
Index: libkmid/deviceman.h
===================================================================
--- libkmid/deviceman.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/deviceman.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -204,7 +204,7 @@
      *
      */
     MidiOut *chntodev(int chn)
-		{ return deviceForChannel(chn); };
+		{ return deviceForChannel(chn); }
 
     /**
      * It's possible to send different MIDI channels to different MIDI devices,
@@ -215,12 +215,12 @@
      * be sent.
      */
     MidiOut *deviceForChannel(int chn)
-		{ return (device!=0L) ? device[chn2dev[chn]] : 0L ; };
+		{ return (device!=0L) ? device[chn2dev[chn]] : 0L ; }
 
     /**
      * Returns the device number associated with a given channel.
      */
-    int deviceNumberForChannel(int chn) { return chn2dev[chn]; };
+    int deviceNumberForChannel(int chn) { return chn2dev[chn]; }
 
     /**
      * Sets the device number associated with a given channel.
@@ -236,7 +236,7 @@
     /**
      * Returns true if it's running ALSA and false if OSS is being run
      */
-    int usingAlsa(void) { return alsa; };
+    int usingAlsa(void) { return alsa; }
 
     // The following function are here to emulate a midi, so that the
     // DeviceManager sends the events to the appropriate devices.
@@ -490,7 +490,7 @@
     /**
      * Returns the SNDCTL_SEQ_CTRLRATE ioctl value
      */
-    int rate(void) { return m_rate; };
+    int rate(void) { return m_rate; }
 
     /**
      * Returns the number of MIDI ports available on the system. It's common that
@@ -501,7 +501,7 @@
      * @see synthDevices()
      * @see setDefaultDevice()
      */
-    int midiPorts(void) { return n_midi; };
+    int midiPorts(void) { return n_midi; }
 
     /**
      * Returns the number of internal synthesizers available on the system. Some
@@ -512,7 +512,7 @@
      * @see setDefaultDevice()
      * @see setPatchesToUse()
      */
-    int synthDevices(void) { return n_synths; };
+    int synthDevices(void) { return n_synths; }
 
     /**
      * Returns the name of the @p i-th device . In case the DeviceManager wasn't
Index: libkmid/voiceman.h
===================================================================
--- libkmid/voiceman.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/voiceman.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -151,17 +151,17 @@
     /**
      * Returns the channel that voice @p v is using.
      */
-    int channel(int v) {return VoiceList[v]->channel;};
+    int channel(int v) {return VoiceList[v]->channel;}
 
     /**
      * Returns the note that voice @p v is playing.
      */
-    int note(int v) {return VoiceList[v]->note;};
+    int note(int v) {return VoiceList[v]->note;}
 
     /**
      * Returns true or false if the voice @p v is being used or not respectively.
      */
-    int used(int v) {return VoiceList[v]->used;};
+    int used(int v) {return VoiceList[v]->used;}
 
     /**
      * Clears the lists of used voices.
Index: libkmid/notearray.h
===================================================================
--- libkmid/notearray.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/notearray.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -123,12 +123,12 @@
    * @see get()
    * @see next()
    */ 
-  void iteratorBegin(void) { it=data; };
+  void iteratorBegin(void) { it=data; }
 
   /**
    * Get the command currently pointed to by the iterator.
    */
-  noteCmd *get(void)       { return it; };
+  noteCmd *get(void)       { return it; }
 
   /**
    * Advances the iterator to the next position.
Index: libkmid/track.h
===================================================================
--- libkmid/track.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/track.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -202,14 +202,14 @@
     /**
      * Returns the number of ticks left for the next event.
      */
-    ulong	waitTicks   (void) { return wait_ticks; };
+    ulong	waitTicks   (void) { return wait_ticks; }
 
     //	ulong   waitMs (void) {return time_to_next_event;};
 
     /**
      * Returns the absolute number of milliseconds of the next event.
      */ 
-    double   absMsOfNextEvent (void) { return time_at_next_event; };
+    double   absMsOfNextEvent (void) { return time_at_next_event; }
 
     /**
      * Change the tempo of the song.
Index: libkmid/alsaout.h
===================================================================
--- libkmid/alsaout.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/alsaout.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -126,7 +126,7 @@
    *
    * @see deviceName
    */
-  int          deviceType () const { return devicetype; };
+  int          deviceType () const { return devicetype; }
 
   /**
    * Returns the name and type of this MIDI device.
@@ -137,7 +137,7 @@
   /**
    * @internal
    */
-  int  rate    (void) { return m_rate; };
+  int  rate    (void) { return m_rate; }
 
   /**
    * See DeviceManager::noteOn()
@@ -201,7 +201,7 @@
    * an unmodified value, 200 play music twice louder than it should, etc.
    */
   virtual void setVolumePercentage ( int volper )
-  { volumepercentage = volper; };
+  { volumepercentage = volper; }
 
   /**
    * Returns true if everything's ok and false if there has been any problem
@@ -209,7 +209,7 @@
   int ok (void)
   { if (seqfd<0) return 0;
     return (_ok>0);
-  };
+  }
 
   virtual void wait        (double ticks);
   virtual void tmrSetTempo (int v);
Index: libkmid/midistat.h
===================================================================
--- libkmid/midistat.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/midistat.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -83,7 +83,7 @@
     /**
      * Returns the patch currently used in channel @p chn.
      */
-    uchar chnPatch	( uchar chn ) { return chn_patch[chn]; };
+    uchar chnPatch	( uchar chn ) { return chn_patch[chn]; }
 
     /**
      * Stores a new channel pressure value in channel @p chn.
@@ -94,7 +94,7 @@
     /**
      * Returns the pressure value currently used in channel @p chn.
      */
-    uchar chnPressure	( uchar chn ) { return chn_pressure[chn]; };
+    uchar chnPressure	( uchar chn ) { return chn_pressure[chn]; }
 
     /**
      * Stores a new pitch bender value in channel chn
@@ -104,7 +104,7 @@
     /**
      * Returns the pitch bender value used in channel @p chn
      */
-    int chnPitchBender	( uchar chn) { return chn_bender[chn]; };
+    int chnPitchBender	( uchar chn) { return chn_bender[chn]; }
 
     /**
      * Stores a new value for controller @p ctl in channel @p chn.
@@ -115,7 +115,7 @@
      * Returns the value used for controller @p ctl in channel @p chn
      */
     uchar chnController	( uchar chn, uchar ctl ) 
-	{ return chn_controller[chn][ctl]; };
+	{ return chn_controller[chn][ctl]; }
 
     /**
      * Stores a sysex message that will be send in the next call to sendData
Index: libkmid/midimapper.h
===================================================================
--- libkmid/midimapper.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/midimapper.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -169,12 +169,12 @@
     /**
      * Returns the status of the object.
      */
-    int  ok(void) { return _ok; };
+    int  ok(void) { return _ok; }
 
     /** 
      * Returns the channel which chn should be mapped to.
      */ 
-    uchar channel(uchar chn) { return channelmap[chn];};
+    uchar channel(uchar chn) { return channelmap[chn];}
 
     /** 
      * Returns the patch which pgm used on channel chn should be mapped to.
Index: libkmid/player.h
===================================================================
--- libkmid/player.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/player.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -314,13 +314,13 @@
    * Returns true if there's a song already loaded (with a previous call to 
    * loadSong() ) and false if not.
    */
-  int isSongLoaded(void) { return songLoaded; };
+  int isSongLoaded(void) { return songLoaded; }
 
   /**
    * Returns the linked list of SpecialEvents objects . For this to work,
    * the parse should be enabled (the default), by using setParseSong().
    */
-  SpecialEvent *specialEvents() { return spev; };
+  SpecialEvent *specialEvents() { return spev; }
 
   /**
    * Returns and array with the notes playen through the song . MidiPlayer must
@@ -330,7 +330,7 @@
    * Returns an array of notes, (just note on and note off events), in the form
    * of a NoteArray object
    */
-  NoteArray *noteArray(void) { return na; };
+  NoteArray *noteArray(void) { return na; }
 
 
   /**
@@ -372,7 +372,7 @@
    *
    * @see loadSong
    */
-  MidiFileInfo *information(void) { return info; };
+  MidiFileInfo *information(void) { return info; }
 
   /**
    * Sets the position in a song. 
Index: libkmid/midiout.h
===================================================================
--- libkmid/midiout.h	(.../tags/KDE/3.5.7/kdelibs)	(wersja 700476)
+++ libkmid/midiout.h	(.../branches/KDE/3.5/kdelibs)	(wersja 700476)
@@ -136,7 +136,7 @@
    *
    * @see deviceName
    */
-  int          deviceType () const { return devicetype; };
+  int          deviceType () const { return devicetype; }
 
   /**
    * Returns the name and type of this MIDI device.
@@ -223,7 +223,7 @@
    * an unmodified value, 200 play music twice louder than it should, etc.
    */
   virtual void setVolumePercentage ( int volper )
-  { volumepercentage = volper; };
+  { volumepercentage = volper; }
 
   /**
    * Returns true if everything's ok and false if there has been any problem
@@ -231,7 +231,7 @@
   int ok (void)
   { if (seqfd<0) return 0;
     return (_ok>0);
-  };
+  }
 
   /**
    * Returns the path to the file where the current used MidiMapper object

Zmiany atrybutów dla: .
___________________________________________________________________
Nazwa: svn:externals
   + admin https://svn.kde.org/home/kde/branches/KDE/3.5/kde-common/admin


